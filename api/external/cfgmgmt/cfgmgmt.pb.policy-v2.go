// Code generated by protoc-gen-policy. DO NOT EDIT.
// source: api/external/cfgmgmt/cfgmgmt.proto

package cfgmgmt

import (
	request "github.com/chef/automate/api/external/cfgmgmt/request"
	query "github.com/chef/automate/api/external/common/query"
	policyv2 "github.com/chef/automate/components/automate-gateway/authz/policy_v2"
)

func init() {
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetNodes", "infra:nodes", "infra:nodes:list", "GET", "/cfgmgmt/nodes", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetRuns", "infra:nodes:{node_id}", "infra:nodes:list", "GET", "/cfgmgmt/nodes/{node_id}/runs", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*request.Runs); ok {
			return policyv2.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "node_id":
					return m.NodeId
				case "start":
					return m.Start
				case "end":
					return m.End
				default:
					return ""
				}
			})
		}
		return ""
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetNodesCounts", "infra:nodes", "infra:nodes:list", "GET", "/cfgmgmt/stats/node_counts", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetRunsCounts", "infra:nodes", "infra:nodes:list", "GET", "/cfgmgmt/stats/run_counts", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*request.RunsCounts); ok {
			return policyv2.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "start":
					return m.Start
				case "end":
					return m.End
				case "node_id":
					return m.NodeId
				default:
					return ""
				}
			})
		}
		return ""
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetNodeRun", "infra:nodes:{node_id}", "infra:nodes:get", "GET", "/cfgmgmt/nodes/{node_id}/runs/{run_id}", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*request.NodeRun); ok {
			return policyv2.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "node_id":
					return m.NodeId
				case "run_id":
					return m.RunId
				default:
					return ""
				}
			})
		}
		return ""
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetSuggestions", "infra:nodes", "infra:nodes:list", "GET", "/cfgmgmt/suggestions", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*query.Suggestion); ok {
			return policyv2.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "type":
					return m.Type
				case "text":
					return m.Text
				default:
					return ""
				}
			})
		}
		return ""
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetOrganizations", "infra:nodes", "infra:nodes:list", "GET", "/cfgmgmt/organizations", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetSourceFqdns", "infra:nodes", "infra:nodes:list", "GET", "/cfgmgmt/source_fqdns", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetAttributes", "infra:nodes:{node_id}", "infra:nodes:get", "GET", "/cfgmgmt/nodes/{node_id}/attribute", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*request.Node); ok {
			return policyv2.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "node_id":
					return m.NodeId
				default:
					return ""
				}
			})
		}
		return ""
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetVersion", "system:service:version", "system:serviceVersion:get", "GET", "/cfgmgmt/version", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policyv2.MapMethodTo("/chef.automate.api.cfgmgmt.ConfigMgmt/GetPolicyCookbooks", "infra:nodes:{revision_id}", "infra:nodes:list", "GET", "/cfgmgmt/policy_revision/{revision_id}", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*request.PolicyRevision); ok {
			return policyv2.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "revision_id":
					return m.RevisionId
				default:
					return ""
				}
			})
		}
		return ""
	})
}
