<div class="content-container">
  <div class="container">
    <main>
      <chef-page-header>
        <chef-heading>Node Integrations</chef-heading>
        <chef-subheading>Connect Chef Automate to cloud services.</chef-subheading>
      </chef-page-header>

      <div class="page-body">
        <h2 class="display4 strong">Nodes by IP Address</h2>
        <chef-card *ngIf="automateManager$ | async as manager" class="regular">
          <a class="link" [routerLink]="['/settings/node-integrations', manager.id]">{{ manager.name }}</a>
        </chef-card>


        <h2 class="display4 strong">Cloud Platform Providers</h2>
        <chef-toolbar>
          <app-authorized [anyOf]="['/nodemanagers', 'post']">
            <chef-button primary [routerLink]="['/settings/node-integrations/add']">Create Integration</chef-button>
          </app-authorized>
        </chef-toolbar>

        <chef-table-new (sort-toggled)="onSortToggled($event)">
          <chef-table-header>
            <chef-table-row>
              <chef-table-header-cell>
                Node Manager
                <chef-sort-toggle sort="name" [order]="orderFor('name')"></chef-sort-toggle>
              </chef-table-header-cell>
              <chef-table-header-cell>
                Provider
                <chef-sort-toggle sort="type" [order]="orderFor('type')"></chef-sort-toggle>
              </chef-table-header-cell>
              <chef-table-header-cell class="column-date">
                Date Created
                <chef-sort-toggle sort="date_added" [order]="orderFor('date_added')"></chef-sort-toggle>
              </chef-table-header-cell>
              <chef-table-header-cell>
                Status
                <chef-sort-toggle sort="status" [order]="orderFor('status')"></chef-sort-toggle>
              </chef-table-header-cell>
              <chef-table-header-cell class="three-dot-column"></chef-table-header-cell>
            </chef-table-row>
          </chef-table-header>

          <chef-loading-spinner *ngIf="loading(managerStatus$ | async)" size='50'></chef-loading-spinner>

        <chef-tbody>
          <chef-table-row *ngFor="let manager of managers$ | async">
            <chef-td>
              <a class="link" [routerLink]="['/settings/node-integrations', manager.id]">{{ manager.name }}</a>
            </chef-td>
            <chef-td>{{ manager.type }}</chef-td>
            <chef-td class="column-date">{{ manager.date_added | datetime: RFC2822 }}</chef-td>
            <chef-td>{{ manager.status }}</chef-td>
            <chef-td class="three-dot-column">
              <mat-select panelClass="chef-control-menu">
                <mat-option (onSelectionChange)="handleEdit(manager.id)">Edit Integration</mat-option>
                <mat-option (onSelectionChange)="handleDelete($event, manager.id)">Delete Integration</mat-option>
              </mat-select>
            </chef-td>
          </chef-table-row>
        </chef-tbody>
      </chef-table-new>

      </div>
    </main>
  </div>
</div>