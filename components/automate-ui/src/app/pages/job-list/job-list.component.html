<main>
  <header>
    <h2 class="strong display3">Current Scan Jobs</h2>
    <span class="strong display5">Add a new job to scan for compliance or modify an existing job</span>
  </header>

  <chef-table (sort-toggled)="handleSortToggle($event)">
    <chef-table-header>
      <chef-table-row>
        <chef-table-header-cell>
          Scan Job Name
          <chef-sort-toggle sort="name" [order]="orderFor('name')"></chef-sort-toggle>
        </chef-table-header-cell>
        <chef-table-header-cell>
          Total Nodes
        </chef-table-header-cell>
        <chef-table-header-cell>
          Scan Schedule
        </chef-table-header-cell>
        <chef-table-header-cell>
          Last Scan
          <chef-sort-toggle sort="end_time" [order]="orderFor('end_time')"></chef-sort-toggle>
        </chef-table-header-cell>
      </chef-table-row>
    </chef-table-header>

    <chef-loading-spinner *ngIf="loading(jobStatus$ | async)" size='50'></chef-loading-spinner>

    <chef-table-body>
      <app-authorized [allOf]="['/compliance/scanner/jobs', 'post']">
        <chef-table-row class="empty new-row">
          <span class="cta">Create a new scan job with nodes and profiles</span>
          <span class="action">
            <chef-button primary [routerLink]="['/jobs/add']">Create Scan Job</chef-button>
          </span>
        </chef-table-row>
      </app-authorized>
      <chef-table-row *ngFor="let job of jobs$ | async">
        <chef-table-cell>{{ job.name }}</chef-table-cell>
        <chef-table-cell>{{ job.node_count }}</chef-table-cell>
        <chef-table-cell>{{ job.recurrence }}</chef-table-cell>
        <chef-table-cell>{{ job.end_time | datetime:'ddd, MMMM D, YYYY [at] H:mm a' }}</chef-table-cell>
      </chef-table-row>
    </chef-table-body>
  </chef-table>

</main>
