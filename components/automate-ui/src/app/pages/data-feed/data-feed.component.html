<div class="content-container">
  <div class="container">
    <main>
      <chef-page-header>
        <chef-heading>Data Feeds</chef-heading>
        <chef-subheading><b>Disclaimer Text</b>: We suggest no more than 5 Feeds, depending on your fleet size. Please check the
          reference matrix on recommended feed counts.</chef-subheading>
        <app-create-data-feed-modal
          [visible]="createModalVisible"
          [creating]="creatingDataFeed"
          [sending]="sendingDataFeed"
          [hookStatus]="hookStatus"
          [createForm]="createDataFeedForm"
          (close)="closeCreateModal()"
          [conflictErrorEvent]="conflictErrorEvent"
          (createClicked)="createDataFeed()"
          (sendTestClicked)="sendTestForDataFeed()">
        </app-create-data-feed-modal>
        <app-delete-object-modal
          [visible]="deleteModalVisible"
          objectNoun="data feed"
          [objectName]="dataFeedToDelete?.name"
          (close)="closeDeleteModal()"
          (deleteClicked)="deleteDataFeed()"
          objectAction="Delete">
        </app-delete-object-modal>
      </chef-page-header>
      <div class="page-body">
        <div *ngIf="(sortedDestinations$ | async)?.length === 0" class="empty-state">
          <img alt="No preview" src="/assets/img/no_preview.gif" />
          <p>No Data Feeds Preview Available</p>
        </div>
        <div [ngClass]="(sortedDestinations$ | async)?.length === 0 ? 'empty-state' : ''">
          <!-- <chef-button primary [routerLink]="['/settings/data-feed/form']">Create Data Feed</chef-button> -->
          <chef-button primary (click)="openCreateModal()">
            <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="plus-circle" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" 
            class="svg-inline--fa fa-plus-circle fa-w-16 fa-3x"><path fill="currentColor" d="M384 250v12c0 6.6-5.4 12-12 12h-98v98c0 6.6-5.4 12-12 12h-12c-6.6 0-12-5.4-12-12v-98h-98c-6.6 
            0-12-5.4-12-12v-12c0-6.6 5.4-12 12-12h98v-98c0-6.6 5.4-12 12-12h12c6.6 0 12 5.4 12 12v98h98c6.6 0 12 5.4 12 12zm120 6c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 
            248zm-32 0c0-119.9-97.3-216-216-216-119.9 0-216 97.3-216 216 0 119.9 97.3 216 216 216 119.9 0 216-97.3 216-216z" class="" data-cy='new-integration'></path></svg>
            &nbsp;&nbsp;New Integration
          </chef-button>
        </div>

        <chef-table *ngIf="(sortedDestinations$ | async)?.length !== 0">
          <chef-thead>
            <chef-tr>
              <chef-th>Name</chef-th>
              <chef-th class="three-dot-column"></chef-th>
            </chef-tr>
          </chef-thead>
          <chef-tbody>
            <chef-tr *ngFor= "let destination of sortedDestinations$ | async">
              <chef-td>
                <a [routerLink]="['/settings/data-feeds/', destination.id]">{{ destination.name }}</a>
              </chef-td>
              <chef-td class="three-dot-column">
                <mat-select panelClass="chef-control-menu" id="menu-{{destination.id}}">
                  <mat-option (onSelectionChange)="startDataFeedSendTest($event, destination)" data-cy="test-data-feed">Test Data Feed</mat-option>
                  <mat-option (onSelectionChange)="startDataFeedDelete($event, destination)" data-cy="remove-data-feed">Delete Data Feed</mat-option>
                </mat-select>
              </chef-td>
            </chef-tr>
          </chef-tbody>
        </chef-table>
      </div>
    </main>
  </div>
</div>
