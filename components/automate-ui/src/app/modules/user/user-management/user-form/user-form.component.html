<div class="flex-container">
  <form [formGroup]="createUserForm">
    <div class="field-margin">
      <chef-form-field>
        <label>
          <span>Display Name <span aria-hidden="true">*</span></span>
          <input chefInput formControlName="displayname" type="text" (keyup)="handleNameInput($event)" autocomplete="off"/>
        </label>
        <chef-error *ngIf="(createUserForm.get('displayname').hasError('required') && createUserForm.get('displayname').touched) || (createUserForm.get('displayname').hasError('pattern') && createUserForm.get('displayname').dirty)">
          Display name is required.
        </chef-error>
      </chef-form-field>
      <span class="detail">Don't worry, display names can be changed later.</span>
    </div>
    <div class="field-margin" *ngIf="modifyUsername">
      <chef-form-field>
        <label>
          <span>Username <span aria-hidden="true">*</span></span>
          <input chefInput formControlName="username" type="text" (keyup)="handleUsernameInput($event)" autocomplete="off"/>
        </label>
        <chef-error *ngIf="createUserForm.get('username').hasError('required') && createUserForm.get('username').dirty">
          Username is required.
        </chef-error>
        <chef-error *ngIf="createUserForm.get('username').hasError('pattern') && createUserForm.get('username').dirty">
          Only letters, numbers, and these characters (<strong>_@.+-</strong>) allowed.
        </chef-error>
        <chef-error *ngIf="conflictError">
          Username "{{createUserForm.get('username').value}}" already exists.
        </chef-error>
      </chef-form-field>
    </div>
    <div class="field-margin" *ngIf="!modifyUsername">
      <div id="username-fields">
        <span class="key-label">Username:&nbsp;</span>
        <span>{{ this.createUserForm?.value.username }}</span>
      </div>
      <chef-toolbar>
        <chef-button tertiary (click)="modifyUsername = true" id="edit-button-object-modal">Edit Username</chef-button>
      </chef-toolbar>
    </div>
    <div class="field-margin">
      <chef-form-field>
        <label>
          <span>Password <span aria-hidden="true">*</span></span>
          <input chefInput formControlName="password" type="password"/>
        </label>
        <chef-error *ngIf="(createUserForm.get('password').hasError('required') || createUserForm.get('password').hasError('pattern')) && createUserForm.get('password').dirty && createUserForm.get('password').touched">
          Password is required.
        </chef-error>
        <chef-error *ngIf="createUserForm.get('password').hasError('minlength') && createUserForm.get('password').dirty && createUserForm.get('password').touched">
          Password must be at least 8 characters.
        </chef-error>
        <chef-error *ngIf="passwordError">
          Password must contain at least 3 distinct characters.
        </chef-error>
      </chef-form-field>
      <span class="detail">Must be a minimum of 8 total characters with at least 3 distinct characters.<br>
        May include both upper and lower case letters, punctuation marks, and symbols.</span>
    </div>
    <div class="field-margin">
      <chef-form-field>
        <label>
          <span>Confirm Password <span aria-hidden="true">*</span></span>
          <input chefInput formControlName="confirmPassword" type="password"/>
        </label>
        <chef-error *ngIf="createUserForm.get('confirmPassword').hasError('noMatch') && createUserForm.get('confirmPassword').dirty && createUserForm.get('confirmPassword').touched">
          Passwords must match.
        </chef-error>
      </chef-form-field>
    </div>
  </form>
</div>
