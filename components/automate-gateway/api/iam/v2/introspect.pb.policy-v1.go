// Code generated by protoc-gen-policy. DO NOT EDIT.
// source: components/automate-gateway/api/iam/v2/introspect.proto

package v2

import (
	policy "github.com/chef/automate/components/automate-gateway/api/authz/policy"
	request "github.com/chef/automate/components/automate-gateway/api/iam/v2/request"
)

func init() {
	policy.MapMethodTo("/chef.automate.api.iam.v2.Authorization/IntrospectAll", "auth_introspection:introspect_all", "read", "GET", "/iam/v2/introspect", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policy.MapMethodTo("/chef.automate.api.iam.v2.Authorization/IntrospectSome", "auth_introspection:introspect_some", "read", "POST", "/iam/v2/introspect_some", func(unexpandedResource string, input interface{}) string {
		return unexpandedResource
	})
	policy.MapMethodTo("/chef.automate.api.iam.v2.Authorization/Introspect", "auth_introspection:introspect", "read", "POST", "/iam/v2/introspect", func(unexpandedResource string, input interface{}) string {
		if m, ok := input.(*request.IntrospectReq); ok {
			return policy.ExpandParameterizedResource(unexpandedResource, func(want string) string {
				switch want {
				case "path":
					return m.Path
				default:
					return ""
				}
			})
		}
		return ""
	})
}
