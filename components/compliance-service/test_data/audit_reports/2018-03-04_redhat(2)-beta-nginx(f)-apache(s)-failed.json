{
  "type": "inspec_report",
  "node_uuid": "9b9f4e51-b049-4b10-9555-10578916e222",
  "report_uuid": "bb93e1b2-36d6-439e-ac70-cccccccccc09",
  "job_uuid": "74a54a28-c628-4f82-86df-333333333334",
  "node_name": "RedHat(2)-beta-nginx(f)-apache(s)-failed",
  "environment": "DevSec Prod beta",
  "roles": ["base_linux", "apache_linux", "nginx-hardening-prod", "dot.role"],
  "recipes": ["apache_extras", "apache_extras::harden", "java::default", "nagios::fix"],
  "end_time": "2018-03-04T09:18:43Z",
  "version": "3.1.3",
  "platform": {
    "name": "redhat",
    "version": "3.1.3",
    "release": "6.11"
  },
  "statistics": {
    "duration": 3.309065
  },
  "other_checks": [],
  "policy_name": "",
  "policy_group": "",
  "organization_name": "",
  "source_fqdn": "localhost",
  "chef_tags": [],
  "ipaddress": "8.8.8.3",
  "fqdn": "web-rh3.example.com",
  "profiles": [
    {
      "name": "nginx-baseline",
      "title": "DevSec Nginx Baseline",
      "version": "2.1.0",
      "sha256": "09adcbb3b9b3233d5de63cd98a5ba3e155b3aaeb66b5abed379f5fb1ff143988",
      "maintainer": "DevSec Hardening Framework Team",
      "summary": "Test-suite for best-practice nginx hardening",
      "license": "Apache-2.0",
      "copyright": "DevSec Hardening Framework Team",
      "copyright_email": "hello@dev-sec.io",
      "supports": [
        {
          "os-family": "unix"
        }
      ],
      "depends": [
        {
          "name": "myprofile1-new-name",
          "path": "../myprofile1",
          "status": "skipped",
          "skip_message": "Skipping profile: 'myprofile1' on unsupported platform: 'mac_os_x/17.7.0'."
        }
      ],
      "attributes": [],
      "groups": [
        {
          "id": "controls/nginx_spec.rb",
          "controls": [
            "nginx-01",
            "nginx-02"
          ],
          "title": "NGINX server config"
        }
      ],
      "controls": [
        {
          "id": "nginx-01",
          "title": "Running worker process as non-privileged user",
          "desc": "The NGINX worker processes should run as non-privileged user. In case of compromise of the process, an attacker has full access to the system.",
          "impact": 1,
          "refs": [],
          "tags": {
            "web": null,
            "scope": "NginX",
            "satisfies": ["NGX-1", "NGX-2"]
          },
          "code": "control 'nginx-01' do\n  impact 1.0\n  title 'Running worker process as non-privileged user'\n  desc 'The NGINX worker processes should run as non-privileged user. In case of compromise of the process, an attacker has full access to the system.'\n  describe user(nginx_lib.valid_users) do\n    it { should exist }\n  end\n  describe parse_config_file(nginx_conf, options) do\n    its('user') { should eq nginx_lib.valid_users }\n  end\n\n  describe parse_config_file(nginx_conf, options) do\n    its('group') { should_not eq 'root' }\n  end\n  tag 'web'\n  tag 'scope': 'NginX'\n  tag 'satisfies': ['NGX-1', 'NGX-2']\nend\n",
          "source_location": {
            "line": 99,
            "ref": "nginx-baseline-master/controls/nginx_spec.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "nginx worker process value should eq 0",
              "run_time": 0.004171,
              "message": "\nexpected: 0\n     got: 1\n\n(compared using ==)\n"
            },
            {
              "status": "passed",
              "code_desc": "Kernel Parameter net.ipv4.conf.all.forwarding value should eq 0",
              "run_time": 0.004013,
              "message": "\nexpected: 0\n     got: 1\n\n(compared using ==)\n"
            }
          ]
        },
        {
          "id": "nginx-02",
          "title": "Check NGINX config file owner, group and permissions.",
          "desc": "The NGINX config file should owned by root, only be writable by owner and not write- and readable by others.",
          "impact": 1,
          "refs":[
            {
              "ref":"testing-ref", "url": "test-url"
            }
          ],
          "tags": {},
          "code": "control 'nginx-02' do\n  impact 1.0\n  title 'Check NGINX config file owner, group and permissions.'\n  desc 'The NGINX config file should owned by root, only be writable by owner and not write- and readable by others.'\n  describe file(nginx_conf) do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n",
          "source_location": {
            "line": 115,
            "ref": "nginx-baseline-master/controls/nginx_spec.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Worked like a charm baby!",
              "run_time": 0.000194
            }
          ]
        },
        {
          "id": "nginx-03",
          "title": "Check NGINX three.",
          "desc": "The NGINX three description.",
          "impact": 1,
          "refs": [],
          "tags": {},
          "code": "control 'nginx-03' do\n  impact 1.0\n  title 'Check NGINX config file owner, group and permissions.'\n  desc 'The NGINX config file should owned by root, only be writable by owner and not write- and readable by others.'\n  describe file(nginx_conf) do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n",
          "source_location": {
            "line": 115,
            "ref": "nginx-baseline-master/controls/nginx_spec.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Worked like a charm baby!",
              "run_time": 0.000194,
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "nginx-04",
          "title": "Check NGINX four",
          "desc": "The NGINX four description.",
          "impact": 0.5,
          "refs": [],
          "tags": {},
          "code": "control 'nginx-04' do\n  impact 1.0\n  title 'Running worker process as non-privileged user'\n  desc 'The NGINX worker processes should run as non-privileged user. In case of compromise of the process, an attacker has full access to the system.'\n  describe user(nginx_lib.valid_users) do\n    it { should exist }\n  end\n  describe parse_config_file(nginx_conf, options) do\n    its('user') { should eq nginx_lib.valid_users }\n  end\n\n  describe parse_config_file(nginx_conf, options) do\n    its('group') { should_not eq 'root' }\n  end\nend\n",
          "source_location": {
            "line": 99,
            "ref": "nginx-baseline-master/controls/nginx_spec.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "nginx worker process value should eq 0",
              "run_time": 0.004171,
              "message": "\nexpected: 0\n     got: 1\n\n(compared using ==)\n"
            },
            {
              "status": "failed",
              "code_desc": "Kernel Parameter net.ipv4.conf.all.forwarding value should eq 0",
              "run_time": 0.004013,
              "message": "\nexpected: 0\n     got: 1\n\n(compared using ==)\n"
            }
          ]
        }
      ],
      "status": "loaded"
    },
    {
      "title": "DevSec Apache Baseline",
      "version": "2.0.1",
      "sha256": "41a02784bfea15592ba2748d55927d8d1f9da205816ef18d3bb2ebe4c5ce18a9",
      "controls": [
        {
          "id": "apache-03",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-01",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-02",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-04",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-05",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-06",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-07",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-08",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-09",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-10",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-11",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-12",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-13",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "apache-14",
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        }
      ],
      "supports": null,
      "attributes": null,
      "groups": null,
      "status": "loaded"
    }
  ]
}
