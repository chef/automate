{"version":"1.28.1","other_checks":[],"profiles":[{"name":"linux","title":"Basic Linux","maintainer":"Chef Software, Inc.","copyright":"Chef Software, Inc.","copyright_email":"support@chef.io","license":"Proprietary, All rights reserved","summary":"Verify that Linux nodes are configured securely","version":"1.1.0","supports":[{"os-family":"unix"}],"controls":[{"title":"Do not accept SysRQs","desc":"SysRQs are not needed on a regular networked\nnode, so disable them.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-1' do\n  impact 0.5\n  title 'Do not accept SysRQs'\n  desc '\n    SysRQs are not needed on a regular networked\n    node, so disable them.\n  '\n  describe kernel_parameter('kernel.sysrq') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_spec.rb","line":6},"id":"sysctl-1","results":[{"status":"failed","code_desc":"Kernel Parameter kernel.sysrq value should eq 0","run_time":0.018511529,"start_time":"2017-06-21 19:45:46 +0000","message":"\nexpected: 0\n     got: 176\n\n(compared using ==)\n"}]},{"title":"Avoid core dumps","desc":"Avoid all forms of core dumps, as information\nmay be gathered from it by attackers.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-2' do\n  impact 0.5\n  title 'Avoid core dumps'\n  desc '\n    Avoid all forms of core dumps, as information\n    may be gathered from it by attackers.\n  '\n  describe kernel_parameter('fs.suid_dumpable') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_spec.rb","line":18},"id":"sysctl-2","results":[{"status":"failed","code_desc":"Kernel Parameter fs.suid_dumpable value should eq 0","run_time":0.014460021,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 2\n\n(compared using ==)\n"}]},{"title":"Without NX enabled, enforce exec-shield","desc":"If the CPU has NX enabled, buffer overflows are\nwell diminished through the CPU. If this setting is not\navailable, then at least enable the exec-shield feature\nin the kernel.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-3' do\n  impact 0.5\n  title 'Without NX enabled, enforce exec-shield'\n  desc '\n    If the CPU has NX enabled, buffer overflows are\n    well diminished through the CPU. If this setting is not\n    available, then at least enable the exec-shield feature\n    in the kernel.\n  '\n  # if no nx flag is present, we require exec-shield\n  describe 'No nx flag detected' do\n    it 'require kernel.exec-shield' do\n      if command('cat /proc/cpuinfo').stdout =~ /^flags.*?:.*? nx( .*?)?$/\n        expect(true).to be true\n      else\n        expect(kernel_parameter('kernel.exec-shield').value).to eq 1\n      end\n    end\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_spec.rb","line":30},"id":"sysctl-3","results":[{"status":"passed","code_desc":"No nx flag detected require kernel.exec-shield","run_time":0.015172999,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Set full address space layout randomization","desc":"Address space randomization makes attacks via\noverflows more difficult.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-4' do\n  impact 0.5\n  title 'Set full address space layout randomization'\n  desc '\n    Address space randomization makes attacks via\n    overflows more difficult.\n  '\n  describe kernel_parameter('kernel.randomize_va_space') do\n    its('value') { should eq 2 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_spec.rb","line":51},"id":"sysctl-4","results":[{"status":"passed","code_desc":"Kernel Parameter kernel.randomize_va_space value should eq 2","run_time":0.024180086,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Create a separate partition for /tmp","desc":"Since /tmp is world-writable, avoid resource\nexhaustion on the host by mounting this folder\nto a separate partition.","impact":0.5,"refs":[],"tags":{},"code":"control 'fs-1' do\n  impact 0.5\n  title 'Create a separate partition for /tmp'\n  desc '\n    Since /tmp is world-writable, avoid resource\n    exhaustion on the host by mounting this folder\n    to a separate partition.\n  '\n  describe mount('/tmp') do\n    it { should be_mounted }\n  end\nend\n","source_location":{"ref":"base/linux/controls/filesystem_spec.rb","line":6},"id":"fs-1","results":[{"status":"failed","code_desc":"Mount /tmp should be mounted","run_time":0.025083682,"start_time":"2017-06-21 19:45:47 +0000","message":"\nMount /tmp is not mounted\n"}]},{"title":"Set nodev option for /tmp partition","desc":"Since /tmp should not support devices,\nset the nodev option to prevent the user from\ncreating special devices.","impact":0.5,"refs":[],"tags":{},"code":"control 'fs-2' do\n  impact 0.5\n  title 'Set nodev option for /tmp partition'\n  desc '\n    Since /tmp should not support devices,\n    set the nodev option to prevent the user from\n    creating special devices.\n  '\n  describe mount('/tmp') do\n    its('options') { should include 'nodev' }\n  end\nend\n","source_location":{"ref":"base/linux/controls/filesystem_spec.rb","line":19},"id":"fs-2","results":[{"status":"failed","code_desc":"Mount /tmp options should include \"nodev\"","run_time":0.002146524,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to include \"nodev\", but it does not respond to `include?`"}]},{"title":"Set nosuid option for /tmp partition","desc":"Since /tmp is intended for temporary file storage only,\nset the nosuid option to prevent setuid executables.","impact":0.5,"refs":[],"tags":{},"code":"control 'fs-3' do\n  impact 0.5\n  title 'Set nosuid option for /tmp partition'\n  desc '\n    Since /tmp is intended for temporary file storage only,\n    set the nosuid option to prevent setuid executables.\n  '\n  describe mount('/tmp') do\n    its('options') { should include 'nosuid' }\n  end\nend\n","source_location":{"ref":"base/linux/controls/filesystem_spec.rb","line":32},"id":"fs-3","results":[{"status":"failed","code_desc":"Mount /tmp options should include \"nosuid\"","run_time":0.000216475,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to include \"nosuid\", but it does not respond to `include?`"}]},{"title":"Set noexec option for /tmp partition","desc":"Since /tmp is intended for temporary file storage only,\nset the noexec option to prevent executable files.\nShared executables may be manipulated by other users.\nRunning these indicates a serious vulnerability.","impact":0.5,"refs":[],"tags":{},"code":"control 'fs-4' do\n  impact 0.5\n  title 'Set noexec option for /tmp partition'\n  desc '\n    Since /tmp is intended for temporary file storage only,\n    set the noexec option to prevent executable files.\n    Shared executables may be manipulated by other users.\n    Running these indicates a serious vulnerability.\n  '\n  describe mount('/tmp') do\n    its('options') { should include 'noexec' }\n  end\nend\n","source_location":{"ref":"base/linux/controls/filesystem_spec.rb","line":44},"id":"fs-4","results":[{"status":"failed","code_desc":"Mount /tmp options should include \"noexec\"","run_time":0.000162239,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to include \"noexec\", but it does not respond to `include?`"}]},{"title":"/etc/ssh should be a directory","desc":"In order for OpenSSH to function correctly, its\nconfiguration path must be a folder.","impact":1.0,"refs":[],"tags":{},"code":"control 'basic-1' do\n  impact 1.0\n  title '/etc/ssh should be a directory'\n  desc '\n    In order for OpenSSH to function correctly, its\n    configuration path must be a folder.\n  '\n  describe file('/etc/ssh') do\n    it { should be_directory }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":6},"id":"basic-1","results":[{"status":"passed","code_desc":"File /etc/ssh should be directory","run_time":0.002213135,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Disable global IP forwarding","desc":"Regular nodes, which don't route/forward traffic\nshould have this option disabled.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-1.1' do\n  impact 0.5\n  title 'Disable global IP forwarding'\n  desc \"\n    Regular nodes, which don't route/forward traffic\n    should have this option disabled.\n  \"\n  describe kernel_parameter('net.ipv4.ip_forward') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":18},"id":"sysctl-ipv4-1.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.ip_forward value should eq 0","run_time":0.015128476,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable IP forwarding on all devices","desc":"Regular nodes, which don't route/forward traffic\nshould have this option disabled.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-1.2' do\n  impact 0.5\n  title 'Disable IP forwarding on all devices'\n  desc \"\n    Regular nodes, which don't route/forward traffic\n    should have this option disabled.\n  \"\n  describe kernel_parameter('net.ipv4.conf.all.forwarding') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":30},"id":"sysctl-ipv4-1.2","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.forwarding value should eq 0","run_time":0.024327723,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Set rp_filter to 1 for all devices","desc":"Instruct the kernel to do source validation by\nconfirming the reverse path.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-2.1' do\n  impact 0.5\n  title 'Set rp_filter to 1 for all devices'\n  desc '\n    Instruct the kernel to do source validation by\n    confirming the reverse path.\n  '\n  describe kernel_parameter('net.ipv4.conf.all.rp_filter') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":42},"id":"sysctl-ipv4-2.1","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.rp_filter value should eq 1","run_time":0.024162253,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Set rp_filter to 1 by default","desc":"Instruct the kernel to do source validation by\nconfirming the reverse path.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-2.2' do\n  impact 0.5\n  title 'Set rp_filter to 1 by default'\n  desc '\n    Instruct the kernel to do source validation by\n    confirming the reverse path.\n  '\n  describe kernel_parameter('net.ipv4.conf.default.rp_filter') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":54},"id":"sysctl-ipv4-2.2","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.default.rp_filter value should eq 1","run_time":0.024036541,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Ignore ICMP echo broadcasts","desc":"Don't respond to broadcast ICMP messages. This mechanism\ncan be used for resource starvation on the network.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-3' do\n  impact 0.5\n  title 'Ignore ICMP echo broadcasts'\n  desc \"\n    Don't respond to broadcast ICMP messages. This mechanism\n    can be used for resource starvation on the network.\n  \"\n  describe kernel_parameter('net.ipv4.icmp_echo_ignore_broadcasts') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":66},"id":"sysctl-ipv4-3","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.icmp_echo_ignore_broadcasts value should eq 1","run_time":0.023988032,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Ignore bogus ICMP error responses","desc":"Ignore all bogus ICMP error messages.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-4' do\n  impact 0.5\n  title 'Ignore bogus ICMP error responses'\n  desc '\n    Ignore all bogus ICMP error messages.\n  '\n  describe kernel_parameter('net.ipv4.icmp_ignore_bogus_error_responses') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":78},"id":"sysctl-ipv4-4","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.icmp_ignore_bogus_error_responses value should eq 1","run_time":0.024089778,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Specify a ratelimit for ICMP messages","desc":"For all messages specified in the ratemask,\nlimit the rate of responses to avoid resource starvation.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-5' do\n  impact 0.5\n  title 'Specify a ratelimit for ICMP messages'\n  desc '\n    For all messages specified in the ratemask,\n    limit the rate of responses to avoid resource starvation.\n  '\n  describe kernel_parameter('net.ipv4.icmp_ratelimit') do\n    its('value') { should eq 100 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":89},"id":"sysctl-ipv4-5","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.icmp_ratelimit value should eq 100","run_time":0.024361741,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 100\n     got: 1000\n\n(compared using ==)\n"}]},{"title":"Specify a ratemask for ICMP messages","desc":"For all messages specified in the ratemask,\nlimit the rate of responses to avoid resource starvation.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-6' do\n  impact 0.5\n  title 'Specify a ratemask for ICMP messages'\n  desc '\n    For all messages specified in the ratemask,\n    limit the rate of responses to avoid resource starvation.\n  '\n  describe kernel_parameter('net.ipv4.icmp_ratemask') do\n    its('value') { should eq 88089 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":101},"id":"sysctl-ipv4-6","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.icmp_ratemask value should eq 88089","run_time":0.02412451,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 88089\n     got: 6168\n\n(compared using ==)\n"}]},{"title":"Do not use TCP timestamps","desc":"Avoid TCP timestamps, which can be used to gain\ninformation on the system and network.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-7' do\n  impact 0.5\n  title 'Do not use TCP timestamps'\n  desc '\n    Avoid TCP timestamps, which can be used to gain\n    information on the system and network.\n  '\n  describe kernel_parameter('net.ipv4.tcp_timestamps') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":113},"id":"sysctl-ipv4-7","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.tcp_timestamps value should eq 0","run_time":0.025271431,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Enable ARP ignore","desc":"Reply to requests only if the target IP is configured\non the requested interface.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-8.1' do\n  impact 0.5\n  title 'Enable ARP ignore'\n  desc '\n    Reply to requests only if the target IP is configured\n    on the requested interface.\n  '\n  describe kernel_parameter('net.ipv4.conf.all.arp_ignore') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":125},"id":"sysctl-ipv4-8.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.arp_ignore value should eq 1","run_time":0.015310782,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 1\n     got: 0\n\n(compared using ==)\n"}]},{"title":"Restrict ARP announcements","desc":"Select the best local address on ARP requests.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-8.2' do\n  impact 0.5\n  title 'Restrict ARP announcements'\n  desc '\n    Select the best local address on ARP requests.\n  '\n  describe kernel_parameter('net.ipv4.conf.all.arp_announce') do\n    its('value') { should eq 2 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":137},"id":"sysctl-ipv4-8.2","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.arp_announce value should eq 2","run_time":0.025103599,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 2\n     got: 0\n\n(compared using ==)\n"}]},{"title":"Behave as described in RFC 1337","desc":"Let TIME_WAIT packets idle out even if a RST is received,\nas described in RFC 1337","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-9.1' do\n  impact 0.5\n  title 'Behave as described in RFC 1337'\n  desc '\n    Let TIME_WAIT packets idle out even if a RST is received,\n    as described in RFC 1337\n  '\n  describe kernel_parameter('net.ipv4.tcp_rfc1337') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":148},"id":"sysctl-ipv4-9.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.tcp_rfc1337 value should eq 1","run_time":0.024848334,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 1\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Enable TCP syn-cookies","desc":"Avoid DoS TCP SYN attacks, by enabling SYN cookies.","impact":1.0,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-9.2' do\n  impact 1.0\n  title 'Enable TCP syn-cookies'\n  desc '\n    Avoid DoS TCP SYN attacks, by enabling SYN cookies.\n  '\n  describe kernel_parameter('net.ipv4.tcp_syncookies') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":160},"id":"sysctl-ipv4-9.2","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.tcp_syncookies value should eq 1","run_time":0.024946715,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Enable shared_media to avoid disabling secure_redirects on all devices","desc":"Indicates that the device is shared with different subnets.\nDo not disable this setting as it will disable secure_redirects.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-10.1' do\n  impact 0.5\n  title 'Enable shared_media to avoid disabling secure_redirects on all devices'\n  desc '\n    Indicates that the device is shared with different subnets.\n    Do not disable this setting as it will disable secure_redirects.\n  '\n  describe kernel_parameter('net.ipv4.conf.all.shared_media') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":171},"id":"sysctl-ipv4-10.1","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.shared_media value should eq 1","run_time":0.025151252,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Enable shared_media to avoid disabling secure_redirects by default","desc":"Indicates that the device is shared with different subnets.\nDo not disable this setting as it will disable secure_redirects.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-10.2' do\n  impact 0.5\n  title 'Enable shared_media to avoid disabling secure_redirects by default'\n  desc '\n    Indicates that the device is shared with different subnets.\n    Do not disable this setting as it will disable secure_redirects.\n  '\n  describe kernel_parameter('net.ipv4.conf.default.shared_media') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":183},"id":"sysctl-ipv4-10.2","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.default.shared_media value should eq 1","run_time":0.01490931,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Do not accept source routes on all devices","desc":"For regular nodes on the network, do not accept source routes.\nThis can be used to redirect traffics through the network and\ncould be used avoid security gates.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-11.1' do\n  impact 0.5\n  title 'Do not accept source routes on all devices'\n  desc '\n    For regular nodes on the network, do not accept source routes.\n    This can be used to redirect traffics through the network and\n    could be used avoid security gates.\n  '\n  describe kernel_parameter('net.ipv4.conf.all.accept_source_route') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":195},"id":"sysctl-ipv4-11.1","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.accept_source_route value should eq 0","run_time":0.024401533,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Do not accept source routes by default","desc":"For regular nodes on the network, do not accept source routes.\nThis can be used to redirect traffics through the network and\ncould be used avoid security gates.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-11.2' do\n  impact 0.5\n  title 'Do not accept source routes by default'\n  desc '\n    For regular nodes on the network, do not accept source routes.\n    This can be used to redirect traffics through the network and\n    could be used avoid security gates.\n  '\n  describe kernel_parameter('net.ipv4.conf.default.accept_source_route') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":208},"id":"sysctl-ipv4-11.2","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.accept_source_route value should eq 0","run_time":0.025936807,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable accepting redirects on all devices","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-12.2' do\n  impact 0.5\n  title 'Disable accepting redirects on all devices'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv4.conf.all.accept_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":221},"id":"sysctl-ipv4-12.2","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.accept_redirects value should eq 0","run_time":0.02425437,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Disable accepting redirects by default","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-12.1' do\n  impact 0.5\n  title 'Disable accepting redirects by default'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv4.conf.default.accept_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":233},"id":"sysctl-ipv4-12.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.accept_redirects value should eq 0","run_time":0.024344126,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable all redirects on all devices","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-13.1' do\n  impact 0.5\n  title 'Disable all redirects on all devices'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv4.conf.all.secure_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":245},"id":"sysctl-ipv4-13.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.secure_redirects value should eq 0","run_time":0.024093276,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable all redirects by default","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-13.2' do\n  impact 0.5\n  title 'Disable all redirects by default'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv4.conf.default.secure_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":257},"id":"sysctl-ipv4-13.2","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.secure_redirects value should eq 0","run_time":0.024317729,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable sending redirects on all devices","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-14.1' do\n  impact 0.5\n  title 'Disable sending redirects on all devices'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv4.conf.all.send_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":269},"id":"sysctl-ipv4-14.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.all.send_redirects value should eq 0","run_time":0.025131668,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable sending redirects by default","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-14.2' do\n  impact 0.5\n  title 'Disable sending redirects by default'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv4.conf.default.send_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":281},"id":"sysctl-ipv4-14.2","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv4.conf.default.send_redirects value should eq 0","run_time":0.025308303,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable logging martians on all devices","desc":"Avoid resource starvation on the server by disabling\nlogging martians on production systems. It may still be useful\nfor debugging and analysis purposes.","impact":0.3,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-15.1' do\n  impact 0.3\n  title 'Disable logging martians on all devices'\n  desc '\n    Avoid resource starvation on the server by disabling\n    logging martians on production systems. It may still be useful\n    for debugging and analysis purposes.\n  '\n  describe kernel_parameter('net.ipv4.conf.all.log_martians') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":293},"id":"sysctl-ipv4-15.1","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.all.log_martians value should eq 0","run_time":0.013985092,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Disable logging martians by default","desc":"Avoid resource starvation on the server by disabling\nlogging martians on production systems. It may still be useful\nfor debugging and analysis purposes.","impact":0.3,"refs":[],"tags":{},"code":"control 'sysctl-ipv4-15.2' do\n  impact 0.3\n  title 'Disable logging martians by default'\n  desc '\n    Avoid resource starvation on the server by disabling\n    logging martians on production systems. It may still be useful\n    for debugging and analysis purposes.\n  '\n  describe kernel_parameter('net.ipv4.conf.default.log_martians') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv4_spec.rb","line":306},"id":"sysctl-ipv4-15.2","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv4.conf.default.log_martians value should eq 0","run_time":0.024130036,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"For regular IPv4-only servers, disable IPv6","desc":"Unless explicitly needed, do not enable\nIPv6 on the node to reduce the attack surface.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-1' do\n  impact 0.5\n  title 'For regular IPv4-only servers, disable IPv6'\n  desc '\n    Unless explicitly needed, do not enable\n    IPv6 on the node to reduce the attack surface.\n  '\n  describe kernel_parameter('net.ipv6.conf.all.disable_ipv6') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":6},"id":"sysctl-ipv6-1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.all.disable_ipv6 value should eq 1","run_time":0.024081767,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 1\n     got: 0\n\n(compared using ==)\n"}]},{"title":"Disable IP forwarding on regular nodes","desc":"Regular nodes, which don't route/forward traffic\nshould have this option disabled.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-2' do\n  impact 0.5\n  title 'Disable IP forwarding on regular nodes'\n  desc \"\n    Regular nodes, which don't route/forward traffic\n    should have this option disabled.\n  \"\n  describe kernel_parameter('net.ipv6.conf.all.forwarding') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":18},"id":"sysctl-ipv6-2","results":[{"status":"passed","code_desc":"Kernel Parameter net.ipv6.conf.all.forwarding value should eq 0","run_time":0.023942042,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Disable accepting redirects by default","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-3.1' do\n  impact 0.5\n  title 'Disable accepting redirects by default'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv6.conf.default.accept_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":30},"id":"sysctl-ipv6-3.1","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_redirects value should eq 0","run_time":0.023960372,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable accepting redirects on all devices","desc":"Disable all types of redirects on regular nodes which are\nnot routers","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-3.2' do\n  impact 0.5\n  title 'Disable accepting redirects on all devices'\n  desc '\n    Disable all types of redirects on regular nodes which are\n    not routers\n  '\n  describe kernel_parameter('net.ipv6.conf.all.accept_redirects') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":42},"id":"sysctl-ipv6-3.2","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.all.accept_redirects value should eq 0","run_time":0.024292478,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Disable router solicitations","desc":"Disable all sysctl functions that are only relevant,\nif this machine is a router.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-4' do\n  impact 0.5\n  title 'Disable router solicitations'\n  desc '\n    Disable all sysctl functions that are only relevant,\n    if this machine is a router.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.router_solicitations') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":54},"id":"sysctl-ipv6-4","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.router_solicitations value should eq 0","run_time":0.024933292,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 3\n\n(compared using ==)\n"}]},{"title":"Do not accept router preference in router advertisement","desc":"Disable all sysctl functions that are only relevant,\nif this machine is a router.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-5' do\n  impact 0.5\n  title 'Do not accept router preference in router advertisement'\n  desc '\n    Disable all sysctl functions that are only relevant,\n    if this machine is a router.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra_rtr_pref') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":66},"id":"sysctl-ipv6-5","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra_rtr_pref value should eq 0","run_time":0.014015259,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Do not learn prefix information in router advertisement","desc":"Disable all sysctl functions that are only relevant,\nif this machine is a router.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-6' do\n  impact 0.5\n  title 'Do not learn prefix information in router advertisement'\n  desc '\n    Disable all sysctl functions that are only relevant,\n    if this machine is a router.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra_pinfo') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":78},"id":"sysctl-ipv6-6","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra_pinfo value should eq 0","run_time":0.024280424,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Do not accept hop limit settings in router advertisement","desc":"Disable all sysctl functions that are only relevant,\nif this machine is a router.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-7' do\n  impact 0.5\n  title 'Do not accept hop limit settings in router advertisement'\n  desc '\n    Disable all sysctl functions that are only relevant,\n    if this machine is a router.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra_defrtr') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":90},"id":"sysctl-ipv6-7","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.accept_ra_defrtr value should eq 0","run_time":0.024517526,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Do not let router advertisements assign a global unicast address","desc":"Disable all sysctl functions that are only relevant,\nif this machine is a router.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-8' do\n  impact 0.5\n  title 'Do not let router advertisements assign a global unicast address'\n  desc '\n    Disable all sysctl functions that are only relevant,\n    if this machine is a router.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.autoconf') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":102},"id":"sysctl-ipv6-8","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.autoconf value should eq 0","run_time":0.024676328,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Do not send neighborhood solicitations per address","desc":"Disable all sysctl functions that are only relevant,\nif this machine is a router.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-9' do\n  impact 0.5\n  title 'Do not send neighborhood solicitations per address'\n  desc '\n    Disable all sysctl functions that are only relevant,\n    if this machine is a router.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.dad_transmits') do\n    its('value') { should eq 0 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":114},"id":"sysctl-ipv6-9","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.dad_transmits value should eq 0","run_time":0.024186985,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Only allow one global unicast address per interface","desc":"Avoid having different unicast addresses per interface.","impact":0.5,"refs":[],"tags":{},"code":"control 'sysctl-ipv6-10' do\n  impact 0.5\n  title 'Only allow one global unicast address per interface'\n  desc '\n    Avoid having different unicast addresses per interface.\n  '\n  describe kernel_parameter('net.ipv6.conf.default.max_addresses') do\n    its('value') { should eq 1 }\n  end\nend\n","source_location":{"ref":"base/linux/controls/sysctl_ipv6_spec.rb","line":126},"id":"sysctl-ipv6-10","results":[{"status":"failed","code_desc":"Kernel Parameter net.ipv6.conf.default.max_addresses value should eq 1","run_time":0.014308142,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: 1\n     got: 16\n\n(compared using ==)\n"}]}],"groups":[{"title":"sysctl Settings","controls":["sysctl-1","sysctl-2","sysctl-3","sysctl-4"],"id":"controls/sysctl_spec.rb"},{"title":"Filesystem Configuration","controls":["fs-1","fs-2","fs-3","fs-4"],"id":"controls/filesystem_spec.rb"},{"title":"Sysctl IPv4 Settings","controls":["basic-1","sysctl-ipv4-1.1","sysctl-ipv4-1.2","sysctl-ipv4-2.1","sysctl-ipv4-2.2","sysctl-ipv4-3","sysctl-ipv4-4","sysctl-ipv4-5","sysctl-ipv4-6","sysctl-ipv4-7","sysctl-ipv4-8.1","sysctl-ipv4-8.2","sysctl-ipv4-9.1","sysctl-ipv4-9.2","sysctl-ipv4-10.1","sysctl-ipv4-10.2","sysctl-ipv4-11.1","sysctl-ipv4-11.2","sysctl-ipv4-12.2","sysctl-ipv4-12.1","sysctl-ipv4-13.1","sysctl-ipv4-13.2","sysctl-ipv4-14.1","sysctl-ipv4-14.2","sysctl-ipv4-15.1","sysctl-ipv4-15.2"],"id":"controls/sysctl_ipv4_spec.rb"},{"title":"Sysctl IPv6 Settings","controls":["sysctl-ipv6-1","sysctl-ipv6-2","sysctl-ipv6-3.1","sysctl-ipv6-3.2","sysctl-ipv6-4","sysctl-ipv6-5","sysctl-ipv6-6","sysctl-ipv6-7","sysctl-ipv6-8","sysctl-ipv6-9","sysctl-ipv6-10"],"id":"controls/sysctl_ipv6_spec.rb"}],"attributes":[],"sha256":"ac3735092676fe76843e312cbc917ccad958ead6bbf227a109c6e848d8533fc1"},{"name":"ssh","title":"Basic SSH","maintainer":"Chef Software, Inc.","copyright":"Chef Software, Inc.","copyright_email":"support@chef.io","license":"Proprietary, All rights reserved","summary":"Verify that SSH Server and SSH Client are configured securely","version":"1.1.0","supports":[{"os-family":"unix"}],"controls":[{"title":"/etc/ssh should be a directory","desc":"In order for OpenSSH to function correctly, its\nconfiguration path must be a folder.","impact":1.0,"refs":[],"tags":{},"code":"control 'basic-1' do\n  impact 1.0\n  title '/etc/ssh should be a directory'\n  desc '\n    In order for OpenSSH to function correctly, its\n    configuration path must be a folder.\n  '\n  describe file('/etc/ssh') do\n    it { should be_directory }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_folder_spec.rb","line":10},"id":"basic-1","results":[{"status":"passed","code_desc":"File /etc/ssh should be directory","run_time":0.000152503,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"/etc/ssh should be owned by root","desc":"The OpenSSH configuration folder should be owned\nby the root user. It is an important step towards making\nsure, that configuration files are only changed by\npriviledged users.","impact":1.0,"refs":[],"tags":{},"code":"control 'basic-2' do\n  impact 1.0\n  title '/etc/ssh should be owned by root'\n  desc '\n    The OpenSSH configuration folder should be owned\n    by the root user. It is an important step towards making\n    sure, that configuration files are only changed by\n    priviledged users.\n  '\n  describe file('/etc/ssh') do\n    it { should be_owned_by 'root' }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_folder_spec.rb","line":22},"id":"basic-2","results":[{"status":"passed","code_desc":"File /etc/ssh should be owned by \"root\"","run_time":0.014935893,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"/etc/ssh should have limited access to 0755","desc":"The OpenSSH configuration folder should have restricted\naccess permissions. It is an important step towards making\nsure, that configuration files are only changed by\npriviledged users, while leaving them readable for the\nSSH client.","impact":0.5,"refs":[],"tags":{},"code":"control 'basic-3' do\n  impact 0.5\n  title '/etc/ssh should have limited access to 0755'\n  desc '\n    The OpenSSH configuration folder should have restricted\n    access permissions. It is an important step towards making\n    sure, that configuration files are only changed by\n    priviledged users, while leaving them readable for the\n    SSH client.\n  '\n  describe file('/etc/ssh') do\n    it { should_not be_writable.by('group') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_readable.by('others') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_folder_spec.rb","line":36},"id":"basic-3","results":[{"status":"passed","code_desc":"File /etc/ssh should not be writable by group","run_time":0.000222758,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"passed","code_desc":"File /etc/ssh should not be writable by others","run_time":0.000120033,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"failed","code_desc":"File /etc/ssh should not be readable by others","run_time":0.000199413,"start_time":"2017-06-21 19:45:47 +0000","message":"expected File /etc/ssh not to be readable by others"}]},{"title":"ssh_config should have restricted access to 0644","desc":"The system-wide client ssh configuration file\nshould only be modified by its owner (root).","impact":0.5,"refs":[],"tags":{},"code":"control 'basic-6' do\n  impact 0.5\n  title 'ssh_config should have restricted access to 0644'\n  desc '\n    The system-wide client ssh configuration file\n    should only be modified by its owner (root).\n  '\n  describe file('/etc/ssh/ssh_config') do\n    its('mode') { should cmp '0644' }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":10},"id":"basic-6","results":[{"status":"passed","code_desc":"File /etc/ssh/ssh_config mode should cmp == \"0644\"","run_time":0.014984359,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Client: Configure address family","desc":"OpenSSH should be configured to the network family.\nSet it to inet if you use IPv4 only. For IPv6 only set it\nto inet6.","impact":0.1,"refs":[],"tags":{},"code":"control 'ssh-1' do\n  impact 0.1\n  title 'Client: Configure address family'\n  desc '\n    OpenSSH should be configured to the network family.\n    Set it to inet if you use IPv4 only. For IPv6 only set it\n    to inet6.\n  '\n  describe ssh_config do\n    its('AddressFamily') { should match(/inet|any/) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":22},"id":"ssh-1","results":[{"status":"failed","code_desc":"SSH Configuration AddressFamily should match /inet|any/","run_time":0.002598182,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to match /inet|any/"}]},{"title":"Client: Configure expected port","desc":"Configure the port which you expect your SSH client to\nconnect to.","impact":0.1,"refs":[],"tags":{},"code":"control 'ssh-3' do\n  impact 0.1\n  title 'Client: Configure expected port'\n  desc '\n    Configure the port which you expect your SSH client to\n    connect to.\n  '\n  describe ssh_config do\n    its('Port') { should eq('22') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":35},"id":"ssh-3","results":[{"status":"failed","code_desc":"SSH Configuration Port should eq \"22\"","run_time":0.000411991,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"22\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Set SSH protocol version to 2","desc":"Set the SSH protocol version to 2. Don't use legacy\ninsecure SSHv1 connections anymore.","impact":1.0,"refs":[],"tags":{},"code":"control 'ssh-4' do\n  impact 1.0\n  title 'Client: Set SSH protocol version to 2'\n  desc \"\n    Set the SSH protocol version to 2. Don't use legacy\n    insecure SSHv1 connections anymore.\n  \"\n  describe ssh_config do\n    its('Protocol') { should eq('2') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":47},"id":"ssh-4","results":[{"status":"failed","code_desc":"SSH Configuration Protocol should eq \"2\"","run_time":0.000389104,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"2\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Disable batch mode","desc":"Avoid batch mode in the default configuration.","impact":0.1,"refs":[],"tags":{},"code":"control 'ssh-5' do\n  impact 0.1\n  title 'Client: Disable batch mode'\n  desc '\n    Avoid batch mode in the default configuration.\n  '\n  describe ssh_config do\n    its('BatchMode') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":59},"id":"ssh-5","results":[{"status":"failed","code_desc":"SSH Configuration BatchMode should eq \"no\"","run_time":0.000381117,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Check Host IPs","desc":"Make sure that SSH checks the host IP address in the\nknown_hosts file, to avoid DNS spoofing effects.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-6' do\n  impact 0.5\n  title 'Client: Check Host IPs'\n  desc '\n    Make sure that SSH checks the host IP address in the\n    known_hosts file, to avoid DNS spoofing effects.\n  '\n  describe ssh_config do\n    its('CheckHostIP') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":70},"id":"ssh-6","results":[{"status":"failed","code_desc":"SSH Configuration CheckHostIP should eq \"yes\"","run_time":0.000343028,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"yes\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Ask when checking host keys","desc":"Don't automatically add new host keys to the list of\nknown hosts.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-7' do\n  impact 0.5\n  title 'Client: Ask when checking host keys'\n  desc \"\n    Don't automatically add new host keys to the list of\n    known hosts.\n  \"\n  describe ssh_config do\n    its('StrictHostKeyChecking') { should match(/ask|yes/) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":82},"id":"ssh-7","results":[{"status":"failed","code_desc":"SSH Configuration StrictHostKeyChecking should match /ask|yes/","run_time":0.000345427,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to match /ask|yes/"}]},{"title":"Client: Configure safe ciphers","desc":"Configure a list of current ciphers and avoid older\nand weaker settings.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-8' do\n  impact 0.5\n  title 'Client: Configure safe ciphers'\n  desc '\n    Configure a list of current ciphers and avoid older\n    and weaker settings.\n  '\n  describe ssh_config do\n    its('Ciphers') { should match(ssh_crypto.valid_ciphers) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":94},"id":"ssh-8","results":[{"status":"failed","code_desc":"SSH Configuration Ciphers should match \"aes256-ctr,aes192-ctr,aes128-ctr\"","run_time":0.000353382,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to match \"aes256-ctr,aes192-ctr,aes128-ctr\""}]},{"title":"Client: Configure safe MACs","desc":"Configure a list of current MACs and avoid older\nand weaker settings.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-9' do\n  impact 0.5\n  title 'Client: Configure safe MACs'\n  desc '\n    Configure a list of current MACs and avoid older\n    and weaker settings.\n  '\n  describe ssh_config do\n    its('MACs') { should match(ssh_crypto.valid_macs) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":106},"id":"ssh-9","results":[{"status":"failed","code_desc":"SSH Configuration MACs should match \"hmac-sha2-512,hmac-sha2-256,hmac-ripemd160\"","run_time":0.000343849,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to match \"hmac-sha2-512,hmac-sha2-256,hmac-ripemd160\""}]},{"title":"Client: Configure safe Key Exchange algorithms","desc":"Configure a list of current key-exchange algorithms\nand avoid older and weaker settings.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-10' do\n  impact 0.5\n  title 'Client: Configure safe Key Exchange algorithms'\n  desc '\n    Configure a list of current key-exchange algorithms\n    and avoid older and weaker settings.\n  '\n  describe ssh_config do\n    its('KexAlgorithms') { should match(ssh_crypto.valid_kexs) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":118},"id":"ssh-10","results":[{"status":"failed","code_desc":"SSH Configuration KexAlgorithms should match \"diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1\"","run_time":0.000367731,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to match \"diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1\""}]},{"title":"Client: Disable agent forwarding","desc":"Prevent agent forwarding by default, as it can\nbe used in a limited way to enable attacks.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-11' do\n  impact 0.5\n  title 'Client: Disable agent forwarding'\n  desc '\n    Prevent agent forwarding by default, as it can\n    be used in a limited way to enable attacks.\n  '\n  describe ssh_config do\n    its('ForwardAgent') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":130},"id":"ssh-11","results":[{"status":"failed","code_desc":"SSH Configuration ForwardAgent should eq \"no\"","run_time":0.00039952,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Disable X11 forwarding","desc":"Prevent X11 forwarding by default, as it can\nbe used in a limited way to enable attacks.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-12' do\n  impact 0.5\n  title 'Client: Disable X11 forwarding'\n  desc '\n    Prevent X11 forwarding by default, as it can\n    be used in a limited way to enable attacks.\n  '\n  describe ssh_config do\n    its('ForwardX11') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":142},"id":"ssh-12","results":[{"status":"failed","code_desc":"SSH Configuration ForwardX11 should eq \"no\"","run_time":0.000339082,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Disable host-based authentication","desc":"Avoid host-based authentication, as it opens more ways\nfor an attacker to enter a system.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-13' do\n  impact 0.5\n  title 'Client: Disable host-based authentication'\n  desc '\n    Avoid host-based authentication, as it opens more ways\n    for an attacker to enter a system.\n    '\n  describe ssh_config do\n    its('HostbasedAuthentication') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":154},"id":"ssh-13","results":[{"status":"failed","code_desc":"SSH Configuration HostbasedAuthentication should eq \"no\"","run_time":0.000344739,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Disable rhosts-based authentication","desc":"Avoid rhosts-based authentication, as it opens more ways\nfor an attacker to enter a system.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-14' do\n  impact 0.5\n  title 'Client: Disable rhosts-based authentication'\n  desc '\n    Avoid rhosts-based authentication, as it opens more ways\n    for an attacker to enter a system.\n    '\n  describe ssh_config do\n    its('RhostsRSAAuthentication') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":166},"id":"ssh-14","results":[{"status":"failed","code_desc":"SSH Configuration RhostsRSAAuthentication should eq \"no\"","run_time":0.000337584,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Enable RSA authentication","desc":"Make sure RSA authentication is used by default.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-15' do\n  impact 0.5\n  title 'Client: Enable RSA authentication'\n  desc '\n    Make sure RSA authentication is used by default.\n  '\n  describe ssh_config do\n    its('RSAAuthentication') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":178},"id":"ssh-15","results":[{"status":"failed","code_desc":"SSH Configuration RSAAuthentication should eq \"yes\"","run_time":0.000384263,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"yes\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Disable password-based authentication","desc":"Avoid all password-based authentications. They are\noften weaker than key-based authentication and may enable\nweak passwords to enter a system.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-16' do\n  impact 0.5\n  title 'Client: Disable password-based authentication'\n  desc '\n    Avoid all password-based authentications. They are\n    often weaker than key-based authentication and may enable\n    weak passwords to enter a system.\n  '\n  describe ssh_config do\n    its('PasswordAuthentication') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":189},"id":"ssh-16","results":[{"status":"failed","code_desc":"SSH Configuration PasswordAuthentication should eq \"no\"","run_time":0.000347151,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Disable tunnels","desc":"Avoid using SSH tunnels.","impact":0.1,"refs":[],"tags":{},"code":"control 'ssh-19' do\n  impact 0.1\n  title 'Client: Disable tunnels'\n  desc '\n    Avoid using SSH tunnels.\n  '\n  describe ssh_config do\n    its('Tunnel') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":202},"id":"ssh-19","results":[{"status":"failed","code_desc":"SSH Configuration Tunnel should eq \"no\"","run_time":0.000340715,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Client: Do not permit local commands","desc":"Do not permit any local command execution.","impact":0.5,"refs":[],"tags":{},"code":"control 'ssh-20' do\n  impact 0.5\n  title 'Client: Do not permit local commands'\n  desc '\n    Do not permit any local command execution.\n  '\n  describe ssh_config do\n    its('PermitLocalCommand') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/ssh_spec.rb","line":213},"id":"ssh-20","results":[{"status":"failed","code_desc":"SSH Configuration PermitLocalCommand should eq \"no\"","run_time":0.000339294,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"sshd_config should be owned by root","desc":"The SSH server configuration file\nshould only be modified by its owner (root).","impact":1.0,"refs":[],"tags":{},"code":"control 'basic-4' do\n  impact 1.0\n  title 'sshd_config should be owned by root'\n  desc '\n    The SSH server configuration file\n    should only be modified by its owner (root).\n  '\n  describe file('/etc/ssh/sshd_config') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":10},"id":"basic-4","results":[{"status":"passed","code_desc":"File /etc/ssh/sshd_config should be owned by \"root\"","run_time":0.015578676,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"passed","code_desc":"File /etc/ssh/sshd_config should be grouped into \"root\"","run_time":0.000166018,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"sshd_config should not be group-writable/executable","desc":"The SSH server configuration file\nshould not be executable (to its owner).","impact":0.5,"refs":[],"tags":{},"code":"control 'basic-4.1' do\n  impact 0.5\n  title 'sshd_config should not be group-writable/executable'\n  desc '\n    The SSH server configuration file\n    should not be executable (to its owner).\n  '\n  describe file('/etc/ssh/sshd_config') do\n    it { should_not be_executable.by('owner') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":23},"id":"basic-4.1","results":[{"status":"passed","code_desc":"File /etc/ssh/sshd_config should not be executable by owner","run_time":0.000270123,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"sshd_config should not be group-writable/executable","desc":"The SSH server configuration file\nshould only be modified and used by its owner (root).","impact":0.5,"refs":[],"tags":{},"code":"control 'basic-5' do\n  impact 0.5\n  title 'sshd_config should not be group-writable/executable'\n  desc '\n    The SSH server configuration file\n    should only be modified and used by its owner (root).\n  '\n  describe file('/etc/ssh/sshd_config') do\n    it { should_not be_writable.by('group') }\n    it { should_not be_executable.by('group') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":35},"id":"basic-5","results":[{"status":"passed","code_desc":"File /etc/ssh/sshd_config should not be writable by group","run_time":0.000154766,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"passed","code_desc":"File /etc/ssh/sshd_config should not be executable by group","run_time":0.000170401,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"sshd_config should not be writable/executable to others","desc":"The SSH server configuration file\nshould only be modified and used by its owner (root).","impact":1.0,"refs":[],"tags":{},"code":"control 'basic-6.1' do\n  impact 1.0\n  title 'sshd_config should not be writable/executable to others'\n  desc '\n    The SSH server configuration file\n    should only be modified and used by its owner (root).\n  '\n  describe file('/etc/ssh/sshd_config') do\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":48},"id":"basic-6.1","results":[{"status":"passed","code_desc":"File /etc/ssh/sshd_config should not be writable by others","run_time":0.00015859,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"passed","code_desc":"File /etc/ssh/sshd_config should not be executable by others","run_time":0.000127286,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"sshd_config should not be accessible to others","desc":"The SSH server configuration file\nshould only be modified and used by its owner (root).","impact":0.1,"refs":[],"tags":{},"code":"control 'basic-6.2' do\n  impact 0.1\n  title 'sshd_config should not be accessible to others'\n  desc '\n    The SSH server configuration file\n    should only be modified and used by its owner (root).\n  '\n  describe file('/etc/ssh/sshd_config') do\n    it { should_not be_readable.by('others') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":61},"id":"basic-6.2","results":[{"status":"failed","code_desc":"File /etc/ssh/sshd_config should not be readable by others","run_time":0.000214047,"start_time":"2017-06-21 19:45:47 +0000","message":"expected File /etc/ssh/sshd_config not to be readable by others"}]},{"title":"Server: Do not permit root-based login","desc":"To reduce the potential to gain full privileges\nof a system in the course of one attack (by either misconfiguration\nor vulnerabilities), do not allow logging in as the root user.","impact":1.0,"refs":[],"tags":{},"code":"control 'sshd-7' do\n  impact 1.0\n  title 'Server: Do not permit root-based login'\n  desc '\n    To reduce the potential to gain full privileges\n    of a system in the course of one attack (by either misconfiguration\n    or vulnerabilities), do not allow logging in as the root user.\n  '\n  describe sshd_config do\n    its('PermitRootLogin') { should match(/no|without-password/) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":73},"id":"sshd-7","results":[{"status":"passed","code_desc":"SSHD Configuration PermitRootLogin should match /no|without-password/","run_time":0.00054164,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Server: Configure the service port","desc":"Always specify which port the SSH server should listen to.\nPrevent unexpected settings.","impact":0.6,"refs":[],"tags":{},"code":"control 'sshd-8' do\n  impact 0.6\n  title 'Server: Configure the service port'\n  desc '\n    Always specify which port the SSH server should listen to.\n    Prevent unexpected settings.\n  '\n  describe sshd_config do\n    its('Port') { should eq('22') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":86},"id":"sshd-8","results":[{"status":"passed","code_desc":"SSHD Configuration Port should eq \"22\"","run_time":0.000503941,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Server: Specify a valid address family","desc":"OpenSSH should be configured to the network family.\nSet it to inet if you use IPv4 only. For IPv6 only set it\nto inet6.","impact":0.1,"refs":[],"tags":{},"code":"control 'sshd-9' do\n  impact 0.1\n  title 'Server: Specify a valid address family'\n  desc '\n    OpenSSH should be configured to the network family.\n    Set it to inet if you use IPv4 only. For IPv6 only set it\n    to inet6.\n  '\n  describe sshd_config do\n    its('AddressFamily') { should match(/inet|any/) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":98},"id":"sshd-9","results":[{"status":"failed","code_desc":"SSHD Configuration AddressFamily should match /inet|any/","run_time":0.000487404,"start_time":"2017-06-21 19:45:47 +0000","message":"expected nil to match /inet|any/"}]},{"title":"Server: Configure a listen address","desc":"Limit the SSH server to listen to a specific\naddress. Don't let it listen on all interfaces to avoid\nlogins from unexpected sources.","impact":0.6,"refs":[],"tags":{},"code":"control 'sshd-10' do\n  impact 0.6\n  title 'Server: Configure a listen address'\n  desc \"\n    Limit the SSH server to listen to a specific\n    address. Don't let it listen on all interfaces to avoid\n    logins from unexpected sources.\n  \"\n  describe sshd_config do\n    its('ListenAddress') { should_not eq('0.0.0.0') }\n    its('ListenAddress') { should_not eq('::') }\n    its('ListenAddress') { should_not eq(nil) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":111},"id":"sshd-10","results":[{"status":"passed","code_desc":"SSHD Configuration ListenAddress should not eq \"0.0.0.0\"","run_time":0.000460011,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"passed","code_desc":"SSHD Configuration ListenAddress should not eq \"::\"","run_time":0.000105534,"start_time":"2017-06-21 19:45:47 +0000"},{"status":"failed","code_desc":"SSHD Configuration ListenAddress should not eq nil","run_time":0.000141258,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: value != nil\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Set protocol version to SSHv2","desc":"Set the SSH protocol version to 2. Don't use legacy\ninsecure SSHv1 connections anymore.","impact":1.0,"refs":[],"tags":{},"code":"control 'sshd-11' do\n  impact 1.0\n  title 'Server: Set protocol version to SSHv2'\n  desc \"\n    Set the SSH protocol version to 2. Don't use legacy\n    insecure SSHv1 connections anymore.\n  \"\n  describe sshd_config do\n    its('Protocol') { should eq('2') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":126},"id":"sshd-11","results":[{"status":"passed","code_desc":"SSHD Configuration Protocol should eq \"2\"","run_time":0.000458284,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Server: Enable strict mode","desc":"Verify file modes and ownerships before accepting a\nuser's login. Prevent misconfiguration of novice users.","impact":1.0,"refs":[],"tags":{},"code":"control 'sshd-12' do\n  impact 1.0\n  title 'Server: Enable strict mode'\n  desc \"\n    Verify file modes and ownerships before accepting a\n    user's login. Prevent misconfiguration of novice users.\n  \"\n  describe sshd_config do\n    its('StrictModes') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":138},"id":"sshd-12","results":[{"status":"passed","code_desc":"SSHD Configuration StrictModes should eq \"yes\"","run_time":0.000409309,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Server: Enable verbose logging","desc":"Be verbose in logging, to allow analysis in case\nof unexpected behavior.","impact":0.1,"refs":[],"tags":{},"code":"control 'sshd-14.1' do\n  impact 0.1\n  title 'Server: Enable verbose logging'\n  desc '\n    Be verbose in logging, to allow analysis in case\n    of unexpected behavior.\n  '\n  describe sshd_config do\n    its('LogLevel') { should match(/VERBOSE|DEBUG/) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":150},"id":"sshd-14.1","results":[{"status":"failed","code_desc":"SSHD Configuration LogLevel should match /VERBOSE|DEBUG/","run_time":0.000894821,"start_time":"2017-06-21 19:45:47 +0000","message":"expected \"INFO\" to match /VERBOSE|DEBUG/\nDiff:\n@@ -1,2 +1,2 @@\n-/VERBOSE|DEBUG/\n+\"INFO\"\n"}]},{"title":"Server: Set the minimum log level to info","desc":"Don't reduce logs below info level, to gain\nall necessary information for later analysis.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-14.2' do\n  impact 0.5\n  title 'Server: Set the minimum log level to info'\n  desc \"\n    Don't reduce logs below info level, to gain\n    all necessary information for later analysis.\n  \"\n  describe sshd_config do\n    its('LogLevel') { should match(/INFO|VERBOSE|DEBUG/) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":162},"id":"sshd-14.2","results":[{"status":"passed","code_desc":"SSHD Configuration LogLevel should match /INFO|VERBOSE|DEBUG/","run_time":0.000464846,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Server: Configure a valid cipher","desc":"Configure a list of current ciphers and avoid older\nand weaker settings.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-15' do\n  impact 0.3\n  title 'Server: Configure a valid cipher'\n  desc '\n    Configure a list of current ciphers and avoid older\n    and weaker settings.\n  '\n  describe sshd_config do\n    its('Ciphers') { should eq(ssh_crypto.valid_ciphers) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":174},"id":"sshd-15","results":[{"status":"failed","code_desc":"SSHD Configuration Ciphers should eq \"aes256-ctr,aes192-ctr,aes128-ctr\"","run_time":0.000499012,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"aes256-ctr,aes192-ctr,aes128-ctr\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Configure a valid MAC","desc":"Configure a list of current MACs and avoid older\nand weaker settings.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-16' do\n  impact 0.3\n  title 'Server: Configure a valid MAC'\n  desc '\n    Configure a list of current MACs and avoid older\n    and weaker settings.\n  '\n  describe sshd_config do\n    its('MACs') { should eq(ssh_crypto.valid_macs) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":186},"id":"sshd-16","results":[{"status":"failed","code_desc":"SSHD Configuration MACs should eq \"hmac-sha2-512,hmac-sha2-256,hmac-ripemd160\"","run_time":0.000536659,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"hmac-sha2-512,hmac-sha2-256,hmac-ripemd160\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Configure a valid Key-Exchange Algorithm","desc":"Configure a list of current key-exchange algorithms\nand avoid older and weaker settings.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-17' do\n  impact 0.3\n  title 'Server: Configure a valid Key-Exchange Algorithm'\n  desc '\n    Configure a list of current key-exchange algorithms\n    and avoid older and weaker settings.\n  '\n  describe sshd_config do\n    its('KexAlgorithms') { should eq(ssh_crypto.valid_kexs) }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":198},"id":"sshd-17","results":[{"status":"failed","code_desc":"SSHD Configuration KexAlgorithms should eq \"diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1\"","run_time":0.000512309,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable legacy login mechanism","desc":"Do not use login for interactive login sessions.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-18' do\n  impact 0.3\n  title 'Server: Disable legacy login mechanism'\n  desc '\n    Do not use login for interactive login sessions.\n  '\n  describe sshd_config do\n    its('UseLogin') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":210},"id":"sshd-18","results":[{"status":"failed","code_desc":"SSHD Configuration UseLogin should eq \"no\"","run_time":0.000485245,"start_time":"2017-06-21 19:45:47 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Use priviledge separation","desc":"Use an unprivileged child process to deal with\nincoming network traffic, to avoid privilege escalation\nby an attacker.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-19' do\n  impact 0.5\n  title 'Server: Use priviledge separation'\n  desc '\n    Use an unprivileged child process to deal with\n    incoming network traffic, to avoid privilege escalation\n    by an attacker.\n  '\n  describe sshd_config do\n    its('UsePrivilegeSeparation') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":221},"id":"sshd-19","results":[{"status":"passed","code_desc":"SSHD Configuration UsePrivilegeSeparation should eq \"yes\"","run_time":0.000450011,"start_time":"2017-06-21 19:45:47 +0000"}]},{"title":"Server: Disable users loading their environment variables","desc":"Do not enable custom user environments. They may be used\nto bypass access restrictions in certain configurations.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-20' do\n  impact 0.5\n  title 'Server: Disable users loading their environment variables'\n  desc '\n    Do not enable custom user environments. They may be used\n    to bypass access restrictions in certain configurations.\n  '\n  describe sshd_config do\n    its('PermitUserEnvironment') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":234},"id":"sshd-20","results":[{"status":"failed","code_desc":"SSHD Configuration PermitUserEnvironment should eq \"no\"","run_time":0.000624685,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Set a grace-time for login","desc":"Limit the login time to avoid resource starvation attacks.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-21' do\n  impact 0.3\n  title 'Server: Set a grace-time for login'\n  desc '\n    Limit the login time to avoid resource starvation attacks.\n  '\n  describe sshd_config do\n    its('LoginGraceTime') { should eq('30s') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":246},"id":"sshd-21","results":[{"status":"failed","code_desc":"SSHD Configuration LoginGraceTime should eq \"30s\"","run_time":0.000528177,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"30s\"\n     got: \"120\"\n\n(compared using ==)\n"}]},{"title":"Server: Limit maximum auth retries","desc":"Limit the maximum number of authentication retries in one\nrun, to prevent resource starvation attacks.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-22' do\n  impact 0.5\n  title 'Server: Limit maximum auth retries'\n  desc '\n    Limit the maximum number of authentication retries in one\n    run, to prevent resource starvation attacks.\n  '\n  describe sshd_config do\n    its('MaxAuthTries') { should eq('2') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":257},"id":"sshd-22","results":[{"status":"failed","code_desc":"SSHD Configuration MaxAuthTries should eq \"2\"","run_time":0.000530166,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"2\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Limit maximum user sessions to 10","desc":"Limit the maximum number of user sessions to a reasonable\nnumber. This avoid resource starvation attacks.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-23' do\n  impact 0.5\n  title 'Server: Limit maximum user sessions to 10'\n  desc '\n    Limit the maximum number of user sessions to a reasonable\n    number. This avoid resource starvation attacks.\n  '\n  describe sshd_config do\n    its('MaxSessions') { should eq('10') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":269},"id":"sshd-23","results":[{"status":"failed","code_desc":"SSHD Configuration MaxSessions should eq \"10\"","run_time":0.000494791,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"10\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Limit maximum startups","desc":"Limit the number of concurrent unauthenticated sessions\nto prevent resource starvation attacks.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-24' do\n  impact 0.5\n  title 'Server: Limit maximum startups'\n  desc '\n    Limit the number of concurrent unauthenticated sessions\n    to prevent resource starvation attacks.\n  '\n  describe sshd_config do\n    its('MaxStartups') { should eq('10:30:100') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":281},"id":"sshd-24","results":[{"status":"failed","code_desc":"SSHD Configuration MaxStartups should eq \"10:30:100\"","run_time":0.000479078,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"10:30:100\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Activate public key authentication","desc":"Prefer public key authentication mechanisms. Other methods\nare noticeably weaker (e.g. passwords). This is the preferred\nlogin mechanism.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-25' do\n  impact 0.5\n  title 'Server: Activate public key authentication'\n  desc '\n    Prefer public key authentication mechanisms. Other methods\n    are noticeably weaker (e.g. passwords). This is the preferred\n    login mechanism.\n  '\n  describe sshd_config do\n    its('PubkeyAuthentication') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":293},"id":"sshd-25","results":[{"status":"passed","code_desc":"SSHD Configuration PubkeyAuthentication should eq \"yes\"","run_time":0.000442937,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Server: Ignore legacy .rhosts configuration","desc":"Avoid host-based authentication, as it opens more ways\nfor an attacker to enter a system.","impact":0.7,"refs":[],"tags":{},"code":"control 'sshd-26' do\n  impact 0.7\n  title 'Server: Ignore legacy .rhosts configuration'\n  desc '\n    Avoid host-based authentication, as it opens more ways\n    for an attacker to enter a system.\n  '\n  describe sshd_config do\n    its('IgnoreRhosts') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":306},"id":"sshd-26","results":[{"status":"passed","code_desc":"SSHD Configuration IgnoreRhosts should eq \"yes\"","run_time":0.000447211,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Server: Ignore user known hosts","desc":"Avoid host-based authentication, as it opens more ways\nfor an attacker to enter a system.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-27' do\n  impact 0.5\n  title 'Server: Ignore user known hosts'\n  desc '\n    Avoid host-based authentication, as it opens more ways\n    for an attacker to enter a system.\n  '\n  describe sshd_config do\n    its('IgnoreUserKnownHosts') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":318},"id":"sshd-27","results":[{"status":"failed","code_desc":"SSHD Configuration IgnoreUserKnownHosts should eq \"yes\"","run_time":0.000580172,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"yes\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable hostbased authentication","desc":"Avoid host-based authentication, as it opens more ways\nfor an attacker to enter a system.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-28' do\n  impact 0.5\n  title 'Server: Disable hostbased authentication'\n  desc '\n    Avoid host-based authentication, as it opens more ways\n    for an attacker to enter a system.\n  '\n  describe sshd_config do\n    its('HostbasedAuthentication') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":330},"id":"sshd-28","results":[{"status":"passed","code_desc":"SSHD Configuration HostbasedAuthentication should eq \"no\"","run_time":0.000458107,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Server: Disable PAM","desc":"Avoid challenge-response and password-based authentications.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-29' do\n  impact 0.3\n  title 'Server: Disable PAM'\n  desc '\n    Avoid challenge-response and password-based authentications.\n  '\n  describe sshd_config do\n    its('UsePAM') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":342},"id":"sshd-29","results":[{"status":"failed","code_desc":"SSHD Configuration UsePAM should eq \"no\"","run_time":0.000530101,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: \"yes\"\n\n(compared using ==)\n"}]},{"title":"Server: Disable password-based authentication","desc":"Avoid challenge-response and password-based authentications.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-30' do\n  impact 0.5\n  title 'Server: Disable password-based authentication'\n  desc '\n    Avoid challenge-response and password-based authentications.\n  '\n  describe sshd_config do\n    its('PasswordAuthentication') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":353},"id":"sshd-30","results":[{"status":"failed","code_desc":"SSHD Configuration PasswordAuthentication should eq \"no\"","run_time":0.000486468,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable empty passwords","desc":"Precautionary setting if password-based authentication is used\nto avoid empy passwords.","impact":1.0,"refs":[],"tags":{},"code":"control 'sshd-31' do\n  impact 1.0\n  title 'Server: Disable empty passwords'\n  desc '\n    Precautionary setting if password-based authentication is used\n    to avoid empy passwords.\n  '\n  describe sshd_config do\n    its('PermitEmptyPasswords') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":364},"id":"sshd-31","results":[{"status":"passed","code_desc":"SSHD Configuration PermitEmptyPasswords should eq \"no\"","run_time":0.000448609,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Server: Disable challenge-response authentication","desc":"Avoid challenge-response and password-based authentications.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-32' do\n  impact 0.5\n  title 'Server: Disable challenge-response authentication'\n  desc '\n    Avoid challenge-response and password-based authentications.\n  '\n  describe sshd_config do\n    its('ChallengeResponseAuthentication') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":376},"id":"sshd-32","results":[{"status":"passed","code_desc":"SSHD Configuration ChallengeResponseAuthentication should eq \"no\"","run_time":0.000451654,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Server: Disable Kerberos or Local Password (due to the password part)","desc":"Avoid password-based authentication, which is used as a fallback\nwhen Kerberos fails in this setting.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-34' do\n  impact 0.5\n  title 'Server: Disable Kerberos or Local Password (due to the password part)'\n  desc '\n    Avoid password-based authentication, which is used as a fallback\n    when Kerberos fails in this setting.\n  '\n  describe sshd_config do\n    its('KerberosOrLocalPasswd') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":387},"id":"sshd-34","results":[{"status":"failed","code_desc":"SSHD Configuration KerberosOrLocalPasswd should eq \"no\"","run_time":0.000473075,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable TCP KeepAlive","desc":"Use ClientAlive messages which are sent over the encrypted\nchannel and aren't spoofable to see if the client is still alive.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-38' do\n  impact 0.5\n  title 'Server: Disable TCP KeepAlive'\n  desc \"\n    Use ClientAlive messages which are sent over the encrypted\n    channel and aren't spoofable to see if the client is still alive.\n  \"\n  describe sshd_config do\n    its('TCPKeepAlive') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":399},"id":"sshd-38","results":[{"status":"failed","code_desc":"SSHD Configuration TCPKeepAlive should eq \"no\"","run_time":0.000515136,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: \"yes\"\n\n(compared using ==)\n"}]},{"title":"Server: Configure a client alive interval","desc":"Use ClientAlive messages which are sent over the encrypted\nchannel and aren't spoofable to see if the client is still alive.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-39' do\n  impact 0.5\n  title 'Server: Configure a client alive interval'\n  desc \"\n    Use ClientAlive messages which are sent over the encrypted\n    channel and aren't spoofable to see if the client is still alive.\n  \"\n  describe sshd_config do\n    its('ClientAliveInterval') { should eq('600') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":411},"id":"sshd-39","results":[{"status":"failed","code_desc":"SSHD Configuration ClientAliveInterval should eq \"600\"","run_time":0.000475311,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"600\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Configure a few client alive counters","desc":"Use ClientAlive messages which are sent over the encrypted\nchannel and aren't spoofable to see if the client is still alive.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-40' do\n  impact 0.5\n  title 'Server: Configure a few client alive counters'\n  desc \"\n    Use ClientAlive messages which are sent over the encrypted\n    channel and aren't spoofable to see if the client is still alive.\n  \"\n  describe sshd_config do\n    its('ClientAliveCountMax') { should eq('3') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":423},"id":"sshd-40","results":[{"status":"failed","code_desc":"SSHD Configuration ClientAliveCountMax should eq \"3\"","run_time":0.000475924,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"3\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable tunnels","desc":"Avoid using SSH tunnels.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-41' do\n  impact 0.5\n  title 'Server: Disable tunnels'\n  desc '\n    Avoid using SSH tunnels.\n  '\n  describe sshd_config do\n    its('PermitTunnel') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":435},"id":"sshd-41","results":[{"status":"failed","code_desc":"SSHD Configuration PermitTunnel should eq \"no\"","run_time":0.000473327,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable TCP forwarding","desc":"If shell access is disabled, this option can\nbe used to effectively disable TCP forwarders by the client.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-42' do\n  impact 0.3\n  title 'Server: Disable TCP forwarding'\n  desc '\n    If shell access is disabled, this option can\n    be used to effectively disable TCP forwarders by the client.\n  '\n  describe sshd_config do\n    its('AllowTcpForwarding') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":446},"id":"sshd-42","results":[{"status":"failed","code_desc":"SSHD Configuration AllowTcpForwarding should eq \"no\"","run_time":0.000471739,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable Agent forwarding","desc":"If shell access is disabled, this option can\nbe used to effectively disable agent forwarding by the client.","impact":0.3,"refs":[],"tags":{},"code":"control 'sshd-43' do\n  impact 0.3\n  title 'Server: Disable Agent forwarding'\n  desc '\n    If shell access is disabled, this option can\n    be used to effectively disable agent forwarding by the client.\n  '\n  describe sshd_config do\n    its('AllowAgentForwarding') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":458},"id":"sshd-43","results":[{"status":"failed","code_desc":"SSHD Configuration AllowAgentForwarding should eq \"no\"","run_time":0.000479661,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable gateway ports","desc":"Prevent remote hosts from connecting to\nforwarded ports on the node.","impact":0.5,"refs":[],"tags":{},"code":"control 'sshd-44' do\n  impact 0.5\n  title 'Server: Disable gateway ports'\n  desc '\n    Prevent remote hosts from connecting to\n    forwarded ports on the node.\n  '\n  describe sshd_config do\n    its('GatewayPorts') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":470},"id":"sshd-44","results":[{"status":"failed","code_desc":"SSHD Configuration GatewayPorts should eq \"no\"","run_time":0.000519029,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Server: Disable X11 forwarding","desc":"Prevent X11 forwarding by default, as it can\nbe used in a limited way to enable attacks.","impact":1.0,"refs":[],"tags":{},"code":"control 'sshd-45' do\n  impact 1.0\n  title 'Server: Disable X11 forwarding'\n  desc '\n    Prevent X11 forwarding by default, as it can\n    be used in a limited way to enable attacks.\n  '\n  describe sshd_config do\n    its('X11Forwarding') { should eq('no') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":482},"id":"sshd-45","results":[{"status":"failed","code_desc":"SSHD Configuration X11Forwarding should eq \"no\"","run_time":0.000517934,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"no\"\n     got: \"yes\"\n\n(compared using ==)\n"}]},{"title":"Server: If X11 is used, enforce localhost","desc":"Prevent X11 forwarding by default, as it can\nbe used in a limited way to enable attacks.","impact":0.7,"refs":[],"tags":{},"code":"control 'sshd-46' do\n  impact 0.7\n  title 'Server: If X11 is used, enforce localhost'\n  desc '\n    Prevent X11 forwarding by default, as it can\n    be used in a limited way to enable attacks.\n  '\n  describe sshd_config do\n    its('X11UseLocalhost') { should eq('yes') }\n  end\nend\n","source_location":{"ref":"base/ssh/controls/sshd_spec.rb","line":494},"id":"sshd-46","results":[{"status":"failed","code_desc":"SSHD Configuration X11UseLocalhost should eq \"yes\"","run_time":0.000464714,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"yes\"\n     got: nil\n\n(compared using ==)\n"}]}],"groups":[{"title":"SSH Folder Configuration","controls":["basic-1","basic-2","basic-3"],"id":"controls/ssh_folder_spec.rb"},{"title":"SSH Client Config","controls":["basic-6","ssh-1","ssh-3","ssh-4","ssh-5","ssh-6","ssh-7","ssh-8","ssh-9","ssh-10","ssh-11","ssh-12","ssh-13","ssh-14","ssh-15","ssh-16","ssh-19","ssh-20"],"id":"controls/ssh_spec.rb"},{"title":"SSH Server Config","controls":["basic-4","basic-4.1","basic-5","basic-6.1","basic-6.2","sshd-7","sshd-8","sshd-9","sshd-10","sshd-11","sshd-12","sshd-14.1","sshd-14.2","sshd-15","sshd-16","sshd-17","sshd-18","sshd-19","sshd-20","sshd-21","sshd-22","sshd-23","sshd-24","sshd-25","sshd-26","sshd-27","sshd-28","sshd-29","sshd-30","sshd-31","sshd-32","sshd-34","sshd-38","sshd-39","sshd-40","sshd-41","sshd-42","sshd-43","sshd-44","sshd-45","sshd-46"],"id":"controls/sshd_spec.rb"}],"attributes":[],"sha256":"416342174df2ecfef3b0c648ca6bd5f830f0166947f01e6f43e4c85d5e8e7e53"},{"name":"cis-ubuntu14.04lts-level1","title":"CIS Ubuntu 14.04 LTS Server Benchmark Level 1","summary":"CIS Ubuntu 14.04 LTS Server Benchmark Level 1 translated from SCAP","version":"1.0.0","maintainer":"Chef Software, Inc.","copyright":"Chef Software, Inc.","copyright_email":"support@chef.io","license":"Proprietary, All rights reserved","supports":[{"os":"ubuntu"}],"controls":[{"title":"Install Updates, Patches and Additional Security Software","desc":"Periodically patches are released for included software either due to security flaws or to include additional functionality.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_1.1_Install_Updates_Patches_and_Additional_Security_Software\" do\n  title \"Install Updates, Patches and Additional Security Software\"\n  desc  \"Periodically patches are released for included software either due to security flaws or to include additional functionality.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1},"id":"xccdf_org.cisecurity.benchmarks_rule_1.1_Install_Updates_Patches_and_Additional_Security_Software"},{"title":"Create Separate Partition for /tmp","desc":"The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.1_Create_Separate_Partition_for_tmp\" do\n  title \"Create Separate Partition for /tmp\"\n  desc  \"The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '{print $2}'\") do\n    its(\"stdout\") { should match /^\\/tmp$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":7},"id":"xccdf_org.cisecurity.benchmarks_rule_2.1_Create_Separate_Partition_for_tmp","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '{print $2}' stdout should match /^\\/tmp$/","run_time":0.019999554,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /^\\/tmp$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^\\/tmp$/\n+\"\"\n"}]},{"title":"Set nodev option for /tmp Partition","desc":"The nodev mount option specifies that the filesystem cannot contain special devices.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.2_Set_nodev_option_for_tmp_Partition\" do\n  title \"Set nodev option for /tmp Partition\"\n  desc  \"The nodev mount option specifies that the filesystem cannot contain special devices.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/tmp\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /nodev/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":16},"id":"xccdf_org.cisecurity.benchmarks_rule_2.2_Set_nodev_option_for_tmp_Partition","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/tmp\") { print $4 }' stdout should match /nodev/","run_time":0.017713442,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /nodev/\nDiff:\n@@ -1,2 +1,2 @@\n-/nodev/\n+\"\"\n"}]},{"title":"Set nosuid option for /tmp Partition","desc":"The nosuid mount option specifies that the filesystem cannot contain set userid files.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.3_Set_nosuid_option_for_tmp_Partition\" do\n  title \"Set nosuid option for /tmp Partition\"\n  desc  \"The nosuid mount option specifies that the filesystem cannot contain set userid files.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/tmp\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /nosuid/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":25},"id":"xccdf_org.cisecurity.benchmarks_rule_2.3_Set_nosuid_option_for_tmp_Partition","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/tmp\") { print $4 }' stdout should match /nosuid/","run_time":0.017426135,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /nosuid/\nDiff:\n@@ -1,2 +1,2 @@\n-/nosuid/\n+\"\"\n"}]},{"title":"Set noexec option for /tmp Partition","desc":"The noexec mount option specifies that the filesystem cannot contain executable binaries.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.4_Set_noexec_option_for_tmp_Partition\" do\n  title \"Set noexec option for /tmp Partition\"\n  desc  \"The noexec mount option specifies that the filesystem cannot contain executable binaries.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/tmp\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /noexec/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":34},"id":"xccdf_org.cisecurity.benchmarks_rule_2.4_Set_noexec_option_for_tmp_Partition","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/tmp\") { print $4 }' stdout should match /noexec/","run_time":0.017235414,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /noexec/\nDiff:\n@@ -1,2 +1,2 @@\n-/noexec/\n+\"\"\n"}]},{"title":"Create Separate Partition for /var","desc":"The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world-writable.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.5_Create_Separate_Partition_for_var\" do\n  title \"Create Separate Partition for /var\"\n  desc  \"The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world-writable.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '{print $2}'\") do\n    its(\"stdout\") { should match /^\\/var$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":43},"id":"xccdf_org.cisecurity.benchmarks_rule_2.5_Create_Separate_Partition_for_var","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '{print $2}' stdout should match /^\\/var$/","run_time":0.017523473,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /^\\/var$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^\\/var$/\n+\"\"\n"}]},{"title":"Bind Mount the /var/tmp directory to /tmp","desc":"The /var/tmp directory is normally a standalone directory in the /var file system. Binding /var/tmp to /tmp establishes an unbreakable link to /tmp that cannot be removed (even by the root user). It also allows /var/tmp to inherit the same mount options that /tmp owns, allowing /var/tmp to be protected in the same manner /tmp is protected. It will also prevent /var from filling up with temporary files as the contents of /var/tmp will actually reside in the file system containing /tmp.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.6_Bind_Mount_the_vartmp_directory_to_tmp\" do\n  title \"Bind Mount the /var/tmp directory to /tmp\"\n  desc  \"The /var/tmp directory is normally a standalone directory in the /var file system. Binding /var/tmp to /tmp establishes an unbreakable link to /tmp that cannot be removed (even by the root user). It also allows /var/tmp to inherit the same mount options that /tmp owns, allowing /var/tmp to be protected in the same manner /tmp is protected. It will also prevent /var from filling up with temporary files as the contents of /var/tmp will actually reside in the file system containing /tmp.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/var/tmp\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /bind/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":52},"id":"xccdf_org.cisecurity.benchmarks_rule_2.6_Bind_Mount_the_vartmp_directory_to_tmp","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/var/tmp\") { print $4 }' stdout should match /bind/","run_time":0.017032229,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /bind/\nDiff:\n@@ -1,2 +1,2 @@\n-/bind/\n+\"\"\n"}]},{"title":"Create Separate Partition for /var/log","desc":"The /var/log directory is used by system services to store log data .","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.7_Create_Separate_Partition_for_varlog\" do\n  title \"Create Separate Partition for /var/log\"\n  desc  \"The /var/log directory is used by system services to store log data .\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '{print $2}'\") do\n    its(\"stdout\") { should match /^\\/var\\/log$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":61},"id":"xccdf_org.cisecurity.benchmarks_rule_2.7_Create_Separate_Partition_for_varlog","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '{print $2}' stdout should match /^\\/var\\/log$/","run_time":0.017284875,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /^\\/var\\/log$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^\\/var\\/log$/\n+\"\"\n"}]},{"title":"Create Separate Partition for /var/log/audit","desc":"The auditing daemon, auditd, stores log data in the /var/log/audit directory.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.8_Create_Separate_Partition_for_varlogaudit\" do\n  title \"Create Separate Partition for /var/log/audit\"\n  desc  \"The auditing daemon, auditd, stores log data in the /var/log/audit directory.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '{print $2}'\") do\n    its(\"stdout\") { should match /^\\/var\\/log\\/audit$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":70},"id":"xccdf_org.cisecurity.benchmarks_rule_2.8_Create_Separate_Partition_for_varlogaudit","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '{print $2}' stdout should match /^\\/var\\/log\\/audit$/","run_time":0.020391188,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /^\\/var\\/log\\/audit$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^\\/var\\/log\\/audit$/\n+\"\"\n"}]},{"title":"Create Separate Partition for /home","desc":"The /home directory is used to support disk storage needs of local users.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.9_Create_Separate_Partition_for_home\" do\n  title \"Create Separate Partition for /home\"\n  desc  \"The /home directory is used to support disk storage needs of local users.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '{print $2}'\") do\n    its(\"stdout\") { should match /^\\/home$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":79},"id":"xccdf_org.cisecurity.benchmarks_rule_2.9_Create_Separate_Partition_for_home","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '{print $2}' stdout should match /^\\/home$/","run_time":0.017587135,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /^\\/home$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^\\/home$/\n+\"\"\n"}]},{"title":"Add nodev Option to /home","desc":"When set on a file system, this option prevents character and block special devices from being defined, or if they exist, from being used as character and block special devices.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.10_Add_nodev_Option_to_home\" do\n  title \"Add nodev Option to /home\"\n  desc  \"When set on a file system, this option prevents character and block special devices from being defined, or if they exist, from being used as character and block special devices.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/home\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /nodev/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":88},"id":"xccdf_org.cisecurity.benchmarks_rule_2.10_Add_nodev_Option_to_home","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/home\") { print $4 }' stdout should match /nodev/","run_time":0.016542301,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /nodev/\nDiff:\n@@ -1,2 +1,2 @@\n-/nodev/\n+\"\"\n"}]},{"title":"Add nodev Option to Removable Media Partitions","desc":"Set nodev on removable media to prevent character and block special devices that are present on the removable media from being treated as device files.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.11_Add_nodev_Option_to_Removable_Media_Partitions\" do\n  title \"Add nodev Option to Removable Media Partitions\"\n  desc  \"Set nodev on removable media to prevent character and block special devices that are present on the removable media from being treated as device files.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":97},"id":"xccdf_org.cisecurity.benchmarks_rule_2.11_Add_nodev_Option_to_Removable_Media_Partitions"},{"title":"Add noexec Option to Removable Media Partitions","desc":"Set noexec on removable media to prevent programs from executing from the removable media.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.12_Add_noexec_Option_to_Removable_Media_Partitions\" do\n  title \"Add noexec Option to Removable Media Partitions\"\n  desc  \"Set noexec on removable media to prevent programs from executing from the removable media.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":103},"id":"xccdf_org.cisecurity.benchmarks_rule_2.12_Add_noexec_Option_to_Removable_Media_Partitions"},{"title":"Add nosuid Option to Removable Media Partitions","desc":"Set nosuid on removable media to prevent setuid and setgid executable files that are on that media from being executed as setuid and setgid.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.13_Add_nosuid_Option_to_Removable_Media_Partitions\" do\n  title \"Add nosuid Option to Removable Media Partitions\"\n  desc  \"Set nosuid on removable media to prevent setuid and setgid executable files that are on that media from being executed as setuid and setgid.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":109},"id":"xccdf_org.cisecurity.benchmarks_rule_2.13_Add_nosuid_Option_to_Removable_Media_Partitions"},{"title":"Add nodev Option to /run/shm Partition","desc":"The nodev mount option specifies that the /run/shm (temporary filesystem stored in memory) cannot contain block or character special devices.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.14_Add_nodev_Option_to_runshm_Partition\" do\n  title \"Add nodev Option to /run/shm Partition\"\n  desc  \"The nodev mount option specifies that the /run/shm (temporary filesystem stored in memory) cannot contain block or character special devices.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/run/shm\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /nodev/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":115},"id":"xccdf_org.cisecurity.benchmarks_rule_2.14_Add_nodev_Option_to_runshm_Partition","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/run/shm\") { print $4 }' stdout should match /nodev/","run_time":0.016329581,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /nodev/\nDiff:\n@@ -1,2 +1,2 @@\n-/nodev/\n+\"\"\n"}]},{"title":"Add nosuid Option to /run/shm Partition","desc":"The nosuid mount option specifies that the /run/shm (temporary filesystem stored in memory) will not execute setuid and setgid on executable programs as such, but rather execute them with the uid and gid of the user executing the program.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.15_Add_nosuid_Option_to_runshm_Partition\" do\n  title \"Add nosuid Option to /run/shm Partition\"\n  desc  \"The nosuid mount option specifies that the /run/shm (temporary filesystem stored in memory) will not execute setuid and setgid on executable programs as such, but rather execute them with the uid and gid of the user executing the program.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/run/shm\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /nosuid/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":124},"id":"xccdf_org.cisecurity.benchmarks_rule_2.15_Add_nosuid_Option_to_runshm_Partition","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/run/shm\") { print $4 }' stdout should match /nosuid/","run_time":0.016440085,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /nosuid/\nDiff:\n@@ -1,2 +1,2 @@\n-/nosuid/\n+\"\"\n"}]},{"title":"Add noexec Option to /run/shm Partition","desc":"Set noexec on the shared memory partition to prevent programs from executing from there.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.16_Add_noexec_Option_to_runshm_Partition\" do\n  title \"Add noexec Option to /run/shm Partition\"\n  desc  \"Set noexec on the shared memory partition to prevent programs from executing from there.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^[^#]\\\" /etc/fstab | awk '($2 == \\\"/run/shm\\\") { print $4 }'\") do\n    its(\"stdout\") { should match /noexec/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":133},"id":"xccdf_org.cisecurity.benchmarks_rule_2.16_Add_noexec_Option_to_runshm_Partition","results":[{"status":"failed","code_desc":"Bash command egrep \"^[^#]\" /etc/fstab | awk '($2 == \"/run/shm\") { print $4 }' stdout should match /noexec/","run_time":0.016449417,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /noexec/\nDiff:\n@@ -1,2 +1,2 @@\n-/noexec/\n+\"\"\n"}]},{"title":"Set Sticky Bit on All World-Writable Directories","desc":"Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.17_Set_Sticky_Bit_on_All_World-Writable_Directories\" do\n  title \"Set Sticky Bit on All World-Writable Directories\"\n  desc  \"Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.\"\n  impact 1.0\n  describe bash(\"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \\\\( -perm -0002 -a ! -perm -1000 \\\\) 2>/dev/null\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":142},"id":"xccdf_org.cisecurity.benchmarks_rule_2.17_Set_Sticky_Bit_on_All_World-Writable_Directories","results":[{"status":"passed","code_desc":"Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null stdout should not match /.+/","run_time":0.336901953,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Disable Automounting","desc":"autofs allows automatic mounting of devices, typically including CD/DVDs and USB drives.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_2.25_Disable_Automounting\" do\n  title \"Disable Automounting\"\n  desc  \"autofs allows automatic mounting of devices, typically including CD/DVDs and USB drives.\"\n  impact 1.0\n  describe bash(\"initctl show-config autofs | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":151},"id":"xccdf_org.cisecurity.benchmarks_rule_2.25_Disable_Automounting","results":[{"status":"passed","code_desc":"Bash command initctl show-config autofs | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.02022905,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Set User/Group Owner on bootloader config","desc":"Set the owner and group of your boot loaders config file to the root user. These instructions default to GRUB stored at /boot/grub/grub.cfg.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.1_Set_UserGroup_Owner_on_bootloader_config\" do\n  title \"Set User/Group Owner on bootloader config\"\n  desc  \"Set the owner and group of your boot loaders config file to the root user. These instructions default to GRUB stored at /boot/grub/grub.cfg.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /boot/grub/grub.cfg\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":160},"id":"xccdf_org.cisecurity.benchmarks_rule_3.1_Set_UserGroup_Owner_on_bootloader_config","results":[{"status":"failed","code_desc":"Bash command stat -c \"%u %g\" /boot/grub/grub.cfg stdout should match /0 0/","run_time":0.016253781,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"\" to match /0 0/\nDiff:\n@@ -1,2 +1,2 @@\n-/0 0/\n+\"\"\n"}]},{"title":"Set Permissions on bootloader config","desc":"Set permission on the your boot loaders config file to read and write for root only.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.2_Set_Permissions_on_bootloader_config\" do\n  title \"Set Permissions on bootloader config\"\n  desc  \"Set permission on the your boot loaders config file to read and write for root only.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /boot/grub/grub.cfg | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":169},"id":"xccdf_org.cisecurity.benchmarks_rule_3.2_Set_Permissions_on_bootloader_config","results":[{"status":"failed","code_desc":"should eq \"0000\"","run_time":0.000163608,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"0000\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Set Boot Loader Password","desc":"Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to set command line boot parameters","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.3_Set_Boot_Loader_Password\" do\n  title \"Set Boot Loader Password\"\n  desc  \"Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to set command line boot parameters\"\n  impact 1.0\n  describe file(\"/boot/grub/grub.cfg\") do\n    its(\"content\") { should match /^set superusers=\".*\"$/ }\n  end\n  describe file(\"/boot/grub/grub.cfg\") do\n    its(\"content\") { should match /^password/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":178},"id":"xccdf_org.cisecurity.benchmarks_rule_3.3_Set_Boot_Loader_Password","results":[{"status":"failed","code_desc":"File /boot/grub/grub.cfg content should match /^set superusers=\".*\"$/","run_time":0.000182682,"start_time":"2017-06-21 19:45:48 +0000","message":"expected nil to match /^set superusers=\".*\"$/"},{"status":"failed","code_desc":"File /boot/grub/grub.cfg content should match /^password/","run_time":0.000192231,"start_time":"2017-06-21 19:45:48 +0000","message":"expected nil to match /^password/"}]},{"title":"Require Authentication for Single-User Mode","desc":"Setting a password for the root user will force authentication in single user mode.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_3.4_Require_Authentication_for_Single-User_Mode\" do\n  title \"Require Authentication for Single-User Mode\"\n  desc  \"Setting a password for the root user will force authentication in single user mode.\"\n  impact 1.0\n  describe bash(\"grep \\\"^root:[*\\\\!]:\\\" /etc/shadow\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":190},"id":"xccdf_org.cisecurity.benchmarks_rule_3.4_Require_Authentication_for_Single-User_Mode","results":[{"status":"failed","code_desc":"Bash command grep \"^root:[*\\!]:\" /etc/shadow stdout should not match /.+/","run_time":0.016339247,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"root:!:17290:0:99999:7:::\\n\" not to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+root:!:17290:0:99999:7:::\n"}]},{"title":"Restrict Core Dumps","desc":"A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.1_Restrict_Core_Dumps\" do\n  title \"Restrict Core Dumps\"\n  desc  \"A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.\"\n  impact 1.0\n  describe file(\"/etc/security/limits.conf\") do\n    its(\"content\") { should match /^*\\s+hard\\s+core\\s+0/ }\n  end\n  describe bash(\"sysctl fs.suid_dumpable\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"initctl show-config apport | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"initctl show-config whoopsie | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":199},"id":"xccdf_org.cisecurity.benchmarks_rule_4.1_Restrict_Core_Dumps","results":[{"status":"failed","code_desc":"File /etc/security/limits.conf content should match /^*\\s+hard\\s+core\\s+0/","run_time":0.001035648,"start_time":"2017-06-21 19:45:48 +0000","message":"expected \"# /etc/security/limits.conf\\n#\\n#Each line describes a limit for a user in the form:\\n#\\n#<domain>  ...       -       chroot          /ftp\\n\\#@student        -       maxlogins       4\\n\\n# End of file\\n\" to match /^*\\s+hard\\s+core\\s+0/\nDiff:\n@@ -1,2 +1,57 @@\n-/^*\\s+hard\\s+core\\s+0/\n+# /etc/security/limits.conf\n+#\n+#Each line describes a limit for a user in the form:\n+#\n+#<domain>        <type>  <item>  <value>\n+#\n+#Where:\n+#<domain> can be:\n+#        - a user name\n+#        - a group name, with @group syntax\n+#        - the wildcard *, for default entry\n+#        - the wildcard %, can be also used with %group syntax,\n+#                 for maxlogin limit\n+#        - NOTE: group and wildcard limits are not applied to root.\n+#          To apply a limit to the root user, <domain> must be\n+#          the literal username root.\n+#\n+#<type> can have the two values:\n+#        - \"soft\" for enforcing the soft limits\n+#        - \"hard\" for enforcing hard limits\n+#\n+#<item> can be one of the following:\n+#        - core - limits the core file size (KB)\n+#        - data - max data size (KB)\n+#        - fsize - maximum filesize (KB)\n+#        - memlock - max locked-in-memory address space (KB)\n+#        - nofile - max number of open files\n+#        - rss - max resident set size (KB)\n+#        - stack - max stack size (KB)\n+#        - cpu - max CPU time (MIN)\n+#        - nproc - max number of processes\n+#        - as - address space limit (KB)\n+#        - maxlogins - max number of logins for this user\n+#        - maxsyslogins - max number of logins on the system\n+#        - priority - the priority to run user process with\n+#        - locks - max number of file locks the user can hold\n+#        - sigpending - max number of pending signals\n+#        - msgqueue - max memory used by POSIX message queues (bytes)\n+#        - nice - max nice priority allowed to raise to values: [-20, 19]\n+#        - rtprio - max realtime priority\n+#        - chroot - change root to directory (Debian-specific)\n+#\n+#<domain>      <type>  <item>         <value>\n+#\n+\n+#*               soft    core            0\n+#root            hard    core            100000\n+#*               hard    rss             10000\n+#@student        hard    nproc           20\n+#@faculty        soft    nproc           20\n+#@faculty        hard    nproc           50\n+#ftp             hard    nproc           0\n+#ftp             -       chroot          /ftp\n+#@student        -       maxlogins       4\n+\n+# End of file\n"},{"status":"failed","code_desc":"2 should eq \"0\"","run_time":0.000145698,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: \"0\"\n     got: \"2\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"Bash command initctl show-config apport | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.01734417,"start_time":"2017-06-21 19:45:48 +0000","message":"\nexpected: value != 0\n     got: 0\n\n(compared using ==)\n"},{"status":"passed","code_desc":"Bash command initctl show-config whoopsie | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.017497938,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Enable XD/NX Support on 32-bit x86 Systems","desc":"Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis. Generically and on AMD processors, this ability is called No Execute (NX), while on Intel processors it is called Execute Disable (XD). This ability can help prevent exploitation of buffer overflow vulnerabilities and should be activated whenever possible. Extra steps must be taken to ensure that this protection is enabled, particularly on 32-bit x86 systems. Other processors, such as Itanium and POWER, have included such support since inception and the standard kernel for those platforms supports the feature.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_XDNX_Support_on_32-bit_x86_Systems\" do\n  title \"Enable XD/NX Support on 32-bit x86 Systems\"\n  desc  \"Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis. Generically and on AMD processors, this ability is called No Execute (NX), while on Intel processors it is called Execute Disable (XD). This ability can help prevent exploitation of buffer overflow vulnerabilities and should be activated whenever possible. Extra steps must be taken to ensure that this protection is enabled, particularly on 32-bit x86 systems. Other processors, such as Itanium and POWER, have included such support since inception and the standard kernel for those platforms supports the feature.\"\n  impact 0.0\n  describe bash(\"dmesg | grep NX\") do\n    its(\"stdout\") { should match /NX \\(Execute Disable\\) protection: active/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":217},"id":"xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_XDNX_Support_on_32-bit_x86_Systems","results":[{"status":"passed","code_desc":"Bash command dmesg | grep NX stdout should match /NX \\(Execute Disable\\) protection: active/","run_time":0.022297734,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Enable Randomized Virtual Memory Region Placement","desc":"Set the system flag to force randomized virtual memory region placement.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.3_Enable_Randomized_Virtual_Memory_Region_Placement\" do\n  title \"Enable Randomized Virtual Memory Region Placement\"\n  desc  \"Set the system flag to force randomized virtual memory region placement.\"\n  impact 1.0\n  describe bash(\"sysctl kernel.randomize_va_space\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"2\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":226},"id":"xccdf_org.cisecurity.benchmarks_rule_4.3_Enable_Randomized_Virtual_Memory_Region_Placement","results":[{"status":"passed","code_desc":"2 should eq \"2\"","run_time":0.000148745,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Disable Prelink","desc":"The prelinking feature changes binaries in an attempt to decrease their startup time.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_4.4_Disable_Prelink\" do\n  title \"Disable Prelink\"\n  desc  \"The prelinking feature changes binaries in an attempt to decrease their startup time.\"\n  impact 1.0\n  describe bash(\"dpkg -s prelink | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":235},"id":"xccdf_org.cisecurity.benchmarks_rule_4.4_Disable_Prelink","results":[{"status":"passed","code_desc":"Bash command dpkg -s prelink | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.02385467,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure NIS is not installed","desc":"The Network Information Service (NIS), formerly known as Yellow Pages, is a client-server directory service protocol used to distribute system configuration files.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_NIS_is_not_installed\" do\n  title \"Ensure NIS is not installed\"\n  desc  \"The Network Information Service (NIS), formerly known as Yellow Pages, is a client-server directory service protocol used to distribute system configuration files.\"\n  impact 1.0\n  describe bash(\"dpkg -s nis | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":244},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_NIS_is_not_installed","results":[{"status":"passed","code_desc":"Bash command dpkg -s nis | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.02360645,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure rsh server is not enabled","desc":"The Berkeley rsh-server (rsh, rlogin, rcp) package contains legacy services that exchange credentials in clear-text.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_rsh_server_is_not_enabled\" do\n  title \"Ensure rsh server is not enabled\"\n  desc  \"The Berkeley rsh-server (rsh, rlogin, rcp) package contains legacy services that exchange credentials in clear-text.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^shell\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"egrep \\\"^login\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"egrep \\\"^exec\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":253},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_rsh_server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^shell\" /etc/inetd.conf exit_status should not eq 0","run_time":0.017088046,"start_time":"2017-06-21 19:45:48 +0000"},{"status":"passed","code_desc":"Bash command egrep \"^login\" /etc/inetd.conf exit_status should not eq 0","run_time":0.017323076,"start_time":"2017-06-21 19:45:48 +0000"},{"status":"passed","code_desc":"Bash command egrep \"^exec\" /etc/inetd.conf exit_status should not eq 0","run_time":0.016448047,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure rsh client is not installed","desc":"The rsh package contains the client commands for the rsh services.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_rsh_client_is_not_installed\" do\n  title \"Ensure rsh client is not installed\"\n  desc  \"The rsh package contains the client commands for the rsh services.\"\n  impact 1.0\n  describe bash(\"dpkg -s rsh-client | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"dpkg -s rsh-redone-client | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":268},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_rsh_client_is_not_installed","results":[{"status":"passed","code_desc":"Bash command dpkg -s rsh-client | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.02341872,"start_time":"2017-06-21 19:45:48 +0000"},{"status":"passed","code_desc":"Bash command dpkg -s rsh-redone-client | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.025448958,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure talk server is not enabled","desc":"The talk software makes it possible for users to send and receive messages across systems through a terminal session. The talk client (allows initiate of talk sessions) is installed by default.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_talk_server_is_not_enabled\" do\n  title \"Ensure talk server is not enabled\"\n  desc  \"The talk software makes it possible for users to send and receive messages across systems through a terminal session. The talk client (allows initiate of talk sessions) is installed by default.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^talk\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"egrep \\\"^ntalk\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":280},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_talk_server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^talk\" /etc/inetd.conf exit_status should not eq 0","run_time":0.016954253,"start_time":"2017-06-21 19:45:48 +0000"},{"status":"passed","code_desc":"Bash command egrep \"^ntalk\" /etc/inetd.conf exit_status should not eq 0","run_time":0.018363546,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure talk client is not installed","desc":"The talk software makes it possible for users to send and receive messages across systems through a terminal session.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_talk_client_is_not_installed\" do\n  title \"Ensure talk client is not installed\"\n  desc  \"The talk software makes it possible for users to send and receive messages across systems through a terminal session.\"\n  impact 1.0\n  describe bash(\"dpkg -s talk | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":292},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_talk_client_is_not_installed","results":[{"status":"passed","code_desc":"Bash command dpkg -s talk | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.024495701,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure telnet server is not enabled","desc":"The telnet-server package contains the telnet daemon, which accepts connections from users from other systems via the telnet protocol.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_telnet_server_is_not_enabled\" do\n  title \"Ensure telnet server is not enabled\"\n  desc  \"The telnet-server package contains the telnet daemon, which accepts connections from users from other systems via the telnet protocol.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^telnet\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":301},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_telnet_server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^telnet\" /etc/inetd.conf exit_status should not eq 0","run_time":0.016302917,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure tftp-server is not enabled","desc":"Trivial File Transfer Protocol (TFTP) is a simple file transfer protocol, typically used to automatically transfer configuration or boot machines from a boot server. The packages tftp and atftp are both used to define and support a TFTP server.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_tftp-server_is_not_enabled\" do\n  title \"Ensure tftp-server is not enabled\"\n  desc  \"Trivial File Transfer Protocol (TFTP) is a simple file transfer protocol, typically used to automatically transfer configuration or boot machines from a boot server. The packages tftp and atftp are both used to define and support a TFTP server.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^tftp\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":310},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_tftp-server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^tftp\" /etc/inetd.conf exit_status should not eq 0","run_time":0.015637235,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure xinetd is not enabled","desc":"The eXtended InterNET Daemon (xinetd) is an open source super daemon that replaced the original inetd daemon. The xinetd daemon listens for well known services and dispatches the appropriate daemon to properly respond to service requests.\n                     Note: Several other services recommended to be disabled in this benchmark have xinetd versions as well, if xinetd is required in your environment ensure they are disabled in xinetd configuration as well.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_xinetd_is_not_enabled\" do\n  title \"Ensure xinetd is not enabled\"\n  desc  \"The eXtended InterNET Daemon (xinetd) is an open source super daemon that replaced the original inetd daemon. The xinetd daemon listens for well known services and dispatches the appropriate daemon to properly respond to service requests.\\n                     Note: Several other services recommended to be disabled in this benchmark have xinetd versions as well, if xinetd is required in your environment ensure they are disabled in xinetd configuration as well.\"\n  impact 1.0\n  describe bash(\"initctl show-config xinetd | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":319},"id":"xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_xinetd_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config xinetd | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.017037798,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure chargen is not enabled","desc":"chargen is a network service that responds with 0 to 512 ASCII characters for each connection it receives. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_chargen_is_not_enabled\" do\n  title \"Ensure chargen is not enabled\"\n  desc  \"chargen is a network service that responds with 0 to 512 ASCII characters for each connection it receives. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^chargen\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":328},"id":"xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_chargen_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^chargen\" /etc/inetd.conf exit_status should not eq 0","run_time":0.016305907,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure daytime is not enabled","desc":"daytime is a network service that responds with the server's current date and time. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_daytime_is_not_enabled\" do\n  title \"Ensure daytime is not enabled\"\n  desc  \"daytime is a network service that responds with the server's current date and time. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.\"\n  impact 1.0\n  describe bash(\"chkconfig --list daytime | egrep \\\"on\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"egrep \\\"^daytime\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":337},"id":"xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_daytime_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command chkconfig --list daytime | egrep \"on\" exit_status should not eq 0","run_time":0.016238892,"start_time":"2017-06-21 19:45:48 +0000"},{"status":"passed","code_desc":"Bash command egrep \"^daytime\" /etc/inetd.conf exit_status should not eq 0","run_time":0.015736344,"start_time":"2017-06-21 19:45:48 +0000"}]},{"title":"Ensure echo is not enabled","desc":"echo is a network service that responds to clients with the data sent to it by the client. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_echo_is_not_enabled\" do\n  title \"Ensure echo is not enabled\"\n  desc  \"echo is a network service that responds to clients with the data sent to it by the client. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^echo\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":349},"id":"xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_echo_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^echo\" /etc/inetd.conf exit_status should not eq 0","run_time":0.016096642,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure discard is not enabled","desc":"discard is a network service that simply discards all data it receives. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_discard_is_not_enabled\" do\n  title \"Ensure discard is not enabled\"\n  desc  \"discard is a network service that simply discards all data it receives. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^discard\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":358},"id":"xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_discard_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^discard\" /etc/inetd.conf exit_status should not eq 0","run_time":0.015591315,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure time is not enabled","desc":"time is a network service that responds with the server's current date and time as a 32 bit integer. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_time_is_not_enabled\" do\n  title \"Ensure time is not enabled\"\n  desc  \"time is a network service that responds with the server's current date and time as a 32 bit integer. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.\"\n  impact 1.0\n  describe bash(\"egrep \\\"^time\\\" /etc/inetd.conf\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":367},"id":"xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_time_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command egrep \"^time\" /etc/inetd.conf exit_status should not eq 0","run_time":0.015734912,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure the X Window system is not installed","desc":"The X Window system provides a Graphical User Interface (GUI) where users can have multiple windows in which to run programs and various add on. The X Window system is typically used on desktops where users login, but not on servers where users typically do not login.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_the_X_Window_system_is_not_installed\" do\n  title \"Ensure the X Window system is not installed\"\n  desc  \"The X Window system provides a Graphical User Interface (GUI) where users can have multiple windows in which to run programs and various add on. The X Window system is typically used on desktops where users login, but not on servers where users typically do not login.\"\n  impact 1.0\n  describe bash(\"dpkg -l xserver-xorg-core*\") do\n    its(\"stdout\") { should_not match /^ii/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":376},"id":"xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_the_X_Window_system_is_not_installed","results":[{"status":"passed","code_desc":"Bash command dpkg -l xserver-xorg-core* stdout should not match /^ii/","run_time":0.022825465,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure Avahi Server is not enabled","desc":"Avahi is a free zeroconf implementation, including a system for multicast DNS/DNS-SD service discovery. Avahi allows programs to publish and discover services and hosts running on a local network with no specific configuration. For example, a user can plug a computer into a network and Avahi automatically finds printers to print to, files to look at and people to talk to, as well as network services running on the machine.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Avahi_Server_is_not_enabled\" do\n  title \"Ensure Avahi Server is not enabled\"\n  desc  \"Avahi is a free zeroconf implementation, including a system for multicast DNS/DNS-SD service discovery. Avahi allows programs to publish and discover services and hosts running on a local network with no specific configuration. For example, a user can plug a computer into a network and Avahi automatically finds printers to print to, files to look at and people to talk to, as well as network services running on the machine.\"\n  impact 1.0\n  describe bash(\"initctl show-config avahi-daemon | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":385},"id":"xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Avahi_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config avahi-daemon | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.016767022,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure print server is not enabled","desc":"The Common Unix Print System (CUPS) provides the ability to print to both local and network printers. A system running CUPS can also accept print jobs from remote systems and print them to local printers. It also provides a web based remote administration capability.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_print_server_is_not_enabled\" do\n  title \"Ensure print server is not enabled\"\n  desc  \"The Common Unix Print System (CUPS) provides the ability to print to both local and network printers. A system running CUPS can also accept print jobs from remote systems and print them to local printers. It also provides a web based remote administration capability.\"\n  impact 0.0\n  describe bash(\"initctl show-config cups | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":394},"id":"xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_print_server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config cups | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.016635638,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure DHCP Server is not enabled","desc":"The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_DHCP_Server_is_not_enabled\" do\n  title \"Ensure DHCP Server is not enabled\"\n  desc  \"The Dynamic Host Configuration Protocol (DHCP) is a service that allows machines to be dynamically assigned IP addresses.\"\n  impact 1.0\n  describe bash(\"initctl show-config isc-dhcp-server | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"initctl show-config isc-dhcp-server6 | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":403},"id":"xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_DHCP_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config isc-dhcp-server | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.016599975,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"passed","code_desc":"Bash command initctl show-config isc-dhcp-server6 | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.016710006,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Configure Network Time Protocol (NTP)","desc":"The Network Time Protocol (NTP) is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on NTP can be found at http://www.ntp.org. NTP can be configured to be a client and/or a server.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.5_Configure_Network_Time_Protocol_NTP\" do\n  title \"Configure Network Time Protocol (NTP)\"\n  desc  \"The Network Time Protocol (NTP) is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on NTP can be found at http://www.ntp.org. NTP can be configured to be a client and/or a server.\"\n  impact 1.0\n  describe file(\"/etc/ntp.conf\") do\n    its(\"content\") { should match /^\\s*restrict\\s+-4\\s+default(?=[^#]*\\s+kod)(?=[^#]*\\s+nomodify)(?=[^#]*\\s+notrap)(?=[^#]*\\s+nopeer)(?=[^#]*\\s+noquery)(\\s+kod|\\s+nomodify|\\s+notrap|\\s+nopeer|\\s+noquery)*\\s*(?:#.*)?$/ }\n  end\n  describe file(\"/etc/ntp.conf\") do\n    its(\"content\") { should match /^\\s*restrict\\s+-6\\s+default(?=[^#]*\\s+kod)(?=[^#]*\\s+nomodify)(?=[^#]*\\s+notrap)(?=[^#]*\\s+nopeer)(?=[^#]*\\s+noquery)(\\s+kod|\\s+nomodify|\\s+notrap|\\s+nopeer|\\s+noquery)*\\s*(?:#.*)?$/ }\n  end\n  describe file(\"/etc/ntp.conf\") do\n    its(\"content\") { should match /^\\s*server/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":415},"id":"xccdf_org.cisecurity.benchmarks_rule_6.5_Configure_Network_Time_Protocol_NTP","results":[{"status":"failed","code_desc":"File /etc/ntp.conf content should match /^\\s*restrict\\s+-4\\s+default(?=[^#]*\\s+kod)(?=[^#]*\\s+nomodify)(?=[^#]*\\s+notrap)(?=[^#]*\\s+nopeer)(?=[^#]*\\s+noquery)(\\s+kod|\\s+nomodify|\\s+notrap|\\s+nopeer|\\s+noquery)*\\s*(?:#.*)?$/","run_time":0.000249921,"start_time":"2017-06-21 19:45:49 +0000","message":"expected nil to match /^\\s*restrict\\s+-4\\s+default(?=[^#]*\\s+kod)(?=[^#]*\\s+nomodify)(?=[^#]*\\s+notrap)(?=[^#]*\\s+nopeer)(?=[^#]*\\s+noquery)(\\s+kod|\\s+nomodify|\\s+notrap|\\s+nopeer|\\s+noquery)*\\s*(?:#.*)?$/"},{"status":"failed","code_desc":"File /etc/ntp.conf content should match /^\\s*restrict\\s+-6\\s+default(?=[^#]*\\s+kod)(?=[^#]*\\s+nomodify)(?=[^#]*\\s+notrap)(?=[^#]*\\s+nopeer)(?=[^#]*\\s+noquery)(\\s+kod|\\s+nomodify|\\s+notrap|\\s+nopeer|\\s+noquery)*\\s*(?:#.*)?$/","run_time":0.00017226,"start_time":"2017-06-21 19:45:49 +0000","message":"expected nil to match /^\\s*restrict\\s+-6\\s+default(?=[^#]*\\s+kod)(?=[^#]*\\s+nomodify)(?=[^#]*\\s+notrap)(?=[^#]*\\s+nopeer)(?=[^#]*\\s+noquery)(\\s+kod|\\s+nomodify|\\s+notrap|\\s+nopeer|\\s+noquery)*\\s*(?:#.*)?$/"},{"status":"failed","code_desc":"File /etc/ntp.conf content should match /^\\s*server/","run_time":0.000155661,"start_time":"2017-06-21 19:45:49 +0000","message":"expected nil to match /^\\s*server/"}]},{"title":"Ensure LDAP is not enabled","desc":"The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_LDAP_is_not_enabled\" do\n  title \"Ensure LDAP is not enabled\"\n  desc  \"The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.\"\n  impact 0.0\n  describe bash(\"dpkg -s slapd | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":430},"id":"xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_LDAP_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command dpkg -s slapd | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.0242166,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure NFS and RPC are not enabled","desc":"The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_NFS_and_RPC_are_not_enabled\" do\n  title \"Ensure NFS and RPC are not enabled\"\n  desc  \"The Network File System (NFS) is one of the first and most widely distributed file systems in the UNIX environment. It provides the ability for systems to mount file systems of other servers through the network.\"\n  impact 0.0\n  describe bash(\"ls /etc/rc*.d/S*nfs-kernel-server\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"initctl show-config rpcbind-boot | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":439},"id":"xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_NFS_and_RPC_are_not_enabled","results":[{"status":"passed","code_desc":"Bash command ls /etc/rc*.d/S*nfs-kernel-server exit_status should not eq 0","run_time":0.021515554,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"passed","code_desc":"Bash command initctl show-config rpcbind-boot | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.017317375,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure DNS Server is not enabled","desc":"The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_DNS_Server_is_not_enabled\" do\n  title \"Ensure DNS Server is not enabled\"\n  desc  \"The Domain Name System (DNS) is a hierarchical naming system that maps names to IP addresses for computers, services and other resources connected to a network.\"\n  impact 0.0\n  describe bash(\"ls /etc/rc*.d/S*bind9\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":451},"id":"xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_DNS_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command ls /etc/rc*.d/S*bind9 exit_status should not eq 0","run_time":0.016647192,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure FTP Server is not enabled","desc":"The File Transfer Protocol (FTP) provides networked computers with the ability to transfer files.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_FTP_Server_is_not_enabled\" do\n  title \"Ensure FTP Server is not enabled\"\n  desc  \"The File Transfer Protocol (FTP) provides networked computers with the ability to transfer files.\"\n  impact 0.0\n  describe bash(\"initctl show-config vsftpd | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":460},"id":"xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_FTP_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config vsftpd | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.017037895,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure HTTP Server is not enabled","desc":"HTTP or web servers provide the ability to host web site content.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.10_Ensure_HTTP_Server_is_not_enabled\" do\n  title \"Ensure HTTP Server is not enabled\"\n  desc  \"HTTP or web servers provide the ability to host web site content.\"\n  impact 0.0\n  describe bash(\"ls /etc/rc*.d/S*apache2\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":469},"id":"xccdf_org.cisecurity.benchmarks_rule_6.10_Ensure_HTTP_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command ls /etc/rc*.d/S*apache2 exit_status should not eq 0","run_time":0.01654424,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure IMAP and POP server is not enabled","desc":"Dovecot is an open source IMAP and POP3 server for Linux based systems.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.11_Ensure_IMAP_and_POP_server_is_not_enabled\" do\n  title \"Ensure IMAP and POP server is not enabled\"\n  desc  \"Dovecot is an open source IMAP and POP3 server for Linux based systems.\"\n  impact 0.0\n  describe bash(\"initctl show-config dovecot | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":478},"id":"xccdf_org.cisecurity.benchmarks_rule_6.11_Ensure_IMAP_and_POP_server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config dovecot | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.016590667,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure Samba is not enabled","desc":"The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Small Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.12_Ensure_Samba_is_not_enabled\" do\n  title \"Ensure Samba is not enabled\"\n  desc  \"The Samba daemon allows system administrators to configure their Linux systems to share file systems and directories with Windows desktops. Samba will advertise the file systems and directories via the Small Message Block (SMB) protocol. Windows desktop users will be able to mount these directories and file systems as letter drives on their systems.\"\n  impact 0.0\n  describe bash(\"initctl show-config smbd | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":487},"id":"xccdf_org.cisecurity.benchmarks_rule_6.12_Ensure_Samba_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config smbd | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.016604946,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure HTTP Proxy Server is not enabled","desc":"Squid is a standard proxy server used in many distributions and environments.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.13_Ensure_HTTP_Proxy_Server_is_not_enabled\" do\n  title \"Ensure HTTP Proxy Server is not enabled\"\n  desc  \"Squid is a standard proxy server used in many distributions and environments.\"\n  impact 0.0\n  describe bash(\"initctl show-config squid3 | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":496},"id":"xccdf_org.cisecurity.benchmarks_rule_6.13_Ensure_HTTP_Proxy_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command initctl show-config squid3 | egrep \"^\\s*start\" exit_status should not eq 0","run_time":0.019143752,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure SNMP Server is not enabled","desc":"The Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.14_Ensure_SNMP_Server_is_not_enabled\" do\n  title \"Ensure SNMP Server is not enabled\"\n  desc  \"The Simple Network Management Protocol (SNMP) server is used to listen for SNMP commands from an SNMP management system, execute the commands or collect the information and then send results back to the requesting system.\"\n  impact 0.0\n  describe bash(\"ls /etc/rc*.d/S*snmpd\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":505},"id":"xccdf_org.cisecurity.benchmarks_rule_6.14_Ensure_SNMP_Server_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command ls /etc/rc*.d/S*snmpd exit_status should not eq 0","run_time":0.016946342,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Configure Mail Transfer Agent for Local-Only Mode","desc":"Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.15_Configure_Mail_Transfer_Agent_for_Local-Only_Mode\" do\n  title \"Configure Mail Transfer Agent for Local-Only Mode\"\n  desc  \"Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to listen for incoming mail and transfer the messages to the appropriate user or mail server. If the system is not intended to be a mail server, it is recommended that the MTA be configured to only process local mail.\"\n  impact 1.0\n  describe bash(\"netstat -an | grep LIST | awk '($4 != \\\"127.0.0.1:25\\\" && $4 != \\\"::1:25\\\") { print $4 }' | grep \\\":25$\\\"\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":514},"id":"xccdf_org.cisecurity.benchmarks_rule_6.15_Configure_Mail_Transfer_Agent_for_Local-Only_Mode","results":[{"status":"passed","code_desc":"Bash command netstat -an | grep LIST | awk '($4 != \"127.0.0.1:25\" && $4 != \"::1:25\") { print $4 }' | grep \":25$\" stdout should not match /.+/","run_time":0.019349789,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure rsync service is not enabled","desc":"The rsyncd service can be used to synchronize files between systems over network links.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.16_Ensure_rsync_service_is_not_enabled\" do\n  title \"Ensure rsync service is not enabled\"\n  desc  \"The rsyncd service can be used to synchronize files between systems over network links.\"\n  impact 1.0\n  describe file(\"/etc/default/rsync\") do\n    its(\"content\") { should match /^RSYNC_ENABLE=false/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":523},"id":"xccdf_org.cisecurity.benchmarks_rule_6.16_Ensure_rsync_service_is_not_enabled","results":[{"status":"passed","code_desc":"File /etc/default/rsync content should match /^RSYNC_ENABLE=false/","run_time":0.000199777,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure Biosdevname is not enabled","desc":"biosdevname is an external tool that works with the udev framework for naming devices.\n                 biosdevname uses three methods to determine NIC names :\n                    \n                \n                 PCI firmware spec.3.1 smbios (matches # after \"em\" to OEM # printed on board or housing) PCI IRQ Routing Table (uses # of NIC position in the device history). If the BIOS does not support biosdevname, no NICs' are re-named.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_6.17_Ensure_Biosdevname_is_not_enabled\" do\n  title \"Ensure Biosdevname is not enabled\"\n  desc  \"biosdevname is an external tool that works with the udev framework for naming devices.\\n                 biosdevname uses three methods to determine NIC names :\\n                    \\n                \\n                 PCI firmware spec.3.1 smbios (matches # after \\\"em\\\" to OEM # printed on board or housing) PCI IRQ Routing Table (uses # of NIC position in the device history). If the BIOS does not support biosdevname, no NICs' are re-named.\"\n  impact 1.0\n  describe bash(\"dpkg -s biosdevname | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":532},"id":"xccdf_org.cisecurity.benchmarks_rule_6.17_Ensure_Biosdevname_is_not_enabled","results":[{"status":"passed","code_desc":"Bash command dpkg -s biosdevname | egrep \"^Status:\\ install\" exit_status should not eq 0","run_time":0.024252434,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Disable IP Forwarding","desc":"The net.ipv4.ip_forward flag is used to tell the server whether it can forward packets or not. If the server is not to be used as a router, set the flag to 0.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.1.1_Disable_IP_Forwarding\" do\n  title \"Disable IP Forwarding\"\n  desc  \"The net.ipv4.ip_forward flag is used to tell the server whether it can forward packets or not. If the server is not to be used as a router, set the flag to 0.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.ip_forward\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":541},"id":"xccdf_org.cisecurity.benchmarks_rule_7.1.1_Disable_IP_Forwarding","results":[{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.00020485,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"}]},{"title":"Disable Send Packet Redirects","desc":"ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.1.2_Disable_Send_Packet_Redirects\" do\n  title \"Disable Send Packet Redirects\"\n  desc  \"ICMP Redirects are used to send routing information to other hosts. As a host itself does not act as a router (in a host only configuration), there is no need to send redirects.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.conf.all.send_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"sysctl net.ipv4.conf.default.send_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":550},"id":"xccdf_org.cisecurity.benchmarks_rule_7.1.2_Disable_Send_Packet_Redirects","results":[{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000173374,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000170931,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"}]},{"title":"Disable Source Routed Packet Acceptance","desc":"In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.1_Disable_Source_Routed_Packet_Acceptance\" do\n  title \"Disable Source Routed Packet Acceptance\"\n  desc  \"In networking, source routing allows a sender to partially or fully specify the route packets take through a network. In contrast, non-source routed packets travel a path determined by routers in the network. In some cases, systems may not be routable or reachable from some locations (e.g. private addresses vs. Internet routable), and so source routed packets would need to be used.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.conf.all.accept_source_route\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"sysctl net.ipv4.conf.default.accept_source_route\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":562},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.1_Disable_Source_Routed_Packet_Acceptance","results":[{"status":"passed","code_desc":"0 should eq \"0\"","run_time":8.2252e-05,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000126361,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"}]},{"title":"Disable ICMP Redirect Acceptance","desc":"ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.2_Disable_ICMP_Redirect_Acceptance\" do\n  title \"Disable ICMP Redirect Acceptance\"\n  desc  \"ICMP redirect messages are packets that convey routing information and tell your host (acting as a router) to send packets via an alternate path. It is a way of allowing an outside routing device to update your system routing tables. By setting net.ipv4.conf.all.accept_redirects to 0, the system will not accept any ICMP redirect messages, and therefore, won't allow outsiders to update the system's routing tables.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.conf.all.accept_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"sysctl net.ipv4.conf.default.accept_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":574},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.2_Disable_ICMP_Redirect_Acceptance","results":[{"status":"passed","code_desc":"0 should eq \"0\"","run_time":0.000119474,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000125116,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"}]},{"title":"Disable Secure ICMP Redirect Acceptance","desc":"Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.3_Disable_Secure_ICMP_Redirect_Acceptance\" do\n  title \"Disable Secure ICMP Redirect Acceptance\"\n  desc  \"Secure ICMP redirects are the same as ICMP redirects, except they come from gateways listed on the default gateway list. It is assumed that these gateways are known to your system, and that they are likely to be secure.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.conf.all.secure_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"sysctl net.ipv4.conf.default.secure_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should match /0/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":586},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.3_Disable_Secure_ICMP_Redirect_Acceptance","results":[{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000121713,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"1 should match /0/","run_time":0.000344484,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"1\" to match /0/\nDiff:\n@@ -1,2 +1,2 @@\n-/0/\n+\"1\"\n"}]},{"title":"Log Suspicious Packets","desc":"When enabled, this feature logs packets with un-routable source addresses to the kernel log.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.4_Log_Suspicious_Packets\" do\n  title \"Log Suspicious Packets\"\n  desc  \"When enabled, this feature logs packets with un-routable source addresses to the kernel log.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.conf.all.log_martians\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\n  describe bash(\"sysctl net.ipv4.conf.default.log_martians\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":598},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.4_Log_Suspicious_Packets","results":[{"status":"failed","code_desc":"0 should eq \"1\"","run_time":0.000130011,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"1\"\n     got: \"0\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"0 should eq \"1\"","run_time":0.000159328,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"1\"\n     got: \"0\"\n\n(compared using ==)\n"}]},{"title":"Enable Ignore Broadcast Requests","desc":"Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.5_Enable_Ignore_Broadcast_Requests\" do\n  title \"Enable Ignore Broadcast Requests\"\n  desc  \"Setting net.ipv4.icmp_echo_ignore_broadcasts to 1 will cause the system to ignore all ICMP echo and timestamp requests to broadcast and multicast addresses.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.icmp_echo_ignore_broadcasts\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":610},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.5_Enable_Ignore_Broadcast_Requests","results":[{"status":"passed","code_desc":"1 should eq \"1\"","run_time":7.9176e-05,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Enable Bad Error Message Protection","desc":"Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes, keeping file systems from filling up with useless log messages.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.6_Enable_Bad_Error_Message_Protection\" do\n  title \"Enable Bad Error Message Protection\"\n  desc  \"Setting icmp_ignore_bogus_error_responses to 1 prevents the kernel from logging bogus responses (RFC-1122 non-compliant) from broadcast reframes, keeping file systems from filling up with useless log messages.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.icmp_ignore_bogus_error_responses\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":619},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.6_Enable_Bad_Error_Message_Protection","results":[{"status":"passed","code_desc":"1 should eq \"1\"","run_time":7.7218e-05,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Enable RFC-recommended Source Route Validation","desc":"Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet came from, the packet is dropped (and logged if log_martians is set).","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.7_Enable_RFC-recommended_Source_Route_Validation\" do\n  title \"Enable RFC-recommended Source Route Validation\"\n  desc  \"Setting net.ipv4.conf.all.rp_filter and net.ipv4.conf.default.rp_filter to 1 forces the Linux kernel to utilize reverse path filtering on a received packet to determine if the packet was valid. Essentially, with reverse path filtering, if the return packet does not go out the same interface that the corresponding source packet came from, the packet is dropped (and logged if log_martians is set).\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.conf.all.rp_filter\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\n  describe bash(\"sysctl net.ipv4.conf.default.rp_filter\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":628},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.7_Enable_RFC-recommended_Source_Route_Validation","results":[{"status":"passed","code_desc":"1 should eq \"1\"","run_time":7.6225e-05,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"passed","code_desc":"1 should eq \"1\"","run_time":7.4884e-05,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Enable TCP SYN Cookies","desc":"When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three way handshake with the specially crafted sequence number. This allows the server to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.2.8_Enable_TCP_SYN_Cookies\" do\n  title \"Enable TCP SYN Cookies\"\n  desc  \"When tcp_syncookies is set, the kernel will handle TCP SYN packets normally until the half-open connection queue is full, at which time, the SYN cookie functionality kicks in. SYN cookies work by not using the SYN queue at all. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will include a specially crafted TCP sequence number that encodes the source and destination IP address and port number and the time the packet was sent. A legitimate connection would send the ACK packet of the three way handshake with the specially crafted sequence number. This allows the server to verify that it has received a valid response to a SYN cookie and allow the connection, even though there is no corresponding SYN in the queue.\"\n  impact 1.0\n  describe bash(\"sysctl net.ipv4.tcp_syncookies\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"1\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":640},"id":"xccdf_org.cisecurity.benchmarks_rule_7.2.8_Enable_TCP_SYN_Cookies","results":[{"status":"passed","code_desc":"1 should eq \"1\"","run_time":7.6138e-05,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Disable IPv6 Router Advertisements","desc":"This setting disables the systems ability to accept router advertisements","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.3.1_Disable_IPv6_Router_Advertisements\" do\n  title \"Disable IPv6 Router Advertisements\"\n  desc  \"This setting disables the systems ability to accept router advertisements\"\n  impact 0.0\n  describe bash(\"sysctl net.ipv6.conf.all.accept_ra\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"sysctl net.ipv6.conf.default.accept_ra\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":649},"id":"xccdf_org.cisecurity.benchmarks_rule_7.3.1_Disable_IPv6_Router_Advertisements","results":[{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000122111,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000153247,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"}]},{"title":"Disable IPv6 Redirect Acceptance","desc":"This setting prevents the system from accepting ICMP redirects. ICMP redirects tell the system about alternate routes for sending traffic.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.3.2_Disable_IPv6_Redirect_Acceptance\" do\n  title \"Disable IPv6 Redirect Acceptance\"\n  desc  \"This setting prevents the system from accepting ICMP redirects. ICMP redirects tell the system about alternate routes for sending traffic.\"\n  impact 0.0\n  describe bash(\"sysctl net.ipv6.conf.all.accept_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\n  describe bash(\"sysctl net.ipv6.conf.default.accept_redirects\").stdout.to_s.[](/^\\s*\\S+\\s*=\\s*(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":661},"id":"xccdf_org.cisecurity.benchmarks_rule_7.3.2_Disable_IPv6_Redirect_Acceptance","results":[{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000119547,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"},{"status":"failed","code_desc":"1 should eq \"0\"","run_time":0.000119213,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0\"\n     got: \"1\"\n\n(compared using ==)\n"}]},{"title":"Disable IPv6","desc":"Although IPv6 has many advantages over IPv4, few organizations have implemented IPv6.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.3.3_Disable_IPv6\" do\n  title \"Disable IPv6\"\n  desc  \"Although IPv6 has many advantages over IPv4, few organizations have implemented IPv6.\"\n  impact 0.0\n  describe bash(\"ip addr | grep inet6\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":673},"id":"xccdf_org.cisecurity.benchmarks_rule_7.3.3_Disable_IPv6","results":[{"status":"failed","code_desc":"Bash command ip addr | grep inet6 stdout should not match /.+/","run_time":0.01730252,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"    inet6 ::1/128 scope host \\n    inet6 fe80::216:3eff:fe74:edb9/64 scope link \\n\" not to match /.+/\nDiff:\n@@ -1,2 +1,3 @@\n-/.+/\n+    inet6 ::1/128 scope host \n+    inet6 fe80::216:3eff:fe74:edb9/64 scope link \n"}]},{"title":"Install TCP Wrappers","desc":"TCP Wrappers provides a simple access list and standardized logging method for services capable of supporting it. In the past, services that were called from inetd and xinetd supported the use of tcp wrappers. As inetd and xinetd have been falling in disuse, any service that can support tcp wrappers will have the libwrap.so library attached to it.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.4.1_Install_TCP_Wrappers\" do\n  title \"Install TCP Wrappers\"\n  desc  \"TCP Wrappers provides a simple access list and standardized logging method for services capable of supporting it. In the past, services that were called from inetd and xinetd supported the use of tcp wrappers. As inetd and xinetd have been falling in disuse, any service that can support tcp wrappers will have the libwrap.so library attached to it.\"\n  impact 1.0\n  describe bash(\"dpkg -s tcpd | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":682},"id":"xccdf_org.cisecurity.benchmarks_rule_7.4.1_Install_TCP_Wrappers","results":[{"status":"failed","code_desc":"Bash command dpkg -s tcpd | egrep \"^Status:\\ install\" exit_status should eq 0","run_time":0.023029343,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"}]},{"title":"Create /etc/hosts.allow","desc":"The /etc/hosts.allow file specifies which IP addresses are permitted to connect to the host. It is intended to be used in conjunction with the /etc/hosts.deny file.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.4.2_Create_etchosts.allow\" do\n  title \"Create /etc/hosts.allow\"\n  desc  \"The /etc/hosts.allow file specifies which IP addresses are permitted to connect to the host. It is intended to be used in conjunction with the /etc/hosts.deny file.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":691},"id":"xccdf_org.cisecurity.benchmarks_rule_7.4.2_Create_etchosts.allow"},{"title":"Verify Permissions on /etc/hosts.allow","desc":"The /etc/hosts.allow file contains networking information that is used by many applications and therefore must be readable for these applications to operate.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.4.3_Verify_Permissions_on_etchosts.allow\" do\n  title \"Verify Permissions on /etc/hosts.allow\"\n  desc  \"The /etc/hosts.allow file contains networking information that is used by many applications and therefore must be readable for these applications to operate.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/hosts.allow | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":697},"id":"xccdf_org.cisecurity.benchmarks_rule_7.4.3_Verify_Permissions_on_etchosts.allow","results":[{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":0.000119328,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Create /etc/hosts.deny","desc":"The /etc/hosts.deny file specifies which IP addresses are not permitted to connect to the host. It is intended to be used in conjunction with the /etc/hosts.allow file.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.4.4_Create_etchosts.deny\" do\n  title \"Create /etc/hosts.deny\"\n  desc  \"The /etc/hosts.deny file specifies which IP addresses are not permitted to connect to the host. It is intended to be used in conjunction with the /etc/hosts.allow file.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":706},"id":"xccdf_org.cisecurity.benchmarks_rule_7.4.4_Create_etchosts.deny"},{"title":"Verify Permissions on /etc/hosts.deny","desc":"The /etc/hosts.deny file contains network information that is used by many system applications and therefore must be readable for these applications to operate.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.4.5_Verify_Permissions_on_etchosts.deny\" do\n  title \"Verify Permissions on /etc/hosts.deny\"\n  desc  \"The /etc/hosts.deny file contains network information that is used by many system applications and therefore must be readable for these applications to operate.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/hosts.deny | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":712},"id":"xccdf_org.cisecurity.benchmarks_rule_7.4.5_Verify_Permissions_on_etchosts.deny","results":[{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":8.2714e-05,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Disable DCCP","desc":"The Datagram Congestion Control Protocol (DCCP) is a transport layer protocol that supports streaming media and telephony. DCCP provides a way to gain access to congestion control, without having to do it at the application layer, but does not provide in-sequence delivery.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.5.1_Disable_DCCP\" do\n  title \"Disable DCCP\"\n  desc  \"The Datagram Congestion Control Protocol (DCCP) is a transport layer protocol that supports streaming media and telephony. DCCP provides a way to gain access to congestion control, without having to do it at the application layer, but does not provide in-sequence delivery.\"\n  impact 0.0\n  describe bash(\"modprobe -n -v dccp\") do\n    its(\"stdout\") { should match /^install \\/bin\\/true/ }\n  end\n  describe bash(\"lsmod | egrep \\\"^dccp\\\\s\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":721},"id":"xccdf_org.cisecurity.benchmarks_rule_7.5.1_Disable_DCCP","results":[{"status":"failed","code_desc":"Bash command modprobe -n -v dccp stdout should match /^install \\/bin\\/true/","run_time":0.0171813,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /^install \\/bin\\/true/\nDiff:\n@@ -1,2 +1,2 @@\n-/^install \\/bin\\/true/\n+\"\"\n"},{"status":"passed","code_desc":"Bash command lsmod | egrep \"^dccp\\s\" exit_status should not eq 0","run_time":0.018134589,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Disable SCTP","desc":"The Stream Control Transmission Protocol (SCTP) is a transport layer protocol used to support message oriented communication, with several streams of messages in one connection. It serves a similar function as TCP and UDP, incorporating features of both. It is message-oriented like UDP, and ensures reliable in-sequence transport of messages with congestion control like TCP.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.5.2_Disable_SCTP\" do\n  title \"Disable SCTP\"\n  desc  \"The Stream Control Transmission Protocol (SCTP) is a transport layer protocol used to support message oriented communication, with several streams of messages in one connection. It serves a similar function as TCP and UDP, incorporating features of both. It is message-oriented like UDP, and ensures reliable in-sequence transport of messages with congestion control like TCP.\"\n  impact 0.0\n  describe bash(\"modprobe -n -v sctp\") do\n    its(\"stdout\") { should match /^install \\/bin\\/true/ }\n  end\n  describe bash(\"lsmod | egrep \\\"^sctp\\\\s\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":733},"id":"xccdf_org.cisecurity.benchmarks_rule_7.5.2_Disable_SCTP","results":[{"status":"failed","code_desc":"Bash command modprobe -n -v sctp stdout should match /^install \\/bin\\/true/","run_time":0.017080862,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /^install \\/bin\\/true/\nDiff:\n@@ -1,2 +1,2 @@\n-/^install \\/bin\\/true/\n+\"\"\n"},{"status":"passed","code_desc":"Bash command lsmod | egrep \"^sctp\\s\" exit_status should not eq 0","run_time":0.017467491,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Disable RDS","desc":"The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol designed to provide low-latency, high-bandwidth communications between cluster nodes. It was developed by the Oracle Corporation.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.5.3_Disable_RDS\" do\n  title \"Disable RDS\"\n  desc  \"The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol designed to provide low-latency, high-bandwidth communications between cluster nodes. It was developed by the Oracle Corporation.\"\n  impact 0.0\n  describe bash(\"modprobe -n -v rds\") do\n    its(\"stdout\") { should match /^install \\/bin\\/true/ }\n  end\n  describe bash(\"lsmod | egrep \\\"^rds\\\\s\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":745},"id":"xccdf_org.cisecurity.benchmarks_rule_7.5.3_Disable_RDS","results":[{"status":"failed","code_desc":"Bash command modprobe -n -v rds stdout should match /^install \\/bin\\/true/","run_time":0.017522953,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /^install \\/bin\\/true/\nDiff:\n@@ -1,2 +1,2 @@\n-/^install \\/bin\\/true/\n+\"\"\n"},{"status":"passed","code_desc":"Bash command lsmod | egrep \"^rds\\s\" exit_status should not eq 0","run_time":0.018196158,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Disable TIPC","desc":"The Transparent Inter-Process Communication (TIPC) protocol is designed to provide communication between cluster nodes.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.5.4_Disable_TIPC\" do\n  title \"Disable TIPC\"\n  desc  \"The Transparent Inter-Process Communication (TIPC) protocol is designed to provide communication between cluster nodes.\"\n  impact 0.0\n  describe bash(\"modprobe -n -v tipc\") do\n    its(\"stdout\") { should match /^install \\/bin\\/true/ }\n  end\n  describe bash(\"lsmod | egrep \\\"^tipc\\\\s\\\"\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":757},"id":"xccdf_org.cisecurity.benchmarks_rule_7.5.4_Disable_TIPC","results":[{"status":"failed","code_desc":"Bash command modprobe -n -v tipc stdout should match /^install \\/bin\\/true/","run_time":0.018575363,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /^install \\/bin\\/true/\nDiff:\n@@ -1,2 +1,2 @@\n-/^install \\/bin\\/true/\n+\"\"\n"},{"status":"passed","code_desc":"Bash command lsmod | egrep \"^tipc\\s\" exit_status should not eq 0","run_time":0.017216435,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Deactivate Wireless Interfaces","desc":"Wireless networking is used when wired networks are unavailable. Ubuntu provides the nmcli interface which allows system administrators to configure and use wireless networks.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.6_Deactivate_Wireless_Interfaces\" do\n  title \"Deactivate Wireless Interfaces\"\n  desc  \"Wireless networking is used when wired networks are unavailable. Ubuntu provides the nmcli interface which allows system administrators to configure and use wireless networks.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":769},"id":"xccdf_org.cisecurity.benchmarks_rule_7.6_Deactivate_Wireless_Interfaces"},{"title":"Ensure Firewall is active","desc":"IPtables is an application that allows a system administrator to configure the IPv4 tables, chains and rules provided by the Linux kernel firewall. ufw was developed to ease IPtables firewall configuration.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_Firewall_is_active\" do\n  title \"Ensure Firewall is active\"\n  desc  \"IPtables is an application that allows a system administrator to configure the IPv4 tables, chains and rules provided by the Linux kernel firewall. ufw was developed to ease IPtables firewall configuration.\"\n  impact 1.0\n  describe bash(\"ufw status\") do\n    its(\"stdout\") { should match /^Status: active$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":775},"id":"xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_Firewall_is_active","results":[{"status":"failed","code_desc":"Bash command ufw status stdout should match /^Status: active$/","run_time":0.103357181,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"Status: inactive\\n\" to match /^Status: active$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^Status: active$/\n+Status: inactive\n"}]},{"title":"Install the rsyslog package","desc":"The rsyslog package is a third party package that provides many enhancements to syslog, such as multi-threading, TCP communication, message filtering and data base support.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2.1_Install_the_rsyslog_package\" do\n  title \"Install the rsyslog package\"\n  desc  \"The rsyslog package is a third party package that provides many enhancements to syslog, such as multi-threading, TCP communication, message filtering and data base support.\"\n  impact 1.0\n  describe bash(\"dpkg -s rsyslog | egrep \\\"^Status:\\\\ install\\\"\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":784},"id":"xccdf_org.cisecurity.benchmarks_rule_8.2.1_Install_the_rsyslog_package","results":[{"status":"passed","code_desc":"Bash command dpkg -s rsyslog | egrep \"^Status:\\ install\" exit_status should eq 0","run_time":0.024464043,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Ensure the rsyslog Service is activated","desc":"Once the rsyslog package is installed it needs to be activated.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2.2_Ensure_the_rsyslog_Service_is_activated\" do\n  title \"Ensure the rsyslog Service is activated\"\n  desc  \"Once the rsyslog package is installed it needs to be activated.\"\n  impact 1.0\n  describe bash(\"initctl show-config rsyslog | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":793},"id":"xccdf_org.cisecurity.benchmarks_rule_8.2.2_Ensure_the_rsyslog_Service_is_activated","results":[{"status":"passed","code_desc":"Bash command initctl show-config rsyslog | egrep \"^\\s*start\" exit_status should eq 0","run_time":0.018044217,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Configure /etc/rsyslog.conf","desc":"The /etc/rsyslog.conf file specifies rules for logging and which files are to be used to log certain classes of messages.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2.3_Configure_etcrsyslog.conf\" do\n  title \"Configure /etc/rsyslog.conf\"\n  desc  \"The /etc/rsyslog.conf file specifies rules for logging and which files are to be used to log certain classes of messages.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":802},"id":"xccdf_org.cisecurity.benchmarks_rule_8.2.3_Configure_etcrsyslog.conf"},{"title":"Create and Set Permissions on rsyslog Log Files","desc":"A log file must already exist for rsyslog to be able to write to it.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2.4_Create_and_Set_Permissions_on_rsyslog_Log_Files\" do\n  title \"Create and Set Permissions on rsyslog Log Files\"\n  desc  \"A log file must already exist for rsyslog to be able to write to it.\"\n  impact 1.0\n  describe bash(\"find `awk '/^ *[^\\#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o \\\"/.*\\\"` ! -user root\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\n  describe bash(\"find `awk '/^ *[^\\#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o \\\"/.*\\\"` -perm /o+rwx\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\n  describe bash(\"find `awk '/^ *[^\\#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o \\\"/.*\\\"` -perm /g+wx\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":808},"id":"xccdf_org.cisecurity.benchmarks_rule_8.2.4_Create_and_Set_Permissions_on_rsyslog_Log_Files","results":[{"status":"failed","code_desc":"Bash command find `awk '/^ *[^#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o \"/.*\"` ! -user root stdout should not match /.+/","run_time":0.018235557,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"/var/log/auth.log\\n/var/log/syslog\\n\" not to match /.+/\nDiff:\n@@ -1,2 +1,3 @@\n-/.+/\n+/var/log/auth.log\n+/var/log/syslog\n"},{"status":"passed","code_desc":"Bash command find `awk '/^ *[^#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o \"/.*\"` -perm /o+rwx stdout should not match /.+/","run_time":0.017425983,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"passed","code_desc":"Bash command find `awk '/^ *[^#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o \"/.*\"` -perm /g+wx stdout should not match /.+/","run_time":0.017234202,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Configure rsyslog to Send Logs to a Remote Log Host","desc":"The rsyslog utility supports the ability to send logs it gathers to a remote log host running syslogd(8) or to receive messages from remote hosts, reducing administrative overhead.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2.5_Configure_rsyslog_to_Send_Logs_to_a_Remote_Log_Host\" do\n  title \"Configure rsyslog to Send Logs to a Remote Log Host\"\n  desc  \"The rsyslog utility supports the ability to send logs it gathers to a remote log host running syslogd(8) or to receive messages from remote hosts, reducing administrative overhead.\"\n  impact 1.0\n  describe file(\"/etc/rsyslog.conf\") do\n    its(\"content\") { should match /^\\*\\.\\*\\s+@/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":823},"id":"xccdf_org.cisecurity.benchmarks_rule_8.2.5_Configure_rsyslog_to_Send_Logs_to_a_Remote_Log_Host","results":[{"status":"failed","code_desc":"File /etc/rsyslog.conf content should match /^\\*\\.\\*\\s+@/","run_time":0.000742606,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"#  /etc/rsyslog.conf\\tConfiguration file for rsyslog.\\n#\\n#\\t\\t\\tFor more information see\\n#\\t\\t\\t/u...og\\n\\n#\\n# Include all config files in /etc/rsyslog.d/\\n#\\n$IncludeConfig /etc/rsyslog.d/*.conf\\n\\n\" to match /^\\*\\.\\*\\s+@/\nDiff:\n@@ -1,2 +1,61 @@\n-/^\\*\\.\\*\\s+@/\n+#  /etc/rsyslog.conf\tConfiguration file for rsyslog.\n+#\n+#\t\t\tFor more information see\n+#\t\t\t/usr/share/doc/rsyslog-doc/html/rsyslog_conf.html\n+#\n+#  Default logging rules can be found in /etc/rsyslog.d/50-default.conf\n+\n+\n+#################\n+#### MODULES ####\n+#################\n+\n+$ModLoad imuxsock # provides support for local system logging\n+$ModLoad imklog   # provides kernel logging support\n+#$ModLoad immark  # provides --MARK-- message capability\n+\n+# provides UDP syslog reception\n+#$ModLoad imudp\n+#$UDPServerRun 514\n+\n+# provides TCP syslog reception\n+#$ModLoad imtcp\n+#$InputTCPServerRun 514\n+\n+# Enable non-kernel facility klog messages\n+$KLogPermitNonKernelFacility on\n+\n+###########################\n+#### GLOBAL DIRECTIVES ####\n+###########################\n+\n+#\n+# Use traditional timestamp format.\n+# To enable high precision timestamps, comment out the following line.\n+#\n+$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat\n+\n+# Filter duplicated messages\n+$RepeatedMsgReduction on\n+\n+#\n+# Set the default permissions for all log files.\n+#\n+$FileOwner syslog\n+$FileGroup adm\n+$FileCreateMode 0640\n+$DirCreateMode 0755\n+$Umask 0022\n+$PrivDropToUser syslog\n+$PrivDropToGroup syslog\n+\n+#\n+# Where to place spool and state files\n+#\n+$WorkDirectory /var/spool/rsyslog\n+\n+#\n+# Include all config files in /etc/rsyslog.d/\n+#\n+$IncludeConfig /etc/rsyslog.d/*.conf\n"}]},{"title":"Accept Remote rsyslog Messages Only on Designated Log Hosts","desc":"By default, rsyslog does not listen for log messages coming in from remote systems. The ModLoad tells rsyslog to load the imtcp.so module so it can listen over a network via TCP. The InputTCPServerRun option instructs rsyslogd to listen on the specified TCP port.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.2.6_Accept_Remote_rsyslog_Messages_Only_on_Designated_Log_Hosts\" do\n  title \"Accept Remote rsyslog Messages Only on Designated Log Hosts\"\n  desc  \"By default, rsyslog does not listen for log messages coming in from remote systems. The ModLoad tells rsyslog to load the imtcp.so module so it can listen over a network via TCP. The InputTCPServerRun option instructs rsyslogd to listen on the specified TCP port.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":832},"id":"xccdf_org.cisecurity.benchmarks_rule_8.2.6_Accept_Remote_rsyslog_Messages_Only_on_Designated_Log_Hosts"},{"title":"Configure logrotate","desc":"The system includes the capability of rotating log files regularly to avoid filling up the system with logs or making the logs unmanageable large. The file /etc/logrotate.d/rsyslog is the configuration file used to rotate log files created by rsyslog.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_8.4_Configure_logrotate\" do\n  title \"Configure logrotate\"\n  desc  \"The system includes the capability of rotating log files regularly to avoid filling up the system with logs or making the logs unmanageable large. The file /etc/logrotate.d/rsyslog is the configuration file used to rotate log files created by rsyslog.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":838},"id":"xccdf_org.cisecurity.benchmarks_rule_8.4_Configure_logrotate"},{"title":"Enable cron Daemon","desc":"The cron daemon is used to execute batch jobs on the system.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.1_Enable_cron_Daemon\" do\n  title \"Enable cron Daemon\"\n  desc  \"The cron daemon is used to execute batch jobs on the system.\"\n  impact 1.0\n  describe bash(\"initctl show-config cron | egrep \\\"^\\\\s*start\\\"\") do\n    its(\"exit_status\") { should eq 0 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":844},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.1_Enable_cron_Daemon","results":[{"status":"passed","code_desc":"Bash command initctl show-config cron | egrep \"^\\s*start\" exit_status should eq 0","run_time":0.017283265,"start_time":"2017-06-21 19:45:49 +0000"}]},{"title":"Set User/Group Owner and Permission on /etc/crontab","desc":"The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.2_Set_UserGroup_Owner_and_Permission_on_etccrontab\" do\n  title \"Set User/Group Owner and Permission on /etc/crontab\"\n  desc  \"The /etc/crontab file is used by cron to control its own jobs. The commands in this item make sure that root is the user and group owner of the file and that only the owner can access the file.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/crontab\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/crontab | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":853},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.2_Set_UserGroup_Owner_and_Permission_on_etccrontab","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/crontab stdout should match /0 0/","run_time":0.01619745,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"0044 should eq \"0000\"","run_time":0.000204539,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: \"0044\"\n\n(compared using ==)\n"}]},{"title":"Set User/Group Owner and Permission on /etc/cron.hourly","desc":"This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.3_Set_UserGroup_Owner_and_Permission_on_etccron.hourly\" do\n  title \"Set User/Group Owner and Permission on /etc/cron.hourly\"\n  desc  \"This directory contains system cron jobs that need to run on an hourly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/cron.hourly\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/cron.hourly | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":865},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.3_Set_UserGroup_Owner_and_Permission_on_etccron.hourly","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/cron.hourly stdout should match /0 0/","run_time":0.015800162,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"0055 should eq \"0000\"","run_time":0.000173475,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: \"0055\"\n\n(compared using ==)\n"}]},{"title":"Set User/Group Owner and Permission on /etc/cron.daily","desc":"The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.4_Set_UserGroup_Owner_and_Permission_on_etccron.daily\" do\n  title \"Set User/Group Owner and Permission on /etc/cron.daily\"\n  desc  \"The /etc/cron.daily directory contains system cron jobs that need to run on a daily basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/cron.daily\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/cron.daily | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":877},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.4_Set_UserGroup_Owner_and_Permission_on_etccron.daily","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/cron.daily stdout should match /0 0/","run_time":0.015632792,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"0055 should eq \"0000\"","run_time":0.000269012,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: \"0055\"\n\n(compared using ==)\n"}]},{"title":"Set User/Group Owner and Permission on /etc/cron.weekly","desc":"The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.5_Set_UserGroup_Owner_and_Permission_on_etccron.weekly\" do\n  title \"Set User/Group Owner and Permission on /etc/cron.weekly\"\n  desc  \"The /etc/cron.weekly directory contains system cron jobs that need to run on a weekly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/cron.weekly\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/cron.weekly | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":889},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.5_Set_UserGroup_Owner_and_Permission_on_etccron.weekly","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/cron.weekly stdout should match /0 0/","run_time":0.015567839,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"0055 should eq \"0000\"","run_time":0.000209039,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: \"0055\"\n\n(compared using ==)\n"}]},{"title":"Set User/Group Owner and Permission on /etc/cron.monthly","desc":"The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.6_Set_UserGroup_Owner_and_Permission_on_etccron.monthly\" do\n  title \"Set User/Group Owner and Permission on /etc/cron.monthly\"\n  desc  \"The /etc/cron.monthly directory contains system cron jobs that need to run on a monthly basis. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/cron.monthly\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/cron.monthly | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":901},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.6_Set_UserGroup_Owner_and_Permission_on_etccron.monthly","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/cron.monthly stdout should match /0 0/","run_time":0.016728311,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"0055 should eq \"0000\"","run_time":0.000185175,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: \"0055\"\n\n(compared using ==)\n"}]},{"title":"Set User/Group Owner and Permission on /etc/cron.d","desc":"The /etc/cron.d directory contains system cron jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from /etc/crontab, but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.7_Set_UserGroup_Owner_and_Permission_on_etccron.d\" do\n  title \"Set User/Group Owner and Permission on /etc/cron.d\"\n  desc  \"The /etc/cron.d directory contains system cron jobs that need to run in a similar manner to the hourly, daily weekly and monthly jobs from /etc/crontab, but require more granular control as to when they run. The files in this directory cannot be manipulated by the crontab command, but are instead edited by system administrators using a text editor. The commands below restrict read/write and search access to user and group root, preventing regular users from accessing this directory.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/cron.d\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/cron.d | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":913},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.7_Set_UserGroup_Owner_and_Permission_on_etccron.d","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/cron.d stdout should match /0 0/","run_time":0.015922811,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"0055 should eq \"0000\"","run_time":0.000181087,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: \"0055\"\n\n(compared using ==)\n"}]},{"title":"Restrict at/cron to Authorized Users","desc":"Configure /etc/cron.allow and /etc/at.allow to allow specific users to use these services. If /etc/cron.allow or /etc/at.allow do not exist, then /etc/at.deny and /etc/cron.deny are checked. Any user not specifically defined in those files is allowed to use at and cron. By removing the files, only users in /etc/cron.allow and /etc/at.allow are allowed to use at and cron. Note that even though a given user is not listed in cron.allow, cron jobs can still be run as that user. The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.1.8_Restrict_atcron_to_Authorized_Users\" do\n  title \"Restrict at/cron to Authorized Users\"\n  desc  \"Configure /etc/cron.allow and /etc/at.allow to allow specific users to use these services. If /etc/cron.allow or /etc/at.allow do not exist, then /etc/at.deny and /etc/cron.deny are checked. Any user not specifically defined in those files is allowed to use at and cron. By removing the files, only users in /etc/cron.allow and /etc/at.allow are allowed to use at and cron. Note that even though a given user is not listed in cron.allow, cron jobs can still be run as that user. The cron.allow file only controls administrative access to the crontab command for scheduling and modifying cron jobs.\"\n  impact 1.0\n  describe bash(\"stat /etc/cron.deny\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/cron.allow\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/cron.allow | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\n  describe bash(\"stat /etc/at.deny\") do\n    its(\"exit_status\") { should_not eq 0 }\n  end\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/at.allow\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\n  describe bash(\"ui=($(echo 0077 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/at.allow | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":925},"id":"xccdf_org.cisecurity.benchmarks_rule_9.1.8_Restrict_atcron_to_Authorized_Users","results":[{"status":"passed","code_desc":"Bash command stat /etc/cron.deny exit_status should not eq 0","run_time":0.015783611,"start_time":"2017-06-21 19:45:49 +0000"},{"status":"failed","code_desc":"Bash command stat -c \"%u %g\" /etc/cron.allow stdout should match /0 0/","run_time":0.016177934,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /0 0/\nDiff:\n@@ -1,2 +1,2 @@\n-/0 0/\n+\"\"\n"},{"status":"failed","code_desc":"should eq \"0000\"","run_time":0.000144934,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: nil\n\n(compared using ==)\n"},{"status":"failed","code_desc":"Bash command stat /etc/at.deny exit_status should not eq 0","run_time":0.016247457,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: value != 0\n     got: 0\n\n(compared using ==)\n"},{"status":"failed","code_desc":"Bash command stat -c \"%u %g\" /etc/at.allow stdout should match /0 0/","run_time":0.016330093,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /0 0/\nDiff:\n@@ -1,2 +1,2 @@\n-/0 0/\n+\"\"\n"},{"status":"failed","code_desc":"should eq \"0000\"","run_time":0.000203396,"start_time":"2017-06-21 19:45:49 +0000","message":"\nexpected: \"0000\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Set Password Creation Requirement Parameters Using pam_cracklib","desc":"The pam_cracklib module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more. The following are definitions of the pam_cracklib.so options.\n                    \n                        \n                             retry=3 - Allow 3 tries before sending back a failure.\n                         minlen=14 - password must be 14 characters or more\n                         dcredit=-1 - provide at least one digit\n                         ucredit=-1 - provide at least one uppercase character\n                         ocredit=-1 - provide at least one special character\n                         lcredit=-1 - provide at least one lowercase character\n                     The setting shown above is one possible policy. Alter these values to conform to your own organization's password policies.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.2.1_Set_Password_Creation_Requirement_Parameters_Using_pam_cracklib\" do\n  title \"Set Password Creation Requirement Parameters Using pam_cracklib\"\n  desc  \"The pam_cracklib module checks the strength of passwords. It performs checks such as making sure a password is not a dictionary word, it is a certain length, contains a mix of characters (e.g. alphabet, numeric, other) and more. The following are definitions of the pam_cracklib.so options.\\n                    \\n                        \\n                             retry=3 - Allow 3 tries before sending back a failure.\\n                         minlen=14 - password must be 14 characters or more\\n                         dcredit=-1 - provide at least one digit\\n                         ucredit=-1 - provide at least one uppercase character\\n                         ocredit=-1 - provide at least one special character\\n                         lcredit=-1 - provide at least one lowercase character\\n                     The setting shown above is one possible policy. Alter these values to conform to your own organization's password policies.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^[[:space:]]*#\\\" /etc/pam.d/common-password | egrep \\\"pam_cracklib.so\\\" | sed -e 's/#.*//' | tr -s '\\\\t ' '\\\\n' | awk -F = '/^retry/ { if ($2 <= 3) print $2 }'\") do\n    its(\"stdout\") { should match /.+/ }\n  end\n  describe bash(\"egrep -v \\\"^[[:space:]]*#\\\" /etc/pam.d/common-password | egrep \\\"pam_cracklib.so\\\" | sed -e 's/#.*//' | tr -s '\\\\t ' '\\\\n' | awk -F = '/^minlen/ { if ($2 >= 14) print $2 }'\") do\n    its(\"stdout\") { should match /.+/ }\n  end\n  describe bash(\"egrep -v \\\"^[[:space:]]*#\\\" /etc/pam.d/common-password | egrep \\\"pam_cracklib.so\\\" | sed -e 's/#.*//' | tr -s '\\\\t ' '\\\\n' | awk -F = '/^dcredit/ { if ($2 <= -1) print $2 }'\") do\n    its(\"stdout\") { should match /.+/ }\n  end\n  describe bash(\"egrep -v \\\"^[[:space:]]*#\\\" /etc/pam.d/common-password | egrep \\\"pam_cracklib.so\\\" | sed -e 's/#.*//' | tr -s '\\\\t ' '\\\\n' | awk -F = '/^ucredit/ { if ($2 <= -1) print $2 }'\") do\n    its(\"stdout\") { should match /.+/ }\n  end\n  describe bash(\"egrep -v \\\"^[[:space:]]*#\\\" /etc/pam.d/common-password | egrep \\\"pam_cracklib.so\\\" | sed -e 's/#.*//' | tr -s '\\\\t ' '\\\\n' | awk -F = '/^lcredit/ { if ($2 <= -1) print $2 }'\") do\n    its(\"stdout\") { should match /.+/ }\n  end\n  describe bash(\"egrep -v \\\"^[[:space:]]*#\\\" /etc/pam.d/common-password | egrep \\\"pam_cracklib.so\\\" | sed -e 's/#.*//' | tr -s '\\\\t ' '\\\\n' | awk -F = '/^ocredit/ { if ($2 <= -1) print $2 }'\") do\n    its(\"stdout\") { should match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":949},"id":"xccdf_org.cisecurity.benchmarks_rule_9.2.1_Set_Password_Creation_Requirement_Parameters_Using_pam_cracklib","results":[{"status":"failed","code_desc":"Bash command egrep -v \"^[[:space:]]*#\" /etc/pam.d/common-password | egrep \"pam_cracklib.so\" | sed -e 's/#.*//' | tr -s '\\t ' '\\n' | awk -F = '/^retry/ { if ($2 <= 3) print $2 }' stdout should match /.+/","run_time":0.017503641,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command egrep -v \"^[[:space:]]*#\" /etc/pam.d/common-password | egrep \"pam_cracklib.so\" | sed -e 's/#.*//' | tr -s '\\t ' '\\n' | awk -F = '/^minlen/ { if ($2 >= 14) print $2 }' stdout should match /.+/","run_time":0.017716736,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command egrep -v \"^[[:space:]]*#\" /etc/pam.d/common-password | egrep \"pam_cracklib.so\" | sed -e 's/#.*//' | tr -s '\\t ' '\\n' | awk -F = '/^dcredit/ { if ($2 <= -1) print $2 }' stdout should match /.+/","run_time":0.01721535,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command egrep -v \"^[[:space:]]*#\" /etc/pam.d/common-password | egrep \"pam_cracklib.so\" | sed -e 's/#.*//' | tr -s '\\t ' '\\n' | awk -F = '/^ucredit/ { if ($2 <= -1) print $2 }' stdout should match /.+/","run_time":0.018177377,"start_time":"2017-06-21 19:45:49 +0000","message":"expected \"\" to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command egrep -v \"^[[:space:]]*#\" /etc/pam.d/common-password | egrep \"pam_cracklib.so\" | sed -e 's/#.*//' | tr -s '\\t ' '\\n' | awk -F = '/^lcredit/ { if ($2 <= -1) print $2 }' stdout should match /.+/","run_time":0.017636872,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"\" to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+\"\"\n"},{"status":"failed","code_desc":"Bash command egrep -v \"^[[:space:]]*#\" /etc/pam.d/common-password | egrep \"pam_cracklib.so\" | sed -e 's/#.*//' | tr -s '\\t ' '\\n' | awk -F = '/^ocredit/ { if ($2 <= -1) print $2 }' stdout should match /.+/","run_time":0.019225041,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"\" to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+\"\"\n"}]},{"title":"Set Lockout for Failed Password Attempts","desc":"Lock out users after n unsuccessful consecutive login attempts. The first sets of changes are made to the PAM configuration file /etc/pam.d/login. The second set of changes are applied to the program specific PAM configuration file. The second set of changes must be applied to each program that will lock out users. Check the documentation for each secondary program for instructions on how to configure them to work with PAM. Set the lockout number to the policy in effect at your site.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.2.2_Set_Lockout_for_Failed_Password_Attempts\" do\n  title \"Set Lockout for Failed Password Attempts\"\n  desc  \"Lock out users after n unsuccessful consecutive login attempts. The first sets of changes are made to the PAM configuration file /etc/pam.d/login. The second set of changes are applied to the program specific PAM configuration file. The second set of changes must be applied to each program that will lock out users. Check the documentation for each secondary program for instructions on how to configure them to work with PAM. Set the lockout number to the policy in effect at your site.\"\n  impact 0.0\n  describe file(\"/etc/pam.d/login\") do\n    its(\"content\") { should match /^auth\\s+required\\s+pam_tally2.so\\s+onerr=fail\\s+audit\\s+silent\\s+deny=5\\s+unlock_time=900$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":973},"id":"xccdf_org.cisecurity.benchmarks_rule_9.2.2_Set_Lockout_for_Failed_Password_Attempts","results":[{"status":"failed","code_desc":"File /etc/pam.d/login content should match /^auth\\s+required\\s+pam_tally2.so\\s+onerr=fail\\s+audit\\s+silent\\s+deny=5\\s+unlock_time=900$/","run_time":0.001696549,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"#\\n# The PAM configuration file for the Shadow `login' service\\n#\\n\\n# Enforce a minimal delay in ca...is present, \\\"required\\\" would be sufficient (When SELinux\\n# is disabled, this returns success.)\\n\" to match /^auth\\s+required\\s+pam_tally2.so\\s+onerr=fail\\s+audit\\s+silent\\s+deny=5\\s+unlock_time=900$/\nDiff:\n@@ -1,2 +1,111 @@\n-/^auth\\s+required\\s+pam_tally2.so\\s+onerr=fail\\s+audit\\s+silent\\s+deny=5\\s+unlock_time=900$/\n+#\n+# The PAM configuration file for the Shadow `login' service\n+#\n+\n+# Enforce a minimal delay in case of failure (in microseconds).\n+# (Replaces the `FAIL_DELAY' setting from login.defs)\n+# Note that other modules may require another minimal delay. (for example,\n+# to disable any delay, you should add the nodelay option to pam_unix)\n+auth       optional   pam_faildelay.so  delay=3000000\n+\n+# Outputs an issue file prior to each login prompt (Replaces the\n+# ISSUE_FILE option from login.defs). Uncomment for use\n+# auth       required   pam_issue.so issue=/etc/issue\n+\n+# Disallows root logins except on tty's listed in /etc/securetty\n+# (Replaces the `CONSOLE' setting from login.defs)\n+#\n+# With the default control of this module:\n+#   [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die]\n+# root will not be prompted for a password on insecure lines.\n+# if an invalid username is entered, a password is prompted (but login\n+# will eventually be rejected)\n+#\n+# You can change it to a \"requisite\" module if you think root may mis-type\n+# her login and should not be prompted for a password in that case. But\n+# this will leave the system as vulnerable to user enumeration attacks.\n+#\n+# You can change it to a \"required\" module if you think it permits to\n+# guess valid user names of your system (invalid user names are considered\n+# as possibly being root on insecure lines), but root passwords may be\n+# communicated over insecure lines.\n+auth [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die] pam_securetty.so\n+\n+# Disallows other than root logins when /etc/nologin exists\n+# (Replaces the `NOLOGINS_FILE' option from login.defs)\n+auth       requisite  pam_nologin.so\n+\n+# SELinux needs to be the first session rule. This ensures that any \n+# lingering context has been cleared. Without out this it is possible \n+# that a module could execute code in the wrong domain.\n+# When the module is present, \"required\" would be sufficient (When SELinux\n+# is disabled, this returns success.)\n+session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so close\n+\n+# This module parses environment configuration file(s)\n+# and also allows you to use an extended config\n+# file /etc/security/pam_env.conf.\n+# \n+# parsing /etc/environment needs \"readenv=1\"\n+session       required   pam_env.so readenv=1\n+# locale variables are also kept into /etc/default/locale in etch\n+# reading this file *in addition to /etc/environment* does not hurt\n+session       required   pam_env.so readenv=1 envfile=/etc/default/locale\n+\n+# Standard Un*x authentication.\n+@include common-auth\n+\n+# This allows certain extra groups to be granted to a user\n+# based on things like time of day, tty, service, and user.\n+# Please edit /etc/security/group.conf to fit your needs\n+# (Replaces the `CONSOLE_GROUPS' option in login.defs)\n+auth       optional   pam_group.so\n+\n+# Uncomment and edit /etc/security/time.conf if you need to set\n+# time restrainst on logins.\n+# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs\n+# as well as /etc/porttime)\n+# account    requisite  pam_time.so\n+\n+# Uncomment and edit /etc/security/access.conf if you need to\n+# set access limits.\n+# (Replaces /etc/login.access file)\n+# account  required       pam_access.so\n+\n+# Sets up user limits according to /etc/security/limits.conf\n+# (Replaces the use of /etc/limits in old login)\n+session    required   pam_limits.so\n+\n+# Prints the last login info upon succesful login\n+# (Replaces the `LASTLOG_ENAB' option from login.defs)\n+session    optional   pam_lastlog.so\n+\n+# Prints the message of the day upon succesful login.\n+# (Replaces the `MOTD_FILE' option in login.defs)\n+# This includes a dynamically generated part from /run/motd.dynamic\n+# and a static (admin-editable) part from /etc/motd.\n+session    optional   pam_motd.so  motd=/run/motd.dynamic noupdate\n+session    optional   pam_motd.so\n+\n+# Prints the status of the user's mailbox upon succesful login\n+# (Replaces the `MAIL_CHECK_ENAB' option from login.defs). \n+#\n+# This also defines the MAIL environment variable\n+# However, userdel also needs MAIL_DIR and MAIL_FILE variables\n+# in /etc/login.defs to make sure that removing a user \n+# also removes the user's mail spool file.\n+# See comments in /etc/login.defs\n+session    optional   pam_mail.so standard\n+\n+# Standard Un*x account and session\n+@include common-account\n+@include common-session\n+@include common-password\n+\n+# SELinux needs to intervene at login time to ensure that the process\n+# starts in the proper default security context. Only sessions which are\n+# intended to run in the user's context should be run after this.\n+session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so open\n+# When the module is present, \"required\" would be sufficient (When SELinux\n+# is disabled, this returns success.)\n"}]},{"title":"Limit Password Reuse","desc":"The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.2.3_Limit_Password_Reuse\" do\n  title \"Limit Password Reuse\"\n  desc  \"The /etc/security/opasswd file stores the users' old passwords and can be checked to ensure that users are not recycling recent passwords.\"\n  impact 1.0\n  describe file(\"/etc/pam.d/common-password\") do\n    its(\"content\") { should match /^[^#]*remember/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":982},"id":"xccdf_org.cisecurity.benchmarks_rule_9.2.3_Limit_Password_Reuse","results":[{"status":"failed","code_desc":"File /etc/pam.d/common-password content should match /^[^#]*remember/","run_time":0.000567059,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"#\\n# /etc/pam.d/common-password - password-related modules common to all services\\n#\\n# This file is...and here are more per-package modules (the \\\"Additional\\\" block)\\n# end of pam-auth-update config\\n\" to match /^[^#]*remember/\nDiff:\n@@ -1,2 +1,34 @@\n-/^[^#]*remember/\n+#\n+# /etc/pam.d/common-password - password-related modules common to all services\n+#\n+# This file is included from other service-specific PAM config files,\n+# and should contain a list of modules that define the services to be\n+# used to change user passwords.  The default is pam_unix.\n+\n+# Explanation of pam_unix options:\n+#\n+# The \"sha512\" option enables salted SHA512 passwords.  Without this option,\n+# the default is Unix crypt.  Prior releases used the option \"md5\".\n+#\n+# The \"obscure\" option replaces the old `OBSCURE_CHECKS_ENAB' option in\n+# login.defs.\n+#\n+# See the pam_unix manpage for other options.\n+\n+# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\n+# To take advantage of this, it is recommended that you configure any\n+# local modules either before or after the default block, and use\n+# pam-auth-update to manage selection of other modules.  See\n+# pam-auth-update(8) for details.\n+\n+# here are the per-package modules (the \"Primary\" block)\n+password\t[success=1 default=ignore]\tpam_unix.so obscure sha512\n+# here's the fallback if no module succeeds\n+password\trequisite\t\t\tpam_deny.so\n+# prime the stack with a positive return value if there isn't one already;\n+# this avoids us returning an error just because nothing sets a success code\n+# since the modules above will each just jump around\n+password\trequired\t\t\tpam_permit.so\n+# and here are more per-package modules (the \"Additional\" block)\n+# end of pam-auth-update config\n"}]},{"title":"Set SSH Protocol to 2","desc":"SSH supports two different and incompatible protocols: SSH1 and SSH2. SSH1 was the original protocol and was subject to security issues. SSH2 is more advanced and secure.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.1_Set_SSH_Protocol_to_2\" do\n  title \"Set SSH Protocol to 2\"\n  desc  \"SSH supports two different and incompatible protocols: SSH1 and SSH2. SSH1 was the original protocol and was subject to security issues. SSH2 is more advanced and secure.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*Protocol\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"2\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":991},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.1_Set_SSH_Protocol_to_2","results":[{"status":"passed","code_desc":"2 should eq \"2\"","run_time":0.000104293,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Set LogLevel to INFO","desc":"The INFO parameter specifices that record login and logout activity will be logged.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.2_Set_LogLevel_to_INFO\" do\n  title \"Set LogLevel to INFO\"\n  desc  \"The INFO parameter specifices that record login and logout activity will be logged.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*LogLevel\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"INFO\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1000},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.2_Set_LogLevel_to_INFO","results":[{"status":"passed","code_desc":"INFO should eq \"INFO\"","run_time":8.2535e-05,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Set Permissions on /etc/ssh/sshd_config","desc":"The /etc/ssh/sshd_config file contains configuration specifications for sshd. The command below sets the owner and group of the file to root.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.3_Set_Permissions_on_etcsshsshd_config\" do\n  title \"Set Permissions on /etc/ssh/sshd_config\"\n  desc  \"The /etc/ssh/sshd_config file contains configuration specifications for sshd. The command below sets the owner and group of the file to root.\"\n  impact 1.0\n  describe bash(\"stat -L -c \\\"%a %u %g\\\" /etc/ssh/sshd_config\") do\n    its(\"stdout\") { should match /.00 0 0/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1009},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.3_Set_Permissions_on_etcsshsshd_config","results":[{"status":"failed","code_desc":"Bash command stat -L -c \"%a %u %g\" /etc/ssh/sshd_config stdout should match /.00 0 0/","run_time":0.017150796,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"644 0 0\\n\" to match /.00 0 0/\nDiff:\n@@ -1,2 +1,2 @@\n-/.00 0 0/\n+644 0 0\n"}]},{"title":"Disable SSH X11 Forwarding","desc":"The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.4_Disable_SSH_X11_Forwarding\" do\n  title \"Disable SSH X11 Forwarding\"\n  desc  \"The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*X11Forwarding\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"no\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1018},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.4_Disable_SSH_X11_Forwarding","results":[{"status":"failed","code_desc":"yes should eq \"no\"","run_time":0.000174598,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"no\"\n     got: \"yes\"\n\n(compared using ==)\n"}]},{"title":"Set SSH MaxAuthTries to 4 or Less","desc":"The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.5_Set_SSH_MaxAuthTries_to_4_or_Less\" do\n  title \"Set SSH MaxAuthTries to 4 or Less\"\n  desc  \"The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. When the login failure count reaches half the number, error messages will be written to the syslog file detailing the login failure.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*MaxAuthTries\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should cmp <= 4 }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1027},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.5_Set_SSH_MaxAuthTries_to_4_or_Less","results":[{"status":"failed","code_desc":"should cmp <= 4","run_time":0.000212834,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected it to be <= 4\n     got: \n\n(compared using `cmp` matcher)\n"}]},{"title":"Set SSH IgnoreRhosts to Yes","desc":"The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.6_Set_SSH_IgnoreRhosts_to_Yes\" do\n  title \"Set SSH IgnoreRhosts to Yes\"\n  desc  \"The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*IgnoreRhosts\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"yes\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1036},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.6_Set_SSH_IgnoreRhosts_to_Yes","results":[{"status":"passed","code_desc":"yes should eq \"yes\"","run_time":9.0473e-05,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Set SSH HostbasedAuthentication to No","desc":"The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user of .rhosts, or /etc/hosts.equiv, along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.7_Set_SSH_HostbasedAuthentication_to_No\" do\n  title \"Set SSH HostbasedAuthentication to No\"\n  desc  \"The HostbasedAuthentication parameter specifies if authentication is allowed through trusted hosts via the user of .rhosts, or /etc/hosts.equiv, along with successful public key client host authentication. This option only applies to SSH Protocol Version 2.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*HostbasedAuthentication\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"no\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1045},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.7_Set_SSH_HostbasedAuthentication_to_No","results":[{"status":"passed","code_desc":"no should eq \"no\"","run_time":8.1645e-05,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Disable SSH Root Login","desc":"The PermitRootLogin parameter specifies if the root user can log in using ssh(1). The default is no.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.8_Disable_SSH_Root_Login\" do\n  title \"Disable SSH Root Login\"\n  desc  \"The PermitRootLogin parameter specifies if the root user can log in using ssh(1). The default is no.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*PermitRootLogin\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"no\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1054},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.8_Disable_SSH_Root_Login","results":[{"status":"failed","code_desc":"without-password should eq \"no\"","run_time":0.000122882,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"no\"\n     got: \"without-password\"\n\n(compared using ==)\n"}]},{"title":"Set SSH PermitEmptyPasswords to No","desc":"The PermitEmptyPasswords parameter specifies if the server allows login to accounts with empty password strings.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.9_Set_SSH_PermitEmptyPasswords_to_No\" do\n  title \"Set SSH PermitEmptyPasswords to No\"\n  desc  \"The PermitEmptyPasswords parameter specifies if the server allows login to accounts with empty password strings.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*PermitEmptyPasswords\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"no\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1063},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.9_Set_SSH_PermitEmptyPasswords_to_No","results":[{"status":"passed","code_desc":"no should eq \"no\"","run_time":7.9003e-05,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Do Not Allow Users to Set Environment Options","desc":"The PermitUserEnvironment option allows users to present environment options to the ssh daemon.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.10_Do_Not_Allow_Users_to_Set_Environment_Options\" do\n  title \"Do Not Allow Users to Set Environment Options\"\n  desc  \"The PermitUserEnvironment option allows users to present environment options to the ssh daemon.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*PermitUserEnvironment\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"no\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1072},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.10_Do_Not_Allow_Users_to_Set_Environment_Options","results":[{"status":"failed","code_desc":"should eq \"no\"","run_time":0.000121575,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"no\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Use Only Approved Cipher in Counter Mode","desc":"This variable limits the types of ciphers that SSH can use during communication.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.11_Use_Only_Approved_Cipher_in_Counter_Mode\" do\n  title \"Use Only Approved Cipher in Counter Mode\"\n  desc  \"This variable limits the types of ciphers that SSH can use during communication.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*Ciphers\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"aes128-ctr,aes192-ctr,aes256-ctr\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1081},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.11_Use_Only_Approved_Cipher_in_Counter_Mode","results":[{"status":"failed","code_desc":"should eq \"aes128-ctr,aes192-ctr,aes256-ctr\"","run_time":0.000113743,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"aes128-ctr,aes192-ctr,aes256-ctr\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Set Idle Timeout Interval for User Login","desc":"The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions. When the ClientAliveInterval variable is set, ssh sessions that have no activity for the specified length of time are terminated. When the ClientAliveCountMax variable is set, sshd will send client alive messages at every ClientAliveInterval interval. When the number of consecutive client alive messages are sent with no response from the client, the ssh session is terminated. For example, if the ClientAliveInterval is set to 15 seconds and the ClientAliveCountMax is set to 3, the client ssh session will be terminated after 45 seconds of idle time.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.12_Set_Idle_Timeout_Interval_for_User_Login\" do\n  title \"Set Idle Timeout Interval for User Login\"\n  desc  \"The two options ClientAliveInterval and ClientAliveCountMax control the timeout of ssh sessions. When the ClientAliveInterval variable is set, ssh sessions that have no activity for the specified length of time are terminated. When the ClientAliveCountMax variable is set, sshd will send client alive messages at every ClientAliveInterval interval. When the number of consecutive client alive messages are sent with no response from the client, the ssh session is terminated. For example, if the ClientAliveInterval is set to 15 seconds and the ClientAliveCountMax is set to 3, the client ssh session will be terminated after 45 seconds of idle time.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*ClientAliveInterval\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"300\" }\n  end\n  describe bash(\"grep '^\\\\s*ClientAliveCountMax\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should eq \"0\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1090},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.12_Set_Idle_Timeout_Interval_for_User_Login","results":[{"status":"failed","code_desc":"should eq \"300\"","run_time":0.000109377,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"300\"\n     got: nil\n\n(compared using ==)\n"},{"status":"failed","code_desc":"should eq \"0\"","run_time":0.000171389,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"0\"\n     got: nil\n\n(compared using ==)\n"}]},{"title":"Limit Access via SSH","desc":"There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:\n                    \n                         AllowUsers\n                        \n                     The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of comma separated user names. Numeric userIDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.\n                    \n                         AllowGroups\n                        \n                     The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of comma separated user names. Numeric groupIDs are not recognized with this variable.\n                    \n                         DenyUsers\n                        \n                     The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of comma separated user names. Numeric userIDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.\n                    \n                         DenyGroups\n                        \n                     The DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of comma separated group names. Numeric groupIDs are not recognized with this variable.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.13_Limit_Access_via_SSH\" do\n  title \"Limit Access via SSH\"\n  desc  \"There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged:\\n                    \\n                         AllowUsers\\n                        \\n                     The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of comma separated user names. Numeric userIDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host.\\n                    \\n                         AllowGroups\\n                        \\n                     The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of comma separated user names. Numeric groupIDs are not recognized with this variable.\\n                    \\n                         DenyUsers\\n                        \\n                     The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of comma separated user names. Numeric userIDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host.\\n                    \\n                         DenyGroups\\n                        \\n                     The DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of comma separated group names. Numeric groupIDs are not recognized with this variable.\"\n  impact 1.0\n  describe file(\"/etc/ssh/sshd_config\") do\n    its(\"content\") { should match /^\\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\\s+.*/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1102},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.13_Limit_Access_via_SSH","results":[{"status":"failed","code_desc":"File /etc/ssh/sshd_config content should match /^\\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\\s+.*/","run_time":0.000998287,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"# Package generated configuration file\\n# See the sshd_config(5) manpage for details\\n\\n# What ports...e this but set PasswordAuthentication\\n# and ChallengeResponseAuthentication to 'no'.\\nUsePAM yes\\n\" to match /^\\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\\s+.*/\nDiff:\n@@ -1,2 +1,89 @@\n-/^\\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\\s+.*/\n+# Package generated configuration file\n+# See the sshd_config(5) manpage for details\n+\n+# What ports, IPs and protocols we listen for\n+Port 22\n+# Use these options to restrict which interfaces/protocols sshd will bind to\n+#ListenAddress ::\n+#ListenAddress 0.0.0.0\n+Protocol 2\n+# HostKeys for protocol version 2\n+HostKey /etc/ssh/ssh_host_rsa_key\n+HostKey /etc/ssh/ssh_host_dsa_key\n+HostKey /etc/ssh/ssh_host_ecdsa_key\n+HostKey /etc/ssh/ssh_host_ed25519_key\n+#Privilege Separation is turned on for security\n+UsePrivilegeSeparation yes\n+\n+# Lifetime and size of ephemeral version 1 server key\n+KeyRegenerationInterval 3600\n+ServerKeyBits 1024\n+\n+# Logging\n+SyslogFacility AUTH\n+LogLevel INFO\n+\n+# Authentication:\n+LoginGraceTime 120\n+PermitRootLogin without-password\n+StrictModes yes\n+\n+RSAAuthentication yes\n+PubkeyAuthentication yes\n+#AuthorizedKeysFile\t%h/.ssh/authorized_keys\n+\n+# Don't read the user's ~/.rhosts and ~/.shosts files\n+IgnoreRhosts yes\n+# For this to work you will also need host keys in /etc/ssh_known_hosts\n+RhostsRSAAuthentication no\n+# similar for protocol version 2\n+HostbasedAuthentication no\n+# Uncomment if you don't trust ~/.ssh/known_hosts for RhostsRSAAuthentication\n+#IgnoreUserKnownHosts yes\n+\n+# To enable empty passwords, change to yes (NOT RECOMMENDED)\n+PermitEmptyPasswords no\n+\n+# Change to yes to enable challenge-response passwords (beware issues with\n+# some PAM modules and threads)\n+ChallengeResponseAuthentication no\n+\n+# Change to no to disable tunnelled clear text passwords\n+#PasswordAuthentication yes\n+\n+# Kerberos options\n+#KerberosAuthentication no\n+#KerberosGetAFSToken no\n+#KerberosOrLocalPasswd yes\n+#KerberosTicketCleanup yes\n+\n+# GSSAPI options\n+#GSSAPIAuthentication no\n+#GSSAPICleanupCredentials yes\n+\n+X11Forwarding yes\n+X11DisplayOffset 10\n+PrintMotd no\n+PrintLastLog yes\n+TCPKeepAlive yes\n+#UseLogin no\n+\n+#MaxStartups 10:30:60\n+#Banner /etc/issue.net\n+\n+# Allow client to pass locale environment variables\n+AcceptEnv LANG LC_*\n+\n+Subsystem sftp /usr/lib/openssh/sftp-server\n+\n+# Set this to 'yes' to enable PAM authentication, account processing,\n+# and session processing. If this is enabled, PAM authentication will\n+# be allowed through the ChallengeResponseAuthentication and\n+# PasswordAuthentication.  Depending on your PAM configuration,\n+# PAM authentication via ChallengeResponseAuthentication may bypass\n+# the setting of \"PermitRootLogin without-password\".\n+# If you just want the PAM account and session checks to run without\n+# PAM authentication, then enable this but set PasswordAuthentication\n+# and ChallengeResponseAuthentication to 'no'.\n+UsePAM yes\n"}]},{"title":"Set SSH Banner","desc":"The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.3.14_Set_SSH_Banner\" do\n  title \"Set SSH Banner\"\n  desc  \"The Banner parameter specifies a file whose contents must be sent to the remote user before authentication is permitted. By default, no banner is displayed.\"\n  impact 1.0\n  describe bash(\"grep '^\\\\s*Banner\\\\s' /etc/ssh/sshd_config | head -1\").stdout.to_s.[](/\\s*\\S+\\s+(.+?)\\s*(#.*)?$/, 1) do\n    it { should match /issue(\\.net)?/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1111},"id":"xccdf_org.cisecurity.benchmarks_rule_9.3.14_Set_SSH_Banner","results":[{"status":"failed","code_desc":"should match /issue(\\.net)?/","run_time":0.000126144,"start_time":"2017-06-21 19:45:50 +0000","message":"expected nil to match /issue(\\.net)?/"}]},{"title":"Restrict root Login to System Console","desc":"The file /etc/securetty contains a list of valid terminals that may be logged in directly as root.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.4_Restrict_root_Login_to_System_Console\" do\n  title \"Restrict root Login to System Console\"\n  desc  \"The file /etc/securetty contains a list of valid terminals that may be logged in directly as root.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1120},"id":"xccdf_org.cisecurity.benchmarks_rule_9.4_Restrict_root_Login_to_System_Console"},{"title":"Restrict Access to the su Command","desc":"The su command allows a user to run a command or shell as another user. The program has been superseded by sudo, which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su, the su command will only allow users in the wheel group to execute su.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_9.5_Restrict_Access_to_the_su_Command\" do\n  title \"Restrict Access to the su Command\"\n  desc  \"The su command allows a user to run a command or shell as another user. The program has been superseded by sudo, which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su, the su command will only allow users in the wheel group to execute su.\"\n  impact 1.0\n  describe file(\"/etc/pam.d/su\") do\n    its(\"content\") { should match /^\\s*auth\\s+required\\s+pam_wheel.so\\s+use_uid/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1126},"id":"xccdf_org.cisecurity.benchmarks_rule_9.5_Restrict_Access_to_the_su_Command","results":[{"status":"failed","code_desc":"File /etc/pam.d/su content should match /^\\s*auth\\s+required\\s+pam_wheel.so\\s+use_uid/","run_time":0.001303349,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"#\\n# The PAM configuration file for the Shadow `su' service\\n#\\n\\n# This allows root to su without p... /etc/shadow entries.\\n@include common-auth\\n@include common-account\\n@include common-session\\n\\n\\n\" to match /^\\s*auth\\s+required\\s+pam_wheel.so\\s+use_uid/\nDiff:\n@@ -1,2 +1,61 @@\n-/^\\s*auth\\s+required\\s+pam_wheel.so\\s+use_uid/\n+#\n+# The PAM configuration file for the Shadow `su' service\n+#\n+\n+# This allows root to su without passwords (normal operation)\n+auth       sufficient pam_rootok.so\n+\n+# Uncomment this to force users to be a member of group root\n+# before they can use `su'. You can also add \"group=foo\"\n+# to the end of this line if you want to use a group other\n+# than the default \"root\" (but this may have side effect of\n+# denying \"root\" user, unless she's a member of \"foo\" or explicitly\n+# permitted earlier by e.g. \"sufficient pam_rootok.so\").\n+# (Replaces the `SU_WHEEL_ONLY' option from login.defs)\n+# auth       required   pam_wheel.so\n+\n+# Uncomment this if you want wheel members to be able to\n+# su without a password.\n+# auth       sufficient pam_wheel.so trust\n+\n+# Uncomment this if you want members of a specific group to not\n+# be allowed to use su at all.\n+# auth       required   pam_wheel.so deny group=nosu\n+\n+# Uncomment and edit /etc/security/time.conf if you need to set\n+# time restrainst on su usage.\n+# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs\n+# as well as /etc/porttime)\n+# account    requisite  pam_time.so\n+\n+# This module parses environment configuration file(s)\n+# and also allows you to use an extended config\n+# file /etc/security/pam_env.conf.\n+# \n+# parsing /etc/environment needs \"readenv=1\"\n+session       required   pam_env.so readenv=1\n+# locale variables are also kept into /etc/default/locale in etch\n+# reading this file *in addition to /etc/environment* does not hurt\n+session       required   pam_env.so readenv=1 envfile=/etc/default/locale\n+\n+# Defines the MAIL environment variable\n+# However, userdel also needs MAIL_DIR and MAIL_FILE variables\n+# in /etc/login.defs to make sure that removing a user \n+# also removes the user's mail spool file.\n+# See comments in /etc/login.defs\n+#\n+# \"nopen\" stands to avoid reporting new mail when su'ing to another user\n+session    optional   pam_mail.so nopen\n+\n+# Sets up user limits, please uncomment and read /etc/security/limits.conf\n+# to enable this functionality.\n+# (Replaces the use of /etc/limits in old login)\n+# session    required   pam_limits.so\n+\n+# The standard Unix authentication modules, used with\n+# NIS (man nsswitch) as well as normal /etc/passwd and\n+# /etc/shadow entries.\n+@include common-auth\n+@include common-account\n+@include common-session\n"}]},{"title":"Set Password Expiration Days","desc":"The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age. It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 90 days.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.1.1_Set_Password_Expiration_Days\" do\n  title \"Set Password Expiration Days\"\n  desc  \"The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age. It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 90 days.\"\n  impact 1.0\n  describe file(\"/etc/login.defs\") do\n    its(\"content\") { should match /^\\s*PASS_MAX_DAYS\\s+90/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1135},"id":"xccdf_org.cisecurity.benchmarks_rule_10.1.1_Set_Password_Expiration_Days","results":[{"status":"failed","code_desc":"File /etc/login.defs content should match /^\\s*PASS_MAX_DAYS\\s+90/","run_time":0.002732517,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"#\\n# /etc/login.defs - Configuration control definitions for the login package.\\n#\\n# Three items mu...###################\\n\\n# CLOSE_SESSIONS\\n# LOGIN_STRING\\n# NO_PASSWORD_CONSOLE\\n# QMAIL_DIR\\n\\n\\n\\n\" to match /^\\s*PASS_MAX_DAYS\\s+90/\nDiff:\n@@ -1,2 +1,339 @@\n-/^\\s*PASS_MAX_DAYS\\s+90/\n+#\n+# /etc/login.defs - Configuration control definitions for the login package.\n+#\n+# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n+# If unspecified, some arbitrary (and possibly incorrect) value will\n+# be assumed.  All other items are optional - if not specified then\n+# the described action or option will be inhibited.\n+#\n+# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n+#\n+# Modified for Linux.  --marekm\n+\n+# REQUIRED for useradd/userdel/usermod\n+#   Directory where mailboxes reside, _or_ name of file, relative to the\n+#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n+#   MAIL_DIR takes precedence.\n+#\n+#   Essentially:\n+#      - MAIL_DIR defines the location of users mail spool files\n+#        (for mbox use) by appending the username to MAIL_DIR as defined\n+#        below.\n+#      - MAIL_FILE defines the location of the users mail spool files as the\n+#        fully-qualified filename obtained by prepending the user home\n+#        directory before $MAIL_FILE\n+#\n+# NOTE: This is no more used for setting up users MAIL environment variable\n+#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n+#       job of the pam_mail PAM modules\n+#       See default PAM configuration files provided for\n+#       login, su, etc.\n+#\n+# This is a temporary situation: setting these variables will soon\n+# move to /etc/default/useradd and the variables will then be\n+# no more supported\n+MAIL_DIR        /var/mail\n+#MAIL_FILE      .mail\n+\n+#\n+# Enable logging and display of /var/log/faillog login failure info.\n+# This option conflicts with the pam_tally PAM module.\n+#\n+FAILLOG_ENAB\t\tyes\n+\n+#\n+# Enable display of unknown usernames when login failures are recorded.\n+#\n+# WARNING: Unknown usernames may become world readable. \n+# See #290803 and #298773 for details about how this could become a security\n+# concern\n+LOG_UNKFAIL_ENAB\tno\n+\n+#\n+# Enable logging of successful logins\n+#\n+LOG_OK_LOGINS\t\tno\n+\n+#\n+# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n+# SYSLOG_SG_ENAB does the same for newgrp and sg.\n+#\n+SYSLOG_SU_ENAB\t\tyes\n+SYSLOG_SG_ENAB\t\tyes\n+\n+#\n+# If defined, all su activity is logged to this file.\n+#\n+#SULOG_FILE\t/var/log/sulog\n+\n+#\n+# If defined, file which maps tty line to TERM environment parameter.\n+# Each line of the file is in a format something like \"vt100  tty01\".\n+#\n+#TTYTYPE_FILE\t/etc/ttytype\n+\n+#\n+# If defined, login failures will be logged here in a utmp format\n+# last, when invoked as lastb, will read /var/log/btmp, so...\n+#\n+FTMP_FILE\t/var/log/btmp\n+\n+#\n+# If defined, the command name to display when running \"su -\".  For\n+# example, if this is defined as \"su\" then a \"ps\" will display the\n+# command is \"-su\".  If not defined, then \"ps\" would display the\n+# name of the shell actually being run, e.g. something like \"-sh\".\n+#\n+SU_NAME\t\tsu\n+\n+#\n+# If defined, file which inhibits all the usual chatter during the login\n+# sequence.  If a full pathname, then hushed mode will be enabled if the\n+# user's name or shell are found in the file.  If not a full pathname, then\n+# hushed mode will be enabled if the file exists in the user's home directory.\n+#\n+HUSHLOGIN_FILE\t.hushlogin\n+#HUSHLOGIN_FILE\t/etc/hushlogins\n+\n+#\n+# *REQUIRED*  The default PATH settings, for superuser and normal users.\n+#\n+# (they are minimal, add the rest in the shell startup files)\n+ENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+ENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+\n+#\n+# Terminal permissions\n+#\n+#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n+#\tTTYPERM\t\tLogin tty will be set to this permission.\n+#\n+# If you have a \"write\" program which is \"setgid\" to a special group\n+# which owns the terminals, define TTYGROUP to the group number and\n+# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n+# TTYPERM to either 622 or 600.\n+#\n+# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n+# However, the default and recommended value for TTYPERM is still 0600\n+# to not allow anyone to write to anyone else console or terminal\n+\n+# Users can still allow other people to write them by issuing \n+# the \"mesg y\" command.\n+\n+TTYGROUP\ttty\n+TTYPERM\t\t0600\n+\n+#\n+# Login configuration initializations:\n+#\n+#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n+#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n+#\tUMASK\t\tDefault \"umask\" value.\n+#\n+# The ERASECHAR and KILLCHAR are used only on System V machines.\n+# \n+# UMASK is the default umask value for pam_umask and is used by\n+# useradd and newusers to set the mode of the new home directories.\n+# 022 is the \"historical\" value in Debian for UMASK\n+# 027, or even 077, could be considered better for privacy\n+# There is no One True Answer here : each sysadmin must make up his/her\n+# mind.\n+#\n+# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n+# for private user groups, i. e. the uid is the same as gid, and username is\n+# the same as the primary group name: for these, the user permissions will be\n+# used as group permissions, e. g. 022 will become 002.\n+#\n+# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n+#\n+ERASECHAR\t0177\n+KILLCHAR\t025\n+UMASK\t\t022\n+\n+#\n+# Password aging controls:\n+#\n+#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n+#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n+#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n+#\n+PASS_MAX_DAYS\t99999\n+PASS_MIN_DAYS\t0\n+PASS_WARN_AGE\t7\n+\n+#\n+# Min/max values for automatic uid selection in useradd\n+#\n+UID_MIN\t\t\t 1000\n+UID_MAX\t\t\t60000\n+# System accounts\n+#SYS_UID_MIN\t\t  100\n+#SYS_UID_MAX\t\t  999\n+\n+#\n+# Min/max values for automatic gid selection in groupadd\n+#\n+GID_MIN\t\t\t 1000\n+GID_MAX\t\t\t60000\n+# System accounts\n+#SYS_GID_MIN\t\t  100\n+#SYS_GID_MAX\t\t  999\n+\n+#\n+# Max number of login retries if password is bad. This will most likely be\n+# overriden by PAM, since the default pam_unix module has it's own built\n+# in of 3 retries. However, this is a safe fallback in case you are using\n+# an authentication module that does not enforce PAM_MAXTRIES.\n+#\n+LOGIN_RETRIES\t\t5\n+\n+#\n+# Max time in seconds for login\n+#\n+LOGIN_TIMEOUT\t\t60\n+\n+#\n+# Which fields may be changed by regular users using chfn - use\n+# any combination of letters \"frwh\" (full name, room number, work\n+# phone, home phone).  If not defined, no changes are allowed.\n+# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n+# \n+CHFN_RESTRICT\t\trwh\n+\n+#\n+# Should login be allowed if we can't cd to the home directory?\n+# Default in no.\n+#\n+DEFAULT_HOME\tyes\n+\n+#\n+# If defined, this command is run when removing a user.\n+# It should remove any at/cron/print jobs etc. owned by\n+# the user to be removed (passed as the first argument).\n+#\n+#USERDEL_CMD\t/usr/sbin/userdel_local\n+\n+#\n+# Enable setting of the umask group bits to be the same as owner bits\n+# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n+# the same as gid, and username is the same as the primary group name.\n+#\n+# If set to yes, userdel will remove the users group if it contains no\n+# more members, and useradd will create by default a group with the name\n+# of the user.\n+#\n+USERGROUPS_ENAB yes\n+\n+#\n+# Instead of the real user shell, the program specified by this parameter\n+# will be launched, although its visible name (argv[0]) will be the shell's.\n+# The program may do whatever it wants (logging, additional authentification,\n+# banner, ...) before running the actual shell.\n+#\n+# FAKE_SHELL /bin/fakeshell\n+\n+#\n+# If defined, either full pathname of a file containing device names or\n+# a \":\" delimited list of device names.  Root logins will be allowed only\n+# upon these devices.\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE\t/etc/consoles\n+#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n+\n+#\n+# List of groups to add to the user's supplementary group set\n+# when logging in on the console (as determined by the CONSOLE\n+# setting).  Default is none.\n+#\n+# Use with caution - it is possible for users to gain permanent\n+# access to these groups, even when not logged in on the console.\n+# How to do it is left as an exercise for the reader...\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n+\n+#\n+# If set to \"yes\", new passwords will be encrypted using the MD5-based\n+# algorithm compatible with the one used by recent releases of FreeBSD.\n+# It supports passwords of unlimited length and longer salt strings.\n+# Set to \"no\" if you need to copy encrypted passwords to other systems\n+# which don't understand the new algorithm.  Default is \"no\".\n+#\n+# This variable is deprecated. You should use ENCRYPT_METHOD.\n+#\n+#MD5_CRYPT_ENAB\tno\n+\n+#\n+# If set to MD5 , MD5-based algorithm will be used for encrypting password\n+# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n+# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n+# If set to DES, DES-based algorithm will be used for encrypting password (default)\n+# Overrides the MD5_CRYPT_ENAB option\n+#\n+# Note: It is recommended to use a value consistent with\n+# the PAM modules configuration.\n+#\n+ENCRYPT_METHOD SHA512\n+\n+#\n+# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n+#\n+# Define the number of SHA rounds.\n+# With a lot of rounds, it is more difficult to brute forcing the password.\n+# But note also that it more CPU resources will be needed to authenticate\n+# users.\n+#\n+# If not specified, the libc will choose the default number of rounds (5000).\n+# The values must be inside the 1000-999999999 range.\n+# If only one of the MIN or MAX values is set, then this value will be used.\n+# If MIN > MAX, the highest value will be used.\n+#\n+# SHA_CRYPT_MIN_ROUNDS 5000\n+# SHA_CRYPT_MAX_ROUNDS 5000\n+\n+################# OBSOLETED BY PAM ##############\n+#\t\t\t\t\t\t#\n+# These options are now handled by PAM. Please\t#\n+# edit the appropriate file in /etc/pam.d/ to\t#\n+# enable the equivelants of them.\n+#\n+###############\n+\n+#MOTD_FILE\n+#DIALUPS_CHECK_ENAB\n+#LASTLOG_ENAB\n+#MAIL_CHECK_ENAB\n+#OBSCURE_CHECKS_ENAB\n+#PORTTIME_CHECKS_ENAB\n+#SU_WHEEL_ONLY\n+#CRACKLIB_DICTPATH\n+#PASS_CHANGE_TRIES\n+#PASS_ALWAYS_WARN\n+#ENVIRON_FILE\n+#NOLOGINS_FILE\n+#ISSUE_FILE\n+#PASS_MIN_LEN\n+#PASS_MAX_LEN\n+#ULIMIT\n+#ENV_HZ\n+#CHFN_AUTH\n+#CHSH_AUTH\n+#FAIL_DELAY\n+\n+################# OBSOLETED #######################\n+#\t\t\t\t\t\t  #\n+# These options are no more handled by shadow.    #\n+#                                                 #\n+# Shadow utilities will display a warning if they #\n+# still appear.                                   #\n+#                                                 #\n+###################################################\n+\n+# CLOSE_SESSIONS\n+# LOGIN_STRING\n+# NO_PASSWORD_CONSOLE\n+# QMAIL_DIR\n"}]},{"title":"Set Password Change Minimum Number of Days","desc":"The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 7 or more days.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.1.2_Set_Password_Change_Minimum_Number_of_Days\" do\n  title \"Set Password Change Minimum Number of Days\"\n  desc  \"The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 7 or more days.\"\n  impact 1.0\n  describe file(\"/etc/login.defs\") do\n    its(\"content\") { should match /^\\s*PASS_MIN_DAYS\\s+([7-9]|[1-9][0-9]*)/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1144},"id":"xccdf_org.cisecurity.benchmarks_rule_10.1.2_Set_Password_Change_Minimum_Number_of_Days","results":[{"status":"failed","code_desc":"File /etc/login.defs content should match /^\\s*PASS_MIN_DAYS\\s+([7-9]|[1-9][0-9]*)/","run_time":0.002647698,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"#\\n# /etc/login.defs - Configuration control definitions for the login package.\\n#\\n# Three items mu...###################\\n\\n# CLOSE_SESSIONS\\n# LOGIN_STRING\\n# NO_PASSWORD_CONSOLE\\n# QMAIL_DIR\\n\\n\\n\\n\" to match /^\\s*PASS_MIN_DAYS\\s+([7-9]|[1-9][0-9]*)/\nDiff:\n@@ -1,2 +1,339 @@\n-/^\\s*PASS_MIN_DAYS\\s+([7-9]|[1-9][0-9]*)/\n+#\n+# /etc/login.defs - Configuration control definitions for the login package.\n+#\n+# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n+# If unspecified, some arbitrary (and possibly incorrect) value will\n+# be assumed.  All other items are optional - if not specified then\n+# the described action or option will be inhibited.\n+#\n+# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n+#\n+# Modified for Linux.  --marekm\n+\n+# REQUIRED for useradd/userdel/usermod\n+#   Directory where mailboxes reside, _or_ name of file, relative to the\n+#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n+#   MAIL_DIR takes precedence.\n+#\n+#   Essentially:\n+#      - MAIL_DIR defines the location of users mail spool files\n+#        (for mbox use) by appending the username to MAIL_DIR as defined\n+#        below.\n+#      - MAIL_FILE defines the location of the users mail spool files as the\n+#        fully-qualified filename obtained by prepending the user home\n+#        directory before $MAIL_FILE\n+#\n+# NOTE: This is no more used for setting up users MAIL environment variable\n+#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n+#       job of the pam_mail PAM modules\n+#       See default PAM configuration files provided for\n+#       login, su, etc.\n+#\n+# This is a temporary situation: setting these variables will soon\n+# move to /etc/default/useradd and the variables will then be\n+# no more supported\n+MAIL_DIR        /var/mail\n+#MAIL_FILE      .mail\n+\n+#\n+# Enable logging and display of /var/log/faillog login failure info.\n+# This option conflicts with the pam_tally PAM module.\n+#\n+FAILLOG_ENAB\t\tyes\n+\n+#\n+# Enable display of unknown usernames when login failures are recorded.\n+#\n+# WARNING: Unknown usernames may become world readable. \n+# See #290803 and #298773 for details about how this could become a security\n+# concern\n+LOG_UNKFAIL_ENAB\tno\n+\n+#\n+# Enable logging of successful logins\n+#\n+LOG_OK_LOGINS\t\tno\n+\n+#\n+# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n+# SYSLOG_SG_ENAB does the same for newgrp and sg.\n+#\n+SYSLOG_SU_ENAB\t\tyes\n+SYSLOG_SG_ENAB\t\tyes\n+\n+#\n+# If defined, all su activity is logged to this file.\n+#\n+#SULOG_FILE\t/var/log/sulog\n+\n+#\n+# If defined, file which maps tty line to TERM environment parameter.\n+# Each line of the file is in a format something like \"vt100  tty01\".\n+#\n+#TTYTYPE_FILE\t/etc/ttytype\n+\n+#\n+# If defined, login failures will be logged here in a utmp format\n+# last, when invoked as lastb, will read /var/log/btmp, so...\n+#\n+FTMP_FILE\t/var/log/btmp\n+\n+#\n+# If defined, the command name to display when running \"su -\".  For\n+# example, if this is defined as \"su\" then a \"ps\" will display the\n+# command is \"-su\".  If not defined, then \"ps\" would display the\n+# name of the shell actually being run, e.g. something like \"-sh\".\n+#\n+SU_NAME\t\tsu\n+\n+#\n+# If defined, file which inhibits all the usual chatter during the login\n+# sequence.  If a full pathname, then hushed mode will be enabled if the\n+# user's name or shell are found in the file.  If not a full pathname, then\n+# hushed mode will be enabled if the file exists in the user's home directory.\n+#\n+HUSHLOGIN_FILE\t.hushlogin\n+#HUSHLOGIN_FILE\t/etc/hushlogins\n+\n+#\n+# *REQUIRED*  The default PATH settings, for superuser and normal users.\n+#\n+# (they are minimal, add the rest in the shell startup files)\n+ENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+ENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+\n+#\n+# Terminal permissions\n+#\n+#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n+#\tTTYPERM\t\tLogin tty will be set to this permission.\n+#\n+# If you have a \"write\" program which is \"setgid\" to a special group\n+# which owns the terminals, define TTYGROUP to the group number and\n+# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n+# TTYPERM to either 622 or 600.\n+#\n+# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n+# However, the default and recommended value for TTYPERM is still 0600\n+# to not allow anyone to write to anyone else console or terminal\n+\n+# Users can still allow other people to write them by issuing \n+# the \"mesg y\" command.\n+\n+TTYGROUP\ttty\n+TTYPERM\t\t0600\n+\n+#\n+# Login configuration initializations:\n+#\n+#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n+#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n+#\tUMASK\t\tDefault \"umask\" value.\n+#\n+# The ERASECHAR and KILLCHAR are used only on System V machines.\n+# \n+# UMASK is the default umask value for pam_umask and is used by\n+# useradd and newusers to set the mode of the new home directories.\n+# 022 is the \"historical\" value in Debian for UMASK\n+# 027, or even 077, could be considered better for privacy\n+# There is no One True Answer here : each sysadmin must make up his/her\n+# mind.\n+#\n+# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n+# for private user groups, i. e. the uid is the same as gid, and username is\n+# the same as the primary group name: for these, the user permissions will be\n+# used as group permissions, e. g. 022 will become 002.\n+#\n+# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n+#\n+ERASECHAR\t0177\n+KILLCHAR\t025\n+UMASK\t\t022\n+\n+#\n+# Password aging controls:\n+#\n+#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n+#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n+#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n+#\n+PASS_MAX_DAYS\t99999\n+PASS_MIN_DAYS\t0\n+PASS_WARN_AGE\t7\n+\n+#\n+# Min/max values for automatic uid selection in useradd\n+#\n+UID_MIN\t\t\t 1000\n+UID_MAX\t\t\t60000\n+# System accounts\n+#SYS_UID_MIN\t\t  100\n+#SYS_UID_MAX\t\t  999\n+\n+#\n+# Min/max values for automatic gid selection in groupadd\n+#\n+GID_MIN\t\t\t 1000\n+GID_MAX\t\t\t60000\n+# System accounts\n+#SYS_GID_MIN\t\t  100\n+#SYS_GID_MAX\t\t  999\n+\n+#\n+# Max number of login retries if password is bad. This will most likely be\n+# overriden by PAM, since the default pam_unix module has it's own built\n+# in of 3 retries. However, this is a safe fallback in case you are using\n+# an authentication module that does not enforce PAM_MAXTRIES.\n+#\n+LOGIN_RETRIES\t\t5\n+\n+#\n+# Max time in seconds for login\n+#\n+LOGIN_TIMEOUT\t\t60\n+\n+#\n+# Which fields may be changed by regular users using chfn - use\n+# any combination of letters \"frwh\" (full name, room number, work\n+# phone, home phone).  If not defined, no changes are allowed.\n+# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n+# \n+CHFN_RESTRICT\t\trwh\n+\n+#\n+# Should login be allowed if we can't cd to the home directory?\n+# Default in no.\n+#\n+DEFAULT_HOME\tyes\n+\n+#\n+# If defined, this command is run when removing a user.\n+# It should remove any at/cron/print jobs etc. owned by\n+# the user to be removed (passed as the first argument).\n+#\n+#USERDEL_CMD\t/usr/sbin/userdel_local\n+\n+#\n+# Enable setting of the umask group bits to be the same as owner bits\n+# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n+# the same as gid, and username is the same as the primary group name.\n+#\n+# If set to yes, userdel will remove the users group if it contains no\n+# more members, and useradd will create by default a group with the name\n+# of the user.\n+#\n+USERGROUPS_ENAB yes\n+\n+#\n+# Instead of the real user shell, the program specified by this parameter\n+# will be launched, although its visible name (argv[0]) will be the shell's.\n+# The program may do whatever it wants (logging, additional authentification,\n+# banner, ...) before running the actual shell.\n+#\n+# FAKE_SHELL /bin/fakeshell\n+\n+#\n+# If defined, either full pathname of a file containing device names or\n+# a \":\" delimited list of device names.  Root logins will be allowed only\n+# upon these devices.\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE\t/etc/consoles\n+#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n+\n+#\n+# List of groups to add to the user's supplementary group set\n+# when logging in on the console (as determined by the CONSOLE\n+# setting).  Default is none.\n+#\n+# Use with caution - it is possible for users to gain permanent\n+# access to these groups, even when not logged in on the console.\n+# How to do it is left as an exercise for the reader...\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n+\n+#\n+# If set to \"yes\", new passwords will be encrypted using the MD5-based\n+# algorithm compatible with the one used by recent releases of FreeBSD.\n+# It supports passwords of unlimited length and longer salt strings.\n+# Set to \"no\" if you need to copy encrypted passwords to other systems\n+# which don't understand the new algorithm.  Default is \"no\".\n+#\n+# This variable is deprecated. You should use ENCRYPT_METHOD.\n+#\n+#MD5_CRYPT_ENAB\tno\n+\n+#\n+# If set to MD5 , MD5-based algorithm will be used for encrypting password\n+# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n+# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n+# If set to DES, DES-based algorithm will be used for encrypting password (default)\n+# Overrides the MD5_CRYPT_ENAB option\n+#\n+# Note: It is recommended to use a value consistent with\n+# the PAM modules configuration.\n+#\n+ENCRYPT_METHOD SHA512\n+\n+#\n+# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n+#\n+# Define the number of SHA rounds.\n+# With a lot of rounds, it is more difficult to brute forcing the password.\n+# But note also that it more CPU resources will be needed to authenticate\n+# users.\n+#\n+# If not specified, the libc will choose the default number of rounds (5000).\n+# The values must be inside the 1000-999999999 range.\n+# If only one of the MIN or MAX values is set, then this value will be used.\n+# If MIN > MAX, the highest value will be used.\n+#\n+# SHA_CRYPT_MIN_ROUNDS 5000\n+# SHA_CRYPT_MAX_ROUNDS 5000\n+\n+################# OBSOLETED BY PAM ##############\n+#\t\t\t\t\t\t#\n+# These options are now handled by PAM. Please\t#\n+# edit the appropriate file in /etc/pam.d/ to\t#\n+# enable the equivelants of them.\n+#\n+###############\n+\n+#MOTD_FILE\n+#DIALUPS_CHECK_ENAB\n+#LASTLOG_ENAB\n+#MAIL_CHECK_ENAB\n+#OBSCURE_CHECKS_ENAB\n+#PORTTIME_CHECKS_ENAB\n+#SU_WHEEL_ONLY\n+#CRACKLIB_DICTPATH\n+#PASS_CHANGE_TRIES\n+#PASS_ALWAYS_WARN\n+#ENVIRON_FILE\n+#NOLOGINS_FILE\n+#ISSUE_FILE\n+#PASS_MIN_LEN\n+#PASS_MAX_LEN\n+#ULIMIT\n+#ENV_HZ\n+#CHFN_AUTH\n+#CHSH_AUTH\n+#FAIL_DELAY\n+\n+################# OBSOLETED #######################\n+#\t\t\t\t\t\t  #\n+# These options are no more handled by shadow.    #\n+#                                                 #\n+# Shadow utilities will display a warning if they #\n+# still appear.                                   #\n+#                                                 #\n+###################################################\n+\n+# CLOSE_SESSIONS\n+# LOGIN_STRING\n+# NO_PASSWORD_CONSOLE\n+# QMAIL_DIR\n"}]},{"title":"Set Password Expiring Warning Days","desc":"The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days. It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.1.3_Set_Password_Expiring_Warning_Days\" do\n  title \"Set Password Expiring Warning Days\"\n  desc  \"The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days. It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days.\"\n  impact 1.0\n  describe file(\"/etc/login.defs\") do\n    its(\"content\") { should match /^\\s*PASS_WARN_AGE\\s+([7-9]|[1-9][0-9]+)/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1153},"id":"xccdf_org.cisecurity.benchmarks_rule_10.1.3_Set_Password_Expiring_Warning_Days","results":[{"status":"passed","code_desc":"File /etc/login.defs content should match /^\\s*PASS_WARN_AGE\\s+([7-9]|[1-9][0-9]+)/","run_time":0.000267513,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Disable System Accounts","desc":"There are a number of accounts provided with Ubuntu that are used to manage applications and are not intended to provide an interactive shell.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.2_Disable_System_Accounts\" do\n  title \"Disable System Accounts\"\n  desc  \"There are a number of accounts provided with Ubuntu that are used to manage applications and are not intended to provide an interactive shell.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/passwd | awk -F: '($1!=\\\"root\\\" && $1!=\\\"sync\\\" && $1!=\\\"shutdown\\\" && $1!=\\\"halt\\\" && $3<500 && $7!=\\\"/usr/sbin/nologin\\\" && $7!=\\\"/bin/false\\\") {print}'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1162},"id":"xccdf_org.cisecurity.benchmarks_rule_10.2_Disable_System_Accounts","results":[{"status":"failed","code_desc":"Bash command egrep -v \"^\\+\" /etc/passwd | awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\" && $3<500 && $7!=\"/usr/sbin/nologin\" && $7!=\"/bin/false\") {print}' stdout should not match /.+/","run_time":0.0183695,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"libuuid:x:100:101::/var/lib/libuuid:\\n\" not to match /.+/\nDiff:\n@@ -1,2 +1,2 @@\n-/.+/\n+libuuid:x:100:101::/var/lib/libuuid:\n"}]},{"title":"Set Default Group for root Account","desc":"The usermod command can be used to specify which group the root user belongs to. This affects permissions of files that are created by the root user.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.3_Set_Default_Group_for_root_Account\" do\n  title \"Set Default Group for root Account\"\n  desc  \"The usermod command can be used to specify which group the root user belongs to. This affects permissions of files that are created by the root user.\"\n  impact 1.0\n  describe bash(\"grep \\\"^root:\\\" /etc/passwd | cut -f4 -d:\") do\n    its(\"stdout\") { should match /^0$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1171},"id":"xccdf_org.cisecurity.benchmarks_rule_10.3_Set_Default_Group_for_root_Account","results":[{"status":"passed","code_desc":"Bash command grep \"^root:\" /etc/passwd | cut -f4 -d: stdout should match /^0$/","run_time":0.017229666,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Set Default umask for Users","desc":"The default umask determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files (.profile, .bashrc, etc.) in their home directories.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.4_Set_Default_umask_for_Users\" do\n  title \"Set Default umask for Users\"\n  desc  \"The default umask determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files (.profile, .bashrc, etc.) in their home directories.\"\n  impact 1.0\n  describe file(\"/etc/login.defs\") do\n    its(\"content\") { should match /^UMASK\\s+077$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1180},"id":"xccdf_org.cisecurity.benchmarks_rule_10.4_Set_Default_umask_for_Users","results":[{"status":"failed","code_desc":"File /etc/login.defs content should match /^UMASK\\s+077$/","run_time":0.002528442,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"#\\n# /etc/login.defs - Configuration control definitions for the login package.\\n#\\n# Three items mu...###################\\n\\n# CLOSE_SESSIONS\\n# LOGIN_STRING\\n# NO_PASSWORD_CONSOLE\\n# QMAIL_DIR\\n\\n\\n\\n\" to match /^UMASK\\s+077$/\nDiff:\n@@ -1,2 +1,339 @@\n-/^UMASK\\s+077$/\n+#\n+# /etc/login.defs - Configuration control definitions for the login package.\n+#\n+# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n+# If unspecified, some arbitrary (and possibly incorrect) value will\n+# be assumed.  All other items are optional - if not specified then\n+# the described action or option will be inhibited.\n+#\n+# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n+#\n+# Modified for Linux.  --marekm\n+\n+# REQUIRED for useradd/userdel/usermod\n+#   Directory where mailboxes reside, _or_ name of file, relative to the\n+#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n+#   MAIL_DIR takes precedence.\n+#\n+#   Essentially:\n+#      - MAIL_DIR defines the location of users mail spool files\n+#        (for mbox use) by appending the username to MAIL_DIR as defined\n+#        below.\n+#      - MAIL_FILE defines the location of the users mail spool files as the\n+#        fully-qualified filename obtained by prepending the user home\n+#        directory before $MAIL_FILE\n+#\n+# NOTE: This is no more used for setting up users MAIL environment variable\n+#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n+#       job of the pam_mail PAM modules\n+#       See default PAM configuration files provided for\n+#       login, su, etc.\n+#\n+# This is a temporary situation: setting these variables will soon\n+# move to /etc/default/useradd and the variables will then be\n+# no more supported\n+MAIL_DIR        /var/mail\n+#MAIL_FILE      .mail\n+\n+#\n+# Enable logging and display of /var/log/faillog login failure info.\n+# This option conflicts with the pam_tally PAM module.\n+#\n+FAILLOG_ENAB\t\tyes\n+\n+#\n+# Enable display of unknown usernames when login failures are recorded.\n+#\n+# WARNING: Unknown usernames may become world readable. \n+# See #290803 and #298773 for details about how this could become a security\n+# concern\n+LOG_UNKFAIL_ENAB\tno\n+\n+#\n+# Enable logging of successful logins\n+#\n+LOG_OK_LOGINS\t\tno\n+\n+#\n+# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n+# SYSLOG_SG_ENAB does the same for newgrp and sg.\n+#\n+SYSLOG_SU_ENAB\t\tyes\n+SYSLOG_SG_ENAB\t\tyes\n+\n+#\n+# If defined, all su activity is logged to this file.\n+#\n+#SULOG_FILE\t/var/log/sulog\n+\n+#\n+# If defined, file which maps tty line to TERM environment parameter.\n+# Each line of the file is in a format something like \"vt100  tty01\".\n+#\n+#TTYTYPE_FILE\t/etc/ttytype\n+\n+#\n+# If defined, login failures will be logged here in a utmp format\n+# last, when invoked as lastb, will read /var/log/btmp, so...\n+#\n+FTMP_FILE\t/var/log/btmp\n+\n+#\n+# If defined, the command name to display when running \"su -\".  For\n+# example, if this is defined as \"su\" then a \"ps\" will display the\n+# command is \"-su\".  If not defined, then \"ps\" would display the\n+# name of the shell actually being run, e.g. something like \"-sh\".\n+#\n+SU_NAME\t\tsu\n+\n+#\n+# If defined, file which inhibits all the usual chatter during the login\n+# sequence.  If a full pathname, then hushed mode will be enabled if the\n+# user's name or shell are found in the file.  If not a full pathname, then\n+# hushed mode will be enabled if the file exists in the user's home directory.\n+#\n+HUSHLOGIN_FILE\t.hushlogin\n+#HUSHLOGIN_FILE\t/etc/hushlogins\n+\n+#\n+# *REQUIRED*  The default PATH settings, for superuser and normal users.\n+#\n+# (they are minimal, add the rest in the shell startup files)\n+ENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n+ENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n+\n+#\n+# Terminal permissions\n+#\n+#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n+#\tTTYPERM\t\tLogin tty will be set to this permission.\n+#\n+# If you have a \"write\" program which is \"setgid\" to a special group\n+# which owns the terminals, define TTYGROUP to the group number and\n+# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n+# TTYPERM to either 622 or 600.\n+#\n+# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n+# However, the default and recommended value for TTYPERM is still 0600\n+# to not allow anyone to write to anyone else console or terminal\n+\n+# Users can still allow other people to write them by issuing \n+# the \"mesg y\" command.\n+\n+TTYGROUP\ttty\n+TTYPERM\t\t0600\n+\n+#\n+# Login configuration initializations:\n+#\n+#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n+#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n+#\tUMASK\t\tDefault \"umask\" value.\n+#\n+# The ERASECHAR and KILLCHAR are used only on System V machines.\n+# \n+# UMASK is the default umask value for pam_umask and is used by\n+# useradd and newusers to set the mode of the new home directories.\n+# 022 is the \"historical\" value in Debian for UMASK\n+# 027, or even 077, could be considered better for privacy\n+# There is no One True Answer here : each sysadmin must make up his/her\n+# mind.\n+#\n+# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n+# for private user groups, i. e. the uid is the same as gid, and username is\n+# the same as the primary group name: for these, the user permissions will be\n+# used as group permissions, e. g. 022 will become 002.\n+#\n+# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n+#\n+ERASECHAR\t0177\n+KILLCHAR\t025\n+UMASK\t\t022\n+\n+#\n+# Password aging controls:\n+#\n+#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n+#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n+#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n+#\n+PASS_MAX_DAYS\t99999\n+PASS_MIN_DAYS\t0\n+PASS_WARN_AGE\t7\n+\n+#\n+# Min/max values for automatic uid selection in useradd\n+#\n+UID_MIN\t\t\t 1000\n+UID_MAX\t\t\t60000\n+# System accounts\n+#SYS_UID_MIN\t\t  100\n+#SYS_UID_MAX\t\t  999\n+\n+#\n+# Min/max values for automatic gid selection in groupadd\n+#\n+GID_MIN\t\t\t 1000\n+GID_MAX\t\t\t60000\n+# System accounts\n+#SYS_GID_MIN\t\t  100\n+#SYS_GID_MAX\t\t  999\n+\n+#\n+# Max number of login retries if password is bad. This will most likely be\n+# overriden by PAM, since the default pam_unix module has it's own built\n+# in of 3 retries. However, this is a safe fallback in case you are using\n+# an authentication module that does not enforce PAM_MAXTRIES.\n+#\n+LOGIN_RETRIES\t\t5\n+\n+#\n+# Max time in seconds for login\n+#\n+LOGIN_TIMEOUT\t\t60\n+\n+#\n+# Which fields may be changed by regular users using chfn - use\n+# any combination of letters \"frwh\" (full name, room number, work\n+# phone, home phone).  If not defined, no changes are allowed.\n+# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n+# \n+CHFN_RESTRICT\t\trwh\n+\n+#\n+# Should login be allowed if we can't cd to the home directory?\n+# Default in no.\n+#\n+DEFAULT_HOME\tyes\n+\n+#\n+# If defined, this command is run when removing a user.\n+# It should remove any at/cron/print jobs etc. owned by\n+# the user to be removed (passed as the first argument).\n+#\n+#USERDEL_CMD\t/usr/sbin/userdel_local\n+\n+#\n+# Enable setting of the umask group bits to be the same as owner bits\n+# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n+# the same as gid, and username is the same as the primary group name.\n+#\n+# If set to yes, userdel will remove the users group if it contains no\n+# more members, and useradd will create by default a group with the name\n+# of the user.\n+#\n+USERGROUPS_ENAB yes\n+\n+#\n+# Instead of the real user shell, the program specified by this parameter\n+# will be launched, although its visible name (argv[0]) will be the shell's.\n+# The program may do whatever it wants (logging, additional authentification,\n+# banner, ...) before running the actual shell.\n+#\n+# FAKE_SHELL /bin/fakeshell\n+\n+#\n+# If defined, either full pathname of a file containing device names or\n+# a \":\" delimited list of device names.  Root logins will be allowed only\n+# upon these devices.\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE\t/etc/consoles\n+#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n+\n+#\n+# List of groups to add to the user's supplementary group set\n+# when logging in on the console (as determined by the CONSOLE\n+# setting).  Default is none.\n+#\n+# Use with caution - it is possible for users to gain permanent\n+# access to these groups, even when not logged in on the console.\n+# How to do it is left as an exercise for the reader...\n+#\n+# This variable is used by login and su.\n+#\n+#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n+\n+#\n+# If set to \"yes\", new passwords will be encrypted using the MD5-based\n+# algorithm compatible with the one used by recent releases of FreeBSD.\n+# It supports passwords of unlimited length and longer salt strings.\n+# Set to \"no\" if you need to copy encrypted passwords to other systems\n+# which don't understand the new algorithm.  Default is \"no\".\n+#\n+# This variable is deprecated. You should use ENCRYPT_METHOD.\n+#\n+#MD5_CRYPT_ENAB\tno\n+\n+#\n+# If set to MD5 , MD5-based algorithm will be used for encrypting password\n+# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n+# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n+# If set to DES, DES-based algorithm will be used for encrypting password (default)\n+# Overrides the MD5_CRYPT_ENAB option\n+#\n+# Note: It is recommended to use a value consistent with\n+# the PAM modules configuration.\n+#\n+ENCRYPT_METHOD SHA512\n+\n+#\n+# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n+#\n+# Define the number of SHA rounds.\n+# With a lot of rounds, it is more difficult to brute forcing the password.\n+# But note also that it more CPU resources will be needed to authenticate\n+# users.\n+#\n+# If not specified, the libc will choose the default number of rounds (5000).\n+# The values must be inside the 1000-999999999 range.\n+# If only one of the MIN or MAX values is set, then this value will be used.\n+# If MIN > MAX, the highest value will be used.\n+#\n+# SHA_CRYPT_MIN_ROUNDS 5000\n+# SHA_CRYPT_MAX_ROUNDS 5000\n+\n+################# OBSOLETED BY PAM ##############\n+#\t\t\t\t\t\t#\n+# These options are now handled by PAM. Please\t#\n+# edit the appropriate file in /etc/pam.d/ to\t#\n+# enable the equivelants of them.\n+#\n+###############\n+\n+#MOTD_FILE\n+#DIALUPS_CHECK_ENAB\n+#LASTLOG_ENAB\n+#MAIL_CHECK_ENAB\n+#OBSCURE_CHECKS_ENAB\n+#PORTTIME_CHECKS_ENAB\n+#SU_WHEEL_ONLY\n+#CRACKLIB_DICTPATH\n+#PASS_CHANGE_TRIES\n+#PASS_ALWAYS_WARN\n+#ENVIRON_FILE\n+#NOLOGINS_FILE\n+#ISSUE_FILE\n+#PASS_MIN_LEN\n+#PASS_MAX_LEN\n+#ULIMIT\n+#ENV_HZ\n+#CHFN_AUTH\n+#CHSH_AUTH\n+#FAIL_DELAY\n+\n+################# OBSOLETED #######################\n+#\t\t\t\t\t\t  #\n+# These options are no more handled by shadow.    #\n+#                                                 #\n+# Shadow utilities will display a warning if they #\n+# still appear.                                   #\n+#                                                 #\n+###################################################\n+\n+# CLOSE_SESSIONS\n+# LOGIN_STRING\n+# NO_PASSWORD_CONSOLE\n+# QMAIL_DIR\n"}]},{"title":"Lock Inactive User Accounts","desc":"User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 35 or more days be disabled.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_10.5_Lock_Inactive_User_Accounts\" do\n  title \"Lock Inactive User Accounts\"\n  desc  \"User accounts that have been inactive for over a given period of time can be automatically disabled. It is recommended that accounts that are inactive for 35 or more days be disabled.\"\n  impact 1.0\n  describe bash(\"useradd -D | grep INACTIVE\") do\n    its(\"stdout\") { should match /^INACTIVE=35$/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1189},"id":"xccdf_org.cisecurity.benchmarks_rule_10.5_Lock_Inactive_User_Accounts","results":[{"status":"failed","code_desc":"Bash command useradd -D | grep INACTIVE stdout should match /^INACTIVE=35$/","run_time":0.026669616,"start_time":"2017-06-21 19:45:50 +0000","message":"expected \"INACTIVE=-1\\n\" to match /^INACTIVE=35$/\nDiff:\n@@ -1,2 +1,2 @@\n-/^INACTIVE=35$/\n+INACTIVE=-1\n"}]},{"title":"Set Warning Banner for Standard Login Services","desc":"The contents of the /etc/issue file are displayed prior to the login prompt on the system's console and serial devices, and also prior to logins via telnet. The contents of the /etc/motd file is generally displayed after all successful logins, no matter where the user is logging in from, but is thought to be less useful because it only provides notification to the user after the machine has been accessed.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_11.1_Set_Warning_Banner_for_Standard_Login_Services\" do\n  title \"Set Warning Banner for Standard Login Services\"\n  desc  \"The contents of the /etc/issue file are displayed prior to the login prompt on the system's console and serial devices, and also prior to logins via telnet. The contents of the /etc/motd file is generally displayed after all successful logins, no matter where the user is logging in from, but is thought to be less useful because it only provides notification to the user after the machine has been accessed.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/motd | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/issue | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/issue.net | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\n  describe file(\"/etc/issue\") do\n    its(\"content\") { should match /.+/ }\n  end\n  describe file(\"/etc/issue.net\") do\n    its(\"content\") { should match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1198},"id":"xccdf_org.cisecurity.benchmarks_rule_11.1_Set_Warning_Banner_for_Standard_Login_Services","results":[{"status":"failed","code_desc":"should eq \"0000\"","run_time":0.000181646,"start_time":"2017-06-21 19:45:50 +0000","message":"\nexpected: \"0000\"\n     got: nil\n\n(compared using ==)\n"},{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":0.000148402,"start_time":"2017-06-21 19:45:50 +0000"},{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":8.1032e-05,"start_time":"2017-06-21 19:45:50 +0000"},{"status":"passed","code_desc":"File /etc/issue content should match /.+/","run_time":0.000152074,"start_time":"2017-06-21 19:45:50 +0000"},{"status":"passed","code_desc":"File /etc/issue.net content should match /.+/","run_time":0.000203265,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Remove OS Information from Login Warning Banners","desc":"Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information:  \\m - machine architecture (uname -m) \\r - operating system release (uname -r) \\s - operating system name \\v - operating system version (uname -v)","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_11.2_Remove_OS_Information_from_Login_Warning_Banners\" do\n  title \"Remove OS Information from Login Warning Banners\"\n  desc  \"Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information:  \\\\m - machine architecture (uname -m) \\\\r - operating system release (uname -r) \\\\s - operating system name \\\\v - operating system version (uname -v)\"\n  impact 1.0\n  describe file(\"/etc/motd\") do\n    its(\"content\") { should_not match /(\\\\v|\\\\r|\\\\m|\\\\s)/ }\n  end\n  describe file(\"/etc/issue\") do\n    its(\"content\") { should_not match /(\\\\v|\\\\r|\\\\m|\\\\s)/ }\n  end\n  describe file(\"/etc/issue.net\") do\n    its(\"content\") { should_not match /(\\\\v|\\\\r|\\\\m|\\\\s)/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1219},"id":"xccdf_org.cisecurity.benchmarks_rule_11.2_Remove_OS_Information_from_Login_Warning_Banners","results":[{"status":"passed","code_desc":"File /etc/motd content should not match /(\\\\v|\\\\r|\\\\m|\\\\s)/","run_time":0.000129536,"start_time":"2017-06-21 19:45:50 +0000"},{"status":"passed","code_desc":"File /etc/issue content should not match /(\\\\v|\\\\r|\\\\m|\\\\s)/","run_time":0.000106877,"start_time":"2017-06-21 19:45:50 +0000"},{"status":"passed","code_desc":"File /etc/issue.net content should not match /(\\\\v|\\\\r|\\\\m|\\\\s)/","run_time":0.000150339,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Set Graphical Warning Banner","desc":"Ubuntu defaults to using lightdm for graphical login session management which provides no built in banner setting. The GNOME Display Manager and KDM are both available but must be manually installed.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_11.3_Set_Graphical_Warning_Banner\" do\n  title \"Set Graphical Warning Banner\"\n  desc  \"Ubuntu defaults to using lightdm for graphical login session management which provides no built in banner setting. The GNOME Display Manager and KDM are both available but must be manually installed.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1234},"id":"xccdf_org.cisecurity.benchmarks_rule_11.3_Set_Graphical_Warning_Banner"},{"title":"Verify Permissions on /etc/passwd","desc":"The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.1_Verify_Permissions_on_etcpasswd\" do\n  title \"Verify Permissions on /etc/passwd\"\n  desc  \"The /etc/passwd file contains user account information that is used by many system utilities and therefore must be readable for these utilities to operate.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/passwd | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1240},"id":"xccdf_org.cisecurity.benchmarks_rule_12.1_Verify_Permissions_on_etcpasswd","results":[{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":8.9038e-05,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Verify Permissions on /etc/shadow","desc":"The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.2_Verify_Permissions_on_etcshadow\" do\n  title \"Verify Permissions on /etc/shadow\"\n  desc  \"The /etc/shadow file is used to store the information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0037 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/shadow | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1249},"id":"xccdf_org.cisecurity.benchmarks_rule_12.2_Verify_Permissions_on_etcshadow","results":[{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":8.0998e-05,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Verify Permissions on /etc/group","desc":"The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.3_Verify_Permissions_on_etcgroup\" do\n  title \"Verify Permissions on /etc/group\"\n  desc  \"The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.\"\n  impact 1.0\n  describe bash(\"ui=($(echo 0022 -n | fold -w1));sys=($(stat -L --format=\\\"%a\\\" /etc/group | awk '{printf \\\"%04d\\\\n\\\", $0;}' | fold -w1));for (( i=0; i<4; i++ )); do echo -n $(( ${ui[$i]} & ${sys[$i]})); done;\").stdout.to_s.[](/^(\\d+)$/, 1) do\n    it { should eq \"0000\" }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1258},"id":"xccdf_org.cisecurity.benchmarks_rule_12.3_Verify_Permissions_on_etcgroup","results":[{"status":"passed","code_desc":"0000 should eq \"0000\"","run_time":0.000102229,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Verify User/Group Ownership on /etc/passwd","desc":"The /etc/passwd file contains a list of all the valid userIDs defined in the system, but not the passwords. The command below sets the owner and group of the file to root.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.4_Verify_UserGroup_Ownership_on_etcpasswd\" do\n  title \"Verify User/Group Ownership on /etc/passwd\"\n  desc  \"The /etc/passwd file contains a list of all the valid userIDs defined in the system, but not the passwords. The command below sets the owner and group of the file to root.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/passwd\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1267},"id":"xccdf_org.cisecurity.benchmarks_rule_12.4_Verify_UserGroup_Ownership_on_etcpasswd","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/passwd stdout should match /0 0/","run_time":0.017049102,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Verify User/Group Ownership on /etc/shadow","desc":"The /etc/shadow file contains the one-way cipher text passwords for each user defined in the /etc/passwd file. The command below sets the user and group ownership of the file to root.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.5_Verify_UserGroup_Ownership_on_etcshadow\" do\n  title \"Verify User/Group Ownership on /etc/shadow\"\n  desc  \"The /etc/shadow file contains the one-way cipher text passwords for each user defined in the /etc/passwd file. The command below sets the user and group ownership of the file to root.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/shadow\") do\n    its(\"stdout\") { should match /0 (0|42)/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1276},"id":"xccdf_org.cisecurity.benchmarks_rule_12.5_Verify_UserGroup_Ownership_on_etcshadow","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/shadow stdout should match /0 (0|42)/","run_time":0.016556556,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Verify User/Group Ownership on /etc/group","desc":"The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.6_Verify_UserGroup_Ownership_on_etcgroup\" do\n  title \"Verify User/Group Ownership on /etc/group\"\n  desc  \"The /etc/group file contains a list of all the valid groups defined in the system. The command below allows read/write access for root and read access for everyone else.\"\n  impact 1.0\n  describe bash(\"stat -c \\\"%u %g\\\" /etc/group\") do\n    its(\"stdout\") { should match /0 0/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1285},"id":"xccdf_org.cisecurity.benchmarks_rule_12.6_Verify_UserGroup_Ownership_on_etcgroup","results":[{"status":"passed","code_desc":"Bash command stat -c \"%u %g\" /etc/group stdout should match /0 0/","run_time":0.016530901,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Find World Writable Files","desc":"Unix-based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.7_Find_World_Writable_Files\" do\n  title \"Find World Writable Files\"\n  desc  \"Unix-based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.\"\n  impact 0.0\n  describe bash(\"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1294},"id":"xccdf_org.cisecurity.benchmarks_rule_12.7_Find_World_Writable_Files","results":[{"status":"passed","code_desc":"Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print stdout should not match /.+/","run_time":0.138232398,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Find Un-owned Files and Directories","desc":"Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.8_Find_Un-owned_Files_and_Directories\" do\n  title \"Find Un-owned Files and Directories\"\n  desc  \"Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.\"\n  impact 1.0\n  describe bash(\"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1303},"id":"xccdf_org.cisecurity.benchmarks_rule_12.8_Find_Un-owned_Files_and_Directories","results":[{"status":"passed","code_desc":"Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls stdout should not match /.+/","run_time":0.551060277,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Find Un-grouped Files and Directories","desc":"Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.9_Find_Un-grouped_Files_and_Directories\" do\n  title \"Find Un-grouped Files and Directories\"\n  desc  \"Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.\"\n  impact 1.0\n  describe bash(\"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup -ls\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1312},"id":"xccdf_org.cisecurity.benchmarks_rule_12.9_Find_Un-grouped_Files_and_Directories","results":[{"status":"passed","code_desc":"Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup -ls stdout should not match /.+/","run_time":0.574648476,"start_time":"2017-06-21 19:45:50 +0000"}]},{"title":"Find SUID System Executables","desc":"The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID program is to enable users to perform functions (such as changing their password) that require root privileges.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.10_Find_SUID_System_Executables\" do\n  title \"Find SUID System Executables\"\n  desc  \"The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID program is to enable users to perform functions (such as changing their password) that require root privileges.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1321},"id":"xccdf_org.cisecurity.benchmarks_rule_12.10_Find_SUID_System_Executables"},{"title":"Find SGID System Executables","desc":"The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SGID program is to enable users to perform functions (such as changing their password) that require root privileges.","impact":0.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_12.11_Find_SGID_System_Executables\" do\n  title \"Find SGID System Executables\"\n  desc  \"The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SGID program is to enable users to perform functions (such as changing their password) that require root privileges.\"\n  impact 0.0\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1327},"id":"xccdf_org.cisecurity.benchmarks_rule_12.11_Find_SGID_System_Executables"},{"title":"Ensure Password Fields are Not Empty","desc":"An account with an empty password field means that anybody may log in as that user without providing a password.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.1_Ensure_Password_Fields_are_Not_Empty\" do\n  title \"Ensure Password Fields are Not Empty\"\n  desc  \"An account with an empty password field means that anybody may log in as that user without providing a password.\"\n  impact 1.0\n  describe bash(\"cat /etc/shadow | awk -F: '($2 == \\\"\\\" ) { print $1 \\\" does not have a password \\\"}'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1333},"id":"xccdf_org.cisecurity.benchmarks_rule_13.1_Ensure_Password_Fields_are_Not_Empty","results":[{"status":"passed","code_desc":"Bash command cat /etc/shadow | awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' stdout should not match /.+/","run_time":0.021342531,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Verify No Legacy \"+\" Entries Exist in /etc/passwd File","desc":"The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on most systems, but may exist in files that have been imported from other platforms.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.2_Verify_No_Legacy__Entries_Exist_in_etcpasswd_File\" do\n  title \"Verify No Legacy \\\"+\\\" Entries Exist in /etc/passwd File\"\n  desc  \"The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on most systems, but may exist in files that have been imported from other platforms.\"\n  impact 1.0\n  describe file(\"/etc/passwd\") do\n    its(\"content\") { should_not match /^\\+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1342},"id":"xccdf_org.cisecurity.benchmarks_rule_13.2_Verify_No_Legacy__Entries_Exist_in_etcpasswd_File","results":[{"status":"passed","code_desc":"File /etc/passwd content should not match /^\\+/","run_time":0.000277829,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Verify No Legacy \"+\" Entries Exist in /etc/shadow File","desc":"The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on most systems, but may exist in files that have been imported from other platforms.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.3_Verify_No_Legacy__Entries_Exist_in_etcshadow_File\" do\n  title \"Verify No Legacy \\\"+\\\" Entries Exist in /etc/shadow File\"\n  desc  \"The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on most systems, but may exist in files that have been imported from other platforms.\"\n  impact 1.0\n  describe file(\"/etc/shadow\") do\n    its(\"content\") { should_not match /^\\+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1351},"id":"xccdf_org.cisecurity.benchmarks_rule_13.3_Verify_No_Legacy__Entries_Exist_in_etcshadow_File","results":[{"status":"passed","code_desc":"File /etc/shadow content should not match /^\\+/","run_time":0.000141659,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Verify No Legacy \"+\" Entries Exist in /etc/group File","desc":"The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on most systems, but may exist in files that have been imported from other platforms.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.4_Verify_No_Legacy__Entries_Exist_in_etcgroup_File\" do\n  title \"Verify No Legacy \\\"+\\\" Entries Exist in /etc/group File\"\n  desc  \"The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on most systems, but may exist in files that have been imported from other platforms.\"\n  impact 1.0\n  describe file(\"/etc/group\") do\n    its(\"content\") { should_not match /^\\+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1360},"id":"xccdf_org.cisecurity.benchmarks_rule_13.4_Verify_No_Legacy__Entries_Exist_in_etcgroup_File","results":[{"status":"passed","code_desc":"File /etc/group content should not match /^\\+/","run_time":0.000136002,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Verify No UID 0 Accounts Exist Other Than root","desc":"Any account with UID 0 has superuser privileges on the system.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.5_Verify_No_UID_0_Accounts_Exist_Other_Than_root\" do\n  title \"Verify No UID 0 Accounts Exist Other Than root\"\n  desc  \"Any account with UID 0 has superuser privileges on the system.\"\n  impact 1.0\n  describe bash(\"/bin/cat /etc/passwd | /bin/awk -F: '($3 == 0) { print $1 }' | grep -v 'root'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1369},"id":"xccdf_org.cisecurity.benchmarks_rule_13.5_Verify_No_UID_0_Accounts_Exist_Other_Than_root","results":[{"status":"passed","code_desc":"Bash command /bin/cat /etc/passwd | /bin/awk -F: '($3 == 0) { print $1 }' | grep -v 'root' stdout should not match /.+/","run_time":0.021532224,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Ensure root PATH Integrity","desc":"The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.6_Ensure_root_PATH_Integrity\" do\n  title \"Ensure root PATH Integrity\"\n  desc  \"The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly.\"\n  impact 1.0\n  describe bash(\"echo $PATH\") do\n    its(\"stdout\") { should_not match /(^|:):/ }\n  end\n  describe bash(\"echo $PATH\") do\n    its(\"stdout\") { should_not match /:$/ }\n  end\n  describe bash(\"echo $PATH\") do\n    its(\"stdout\") { should_not match /(^|:|\\/)\\.+($|:|\\/)/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1378},"id":"xccdf_org.cisecurity.benchmarks_rule_13.6_Ensure_root_PATH_Integrity","results":[{"status":"passed","code_desc":"Bash command echo $PATH stdout should not match /(^|:):/","run_time":0.017545827,"start_time":"2017-06-21 19:45:51 +0000"},{"status":"passed","code_desc":"Bash command echo $PATH stdout should not match /:$/","run_time":0.016354051,"start_time":"2017-06-21 19:45:51 +0000"},{"status":"passed","code_desc":"Bash command echo $PATH stdout should not match /(^|:|\\/)\\.+($|:|\\/)/","run_time":0.016155909,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check Permissions on User Home Directories","desc":"While the system administrator can establish secure permissions for users' home directories, the users can easily override these.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.7_Check_Permissions_on_User_Home_Directories\" do\n  title \"Check Permissions on User Home Directories\"\n  desc  \"While the system administrator can establish secure permissions for users' home directories, the users can easily override these.\"\n  impact 1.0\n  describe bash(\"for i in $(awk -F: '($7 != \\\"/usr/sbin/nologin\\\" && $3 >= 500) {print $6}' /etc/passwd | sort -u); do echo $i $(stat -L --format=%a $i) | grep -v ' .[0145][0145]$';done\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1393},"id":"xccdf_org.cisecurity.benchmarks_rule_13.7_Check_Permissions_on_User_Home_Directories","results":[{"status":"passed","code_desc":"Bash command for i in $(awk -F: '($7 != \"/usr/sbin/nologin\" && $3 >= 500) {print $6}' /etc/passwd | sort -u); do echo $i $(stat -L --format=%a $i) | grep -v ' .[0145][0145]$';done stdout should not match /.+/","run_time":0.02324721,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check User Dot File Permissions","desc":"While the system administrator can establish secure permissions for users' \"dot\" files, the users can easily override these.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.8_Check_User_Dot_File_Permissions\" do\n  title \"Check User Dot File Permissions\"\n  desc  \"While the system administrator can establish secure permissions for users' \\\"dot\\\" files, the users can easily override these.\"\n  impact 1.0\n  describe bash(\"find `cat /etc/passwd | egrep -v \\\"root|sync|halt|shutdown\\\" | awk -F: '($7 != \\\"/usr/sbin/nologin\\\" && $7) {print $6}' | sort | uniq | grep -v \\\"^/$\\\"` -name \\\".*\\\" -perm /go+w -follow\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1402},"id":"xccdf_org.cisecurity.benchmarks_rule_13.8_Check_User_Dot_File_Permissions","results":[{"status":"passed","code_desc":"Bash command find `cat /etc/passwd | egrep -v \"root|sync|halt|shutdown\" | awk -F: '($7 != \"/usr/sbin/nologin\" && $7) {print $6}' | sort | uniq | grep -v \"^/$\"` -name \".*\" -perm /go+w -follow stdout should not match /.+/","run_time":0.022035014,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check Permissions on User .netrc Files","desc":"While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.9_Check_Permissions_on_User_.netrc_Files\" do\n  title \"Check Permissions on User .netrc Files\"\n  desc  \"While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these.\"\n  impact 1.0\n  describe bash(\"find `cat /etc/passwd | egrep -v \\\"root|sync|halt|shutdown\\\" | awk -F: '($7 != \\\"/usr/sbin/nologin\\\" && $7) {print $6}' | sort | uniq | grep -v \\\"^/$\\\"` -name \\\".netrc\\\" -perm /go+w\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1411},"id":"xccdf_org.cisecurity.benchmarks_rule_13.9_Check_Permissions_on_User_.netrc_Files","results":[{"status":"passed","code_desc":"Bash command find `cat /etc/passwd | egrep -v \"root|sync|halt|shutdown\" | awk -F: '($7 != \"/usr/sbin/nologin\" && $7) {print $6}' | sort | uniq | grep -v \"^/$\"` -name \".netrc\" -perm /go+w stdout should not match /.+/","run_time":0.018934208,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Presence of User .rhosts Files","desc":"While no .rhosts files are shipped by default, users can easily create them.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.10_Check_for_Presence_of_User_.rhosts_Files\" do\n  title \"Check for Presence of User .rhosts Files\"\n  desc  \"While no .rhosts files are shipped by default, users can easily create them.\"\n  impact 1.0\n  describe bash(\"cut -f6 -d: /etc/passwd | sort -u | while read DIR; do ls $DIR/.rhosts 2>/dev/null; done\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1420},"id":"xccdf_org.cisecurity.benchmarks_rule_13.10_Check_for_Presence_of_User_.rhosts_Files","results":[{"status":"passed","code_desc":"Bash command cut -f6 -d: /etc/passwd | sort -u | while read DIR; do ls $DIR/.rhosts 2>/dev/null; done stdout should not match /.+/","run_time":0.037978212,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check Groups in /etc/passwd","desc":"Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.11_Check_Groups_in_etcpasswd\" do\n  title \"Check Groups in /etc/passwd\"\n  desc  \"Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group.\"\n  impact 1.0\n  describe bash(\"for i in $(cut -s -d: -f4 /etc/passwd | sort -u ); do grep -q -P \\\"^.*?:[^:]*:$i:\\\" /etc/group; if [ $? -ne 0 ]; then echo \\\"Group $i is referenced by /etc/passwd but does not exist in /etc/group\\\"; fi; done\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1429},"id":"xccdf_org.cisecurity.benchmarks_rule_13.11_Check_Groups_in_etcpasswd","results":[{"status":"passed","code_desc":"Bash command for i in $(cut -s -d: -f4 /etc/passwd | sort -u ); do grep -q -P \"^.*?:[^:]*:$i:\" /etc/group; if [ $? -ne 0 ]; then echo \"Group $i is referenced by /etc/passwd but does not exist in /etc/group\"; fi; done stdout should not match /.+/","run_time":0.033410938,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check That Users Are Assigned Valid Home Directories","desc":"Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.12_Check_That_Users_Are_Assigned_Valid_Home_Directories\" do\n  title \"Check That Users Are Assigned Valid Home Directories\"\n  desc  \"Users can be defined in /etc/passwd without a home directory or with a home directory that does not actually exist.\"\n  impact 1.0\n  describe bash(\" cat /etc/passwd | awk -F: '{ print $1 \\\" \\\" $3 \\\" \\\" $6 }' | while read user uid dir; do if [ $uid -ge 500 -a ! -d \\\"$dir\\\" -a $user != \\\"nfsnobody\\\" -a $user != \\\"nobody\\\" ]; then echo \\\"The home directory ($dir) of user $user does not exist.\\\"; fi; done\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1438},"id":"xccdf_org.cisecurity.benchmarks_rule_13.12_Check_That_Users_Are_Assigned_Valid_Home_Directories","results":[{"status":"passed","code_desc":"Bash command  cat /etc/passwd | awk -F: '{ print $1 \" \" $3 \" \" $6 }' | while read user uid dir; do if [ $uid -ge 500 -a ! -d \"$dir\" -a $user != \"nfsnobody\" -a $user != \"nobody\" ]; then echo \"The home directory ($dir) of user $user does not exist.\"; fi; done stdout should not match /.+/","run_time":0.017435491,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check User Home Directory Ownership","desc":"The user home directory is space defined for the particular user to set local environment variables and to store personal files.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.13_Check_User_Home_Directory_Ownership\" do\n  title \"Check User Home Directory Ownership\"\n  desc  \"The user home directory is space defined for the particular user to set local environment variables and to store personal files.\"\n  impact 1.0\n  describe bash(\"cat /etc/passwd | awk -F: '{ print $1 \\\" \\\" $3 \\\" \\\" $6 }' | while read user uid dir; do if [ $uid -ge 500 -a -d \\\"$dir\\\" -a $user != \\\"nfsnobody\\\" -a $user != \\\"nobody\\\" ]; then owner=$(stat -L -c \\\"%U\\\" \\\"$dir\\\"); if [ \\\"$owner\\\" != \\\"$user\\\" ]; then echo \\\"The home directory ($dir) of user $user is owned by $owner.\\\"; fi; fi; done;\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1447},"id":"xccdf_org.cisecurity.benchmarks_rule_13.13_Check_User_Home_Directory_Ownership","results":[{"status":"passed","code_desc":"Bash command cat /etc/passwd | awk -F: '{ print $1 \" \" $3 \" \" $6 }' | while read user uid dir; do if [ $uid -ge 500 -a -d \"$dir\" -a $user != \"nfsnobody\" -a $user != \"nobody\" ]; then owner=$(stat -L -c \"%U\" \"$dir\"); if [ \"$owner\" != \"$user\" ]; then echo \"The home directory ($dir) of user $user is owned by $owner.\"; fi; fi; done; stdout should not match /.+/","run_time":0.01996999,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Duplicate UIDs","desc":"Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.14_Check_for_Duplicate_UIDs\" do\n  title \"Check for Duplicate UIDs\"\n  desc  \"Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/passwd | cut -f3 -d\\\":\\\" | sort -n | uniq -c | awk '{ if ($1 != 1) { print \\\"Duplicate UID found: \\\" $2 } }'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1456},"id":"xccdf_org.cisecurity.benchmarks_rule_13.14_Check_for_Duplicate_UIDs","results":[{"status":"passed","code_desc":"Bash command egrep -v \"^\\+\" /etc/passwd | cut -f3 -d\":\" | sort -n | uniq -c | awk '{ if ($1 != 1) { print \"Duplicate UID found: \" $2 } }' stdout should not match /.+/","run_time":0.017115411,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Duplicate GIDs","desc":"Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.15_Check_for_Duplicate_GIDs\" do\n  title \"Check for Duplicate GIDs\"\n  desc  \"Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/group | cut -f3 -d\\\":\\\" | sort -n | uniq -c | awk '{ if ($1 != 1) { print \\\"Duplicate GUID found: \\\" $2 } }'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1465},"id":"xccdf_org.cisecurity.benchmarks_rule_13.15_Check_for_Duplicate_GIDs","results":[{"status":"passed","code_desc":"Bash command egrep -v \"^\\+\" /etc/group | cut -f3 -d\":\" | sort -n | uniq -c | awk '{ if ($1 != 1) { print \"Duplicate GUID found: \" $2 } }' stdout should not match /.+/","run_time":0.017715721,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Duplicate User Names","desc":"Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the user name.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.16_Check_for_Duplicate_User_Names\" do\n  title \"Check for Duplicate User Names\"\n  desc  \"Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the user name.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/passwd | cut -f1 -d\\\":\\\" | sort | uniq -c | awk '{ if ($1 != 1) { print \\\"Duplicate User name Found: \\\" $2 } }'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1474},"id":"xccdf_org.cisecurity.benchmarks_rule_13.16_Check_for_Duplicate_User_Names","results":[{"status":"passed","code_desc":"Bash command egrep -v \"^\\+\" /etc/passwd | cut -f1 -d\":\" | sort | uniq -c | awk '{ if ($1 != 1) { print \"Duplicate User name Found: \" $2 } }' stdout should not match /.+/","run_time":0.018949583,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Duplicate Group Names","desc":"Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.17_Check_for_Duplicate_Group_Names\" do\n  title \"Check for Duplicate Group Names\"\n  desc  \"Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/group | cut -f1 -d\\\":\\\" | sort -n | uniq -c | awk '{ if ($1 != 1) { print \\\"Duplicate Group name Found: \\\" $2 } }'\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1483},"id":"xccdf_org.cisecurity.benchmarks_rule_13.17_Check_for_Duplicate_Group_Names","results":[{"status":"passed","code_desc":"Bash command egrep -v \"^\\+\" /etc/group | cut -f1 -d\":\" | sort -n | uniq -c | awk '{ if ($1 != 1) { print \"Duplicate Group name Found: \" $2 } }' stdout should not match /.+/","run_time":0.018278012,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Presence of User .netrc Files","desc":"The .netrc file contains data for logging into a remote host for file transfers via FTP.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.18_Check_for_Presence_of_User_.netrc_Files\" do\n  title \"Check for Presence of User .netrc Files\"\n  desc  \"The .netrc file contains data for logging into a remote host for file transfers via FTP.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/passwd | cut -f6 -d: | sort -u | while read DIR; do ls $DIR/.netrc 2>/dev/null; done\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1492},"id":"xccdf_org.cisecurity.benchmarks_rule_13.18_Check_for_Presence_of_User_.netrc_Files","results":[{"status":"passed","code_desc":"Bash command egrep -v \"^\\+\" /etc/passwd | cut -f6 -d: | sort -u | while read DIR; do ls $DIR/.netrc 2>/dev/null; done stdout should not match /.+/","run_time":0.038774007,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Check for Presence of User .forward Files","desc":"The .forward file specifies an email address to forward the user's mail to.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.19_Check_for_Presence_of_User_.forward_Files\" do\n  title \"Check for Presence of User .forward Files\"\n  desc  \"The .forward file specifies an email address to forward the user's mail to.\"\n  impact 1.0\n  describe bash(\"egrep -v \\\"^\\\\+\\\" /etc/passwd | cut -f6 -d: | sort -u | while read D; do ls $D/.forward 2&gt;/dev/null; done\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1501},"id":"xccdf_org.cisecurity.benchmarks_rule_13.19_Check_for_Presence_of_User_.forward_Files","results":[{"status":"passed","code_desc":"Bash command egrep -v \"^\\+\" /etc/passwd | cut -f6 -d: | sort -u | while read D; do ls $D/.forward 2&gt;/dev/null; done stdout should not match /.+/","run_time":0.04057817,"start_time":"2017-06-21 19:45:51 +0000"}]},{"title":"Ensure shadow group is empty","desc":"The shadow group allows system programs which require access the ability to read the /etc/shadow file. No users should be assigned to the shadow group.","impact":1.0,"refs":[],"tags":{},"code":"control \"xccdf_org.cisecurity.benchmarks_rule_13.20_Ensure_shadow_group_is_empty\" do\n  title \"Ensure shadow group is empty\"\n  desc  \"The shadow group allows system programs which require access the ability to read the /etc/shadow file. No users should be assigned to the shadow group.\"\n  impact 1.0\n  describe file(\"/etc/group\") do\n    its(\"content\") { should_not match /^shadow:x:15:.+$/ }\n  end\n  describe bash(\"awk -F: '($4 == \\\"42\\\") { print }' /etc/passwd\") do\n    its(\"stdout\") { should_not match /.+/ }\n  end\nend\n","source_location":{"ref":"cis/cis-ubuntu14.04lts-level1/controls/translated-controls.rb","line":1510},"id":"xccdf_org.cisecurity.benchmarks_rule_13.20_Ensure_shadow_group_is_empty","results":[{"status":"passed","code_desc":"File /etc/group content should not match /^shadow:x:15:.+$/","run_time":0.000172931,"start_time":"2017-06-21 19:45:51 +0000"},{"status":"passed","code_desc":"Bash command awk -F: '($4 == \"42\") { print }' /etc/passwd stdout should not match /.+/","run_time":0.017152338,"start_time":"2017-06-21 19:45:51 +0000"}]}],"groups":[{"title":null,"controls":["xccdf_org.cisecurity.benchmarks_rule_1.1_Install_Updates_Patches_and_Additional_Security_Software","xccdf_org.cisecurity.benchmarks_rule_2.1_Create_Separate_Partition_for_tmp","xccdf_org.cisecurity.benchmarks_rule_2.2_Set_nodev_option_for_tmp_Partition","xccdf_org.cisecurity.benchmarks_rule_2.3_Set_nosuid_option_for_tmp_Partition","xccdf_org.cisecurity.benchmarks_rule_2.4_Set_noexec_option_for_tmp_Partition","xccdf_org.cisecurity.benchmarks_rule_2.5_Create_Separate_Partition_for_var","xccdf_org.cisecurity.benchmarks_rule_2.6_Bind_Mount_the_vartmp_directory_to_tmp","xccdf_org.cisecurity.benchmarks_rule_2.7_Create_Separate_Partition_for_varlog","xccdf_org.cisecurity.benchmarks_rule_2.8_Create_Separate_Partition_for_varlogaudit","xccdf_org.cisecurity.benchmarks_rule_2.9_Create_Separate_Partition_for_home","xccdf_org.cisecurity.benchmarks_rule_2.10_Add_nodev_Option_to_home","xccdf_org.cisecurity.benchmarks_rule_2.11_Add_nodev_Option_to_Removable_Media_Partitions","xccdf_org.cisecurity.benchmarks_rule_2.12_Add_noexec_Option_to_Removable_Media_Partitions","xccdf_org.cisecurity.benchmarks_rule_2.13_Add_nosuid_Option_to_Removable_Media_Partitions","xccdf_org.cisecurity.benchmarks_rule_2.14_Add_nodev_Option_to_runshm_Partition","xccdf_org.cisecurity.benchmarks_rule_2.15_Add_nosuid_Option_to_runshm_Partition","xccdf_org.cisecurity.benchmarks_rule_2.16_Add_noexec_Option_to_runshm_Partition","xccdf_org.cisecurity.benchmarks_rule_2.17_Set_Sticky_Bit_on_All_World-Writable_Directories","xccdf_org.cisecurity.benchmarks_rule_2.25_Disable_Automounting","xccdf_org.cisecurity.benchmarks_rule_3.1_Set_UserGroup_Owner_on_bootloader_config","xccdf_org.cisecurity.benchmarks_rule_3.2_Set_Permissions_on_bootloader_config","xccdf_org.cisecurity.benchmarks_rule_3.3_Set_Boot_Loader_Password","xccdf_org.cisecurity.benchmarks_rule_3.4_Require_Authentication_for_Single-User_Mode","xccdf_org.cisecurity.benchmarks_rule_4.1_Restrict_Core_Dumps","xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_XDNX_Support_on_32-bit_x86_Systems","xccdf_org.cisecurity.benchmarks_rule_4.3_Enable_Randomized_Virtual_Memory_Region_Placement","xccdf_org.cisecurity.benchmarks_rule_4.4_Disable_Prelink","xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_NIS_is_not_installed","xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_rsh_server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_rsh_client_is_not_installed","xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_talk_server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_talk_client_is_not_installed","xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_telnet_server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_tftp-server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_xinetd_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_chargen_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_daytime_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_echo_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_discard_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_time_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_the_X_Window_system_is_not_installed","xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Avahi_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_print_server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_DHCP_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.5_Configure_Network_Time_Protocol_NTP","xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_LDAP_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_NFS_and_RPC_are_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_DNS_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_FTP_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.10_Ensure_HTTP_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.11_Ensure_IMAP_and_POP_server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.12_Ensure_Samba_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.13_Ensure_HTTP_Proxy_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.14_Ensure_SNMP_Server_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.15_Configure_Mail_Transfer_Agent_for_Local-Only_Mode","xccdf_org.cisecurity.benchmarks_rule_6.16_Ensure_rsync_service_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_6.17_Ensure_Biosdevname_is_not_enabled","xccdf_org.cisecurity.benchmarks_rule_7.1.1_Disable_IP_Forwarding","xccdf_org.cisecurity.benchmarks_rule_7.1.2_Disable_Send_Packet_Redirects","xccdf_org.cisecurity.benchmarks_rule_7.2.1_Disable_Source_Routed_Packet_Acceptance","xccdf_org.cisecurity.benchmarks_rule_7.2.2_Disable_ICMP_Redirect_Acceptance","xccdf_org.cisecurity.benchmarks_rule_7.2.3_Disable_Secure_ICMP_Redirect_Acceptance","xccdf_org.cisecurity.benchmarks_rule_7.2.4_Log_Suspicious_Packets","xccdf_org.cisecurity.benchmarks_rule_7.2.5_Enable_Ignore_Broadcast_Requests","xccdf_org.cisecurity.benchmarks_rule_7.2.6_Enable_Bad_Error_Message_Protection","xccdf_org.cisecurity.benchmarks_rule_7.2.7_Enable_RFC-recommended_Source_Route_Validation","xccdf_org.cisecurity.benchmarks_rule_7.2.8_Enable_TCP_SYN_Cookies","xccdf_org.cisecurity.benchmarks_rule_7.3.1_Disable_IPv6_Router_Advertisements","xccdf_org.cisecurity.benchmarks_rule_7.3.2_Disable_IPv6_Redirect_Acceptance","xccdf_org.cisecurity.benchmarks_rule_7.3.3_Disable_IPv6","xccdf_org.cisecurity.benchmarks_rule_7.4.1_Install_TCP_Wrappers","xccdf_org.cisecurity.benchmarks_rule_7.4.2_Create_etchosts.allow","xccdf_org.cisecurity.benchmarks_rule_7.4.3_Verify_Permissions_on_etchosts.allow","xccdf_org.cisecurity.benchmarks_rule_7.4.4_Create_etchosts.deny","xccdf_org.cisecurity.benchmarks_rule_7.4.5_Verify_Permissions_on_etchosts.deny","xccdf_org.cisecurity.benchmarks_rule_7.5.1_Disable_DCCP","xccdf_org.cisecurity.benchmarks_rule_7.5.2_Disable_SCTP","xccdf_org.cisecurity.benchmarks_rule_7.5.3_Disable_RDS","xccdf_org.cisecurity.benchmarks_rule_7.5.4_Disable_TIPC","xccdf_org.cisecurity.benchmarks_rule_7.6_Deactivate_Wireless_Interfaces","xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_Firewall_is_active","xccdf_org.cisecurity.benchmarks_rule_8.2.1_Install_the_rsyslog_package","xccdf_org.cisecurity.benchmarks_rule_8.2.2_Ensure_the_rsyslog_Service_is_activated","xccdf_org.cisecurity.benchmarks_rule_8.2.3_Configure_etcrsyslog.conf","xccdf_org.cisecurity.benchmarks_rule_8.2.4_Create_and_Set_Permissions_on_rsyslog_Log_Files","xccdf_org.cisecurity.benchmarks_rule_8.2.5_Configure_rsyslog_to_Send_Logs_to_a_Remote_Log_Host","xccdf_org.cisecurity.benchmarks_rule_8.2.6_Accept_Remote_rsyslog_Messages_Only_on_Designated_Log_Hosts","xccdf_org.cisecurity.benchmarks_rule_8.4_Configure_logrotate","xccdf_org.cisecurity.benchmarks_rule_9.1.1_Enable_cron_Daemon","xccdf_org.cisecurity.benchmarks_rule_9.1.2_Set_UserGroup_Owner_and_Permission_on_etccrontab","xccdf_org.cisecurity.benchmarks_rule_9.1.3_Set_UserGroup_Owner_and_Permission_on_etccron.hourly","xccdf_org.cisecurity.benchmarks_rule_9.1.4_Set_UserGroup_Owner_and_Permission_on_etccron.daily","xccdf_org.cisecurity.benchmarks_rule_9.1.5_Set_UserGroup_Owner_and_Permission_on_etccron.weekly","xccdf_org.cisecurity.benchmarks_rule_9.1.6_Set_UserGroup_Owner_and_Permission_on_etccron.monthly","xccdf_org.cisecurity.benchmarks_rule_9.1.7_Set_UserGroup_Owner_and_Permission_on_etccron.d","xccdf_org.cisecurity.benchmarks_rule_9.1.8_Restrict_atcron_to_Authorized_Users","xccdf_org.cisecurity.benchmarks_rule_9.2.1_Set_Password_Creation_Requirement_Parameters_Using_pam_cracklib","xccdf_org.cisecurity.benchmarks_rule_9.2.2_Set_Lockout_for_Failed_Password_Attempts","xccdf_org.cisecurity.benchmarks_rule_9.2.3_Limit_Password_Reuse","xccdf_org.cisecurity.benchmarks_rule_9.3.1_Set_SSH_Protocol_to_2","xccdf_org.cisecurity.benchmarks_rule_9.3.2_Set_LogLevel_to_INFO","xccdf_org.cisecurity.benchmarks_rule_9.3.3_Set_Permissions_on_etcsshsshd_config","xccdf_org.cisecurity.benchmarks_rule_9.3.4_Disable_SSH_X11_Forwarding","xccdf_org.cisecurity.benchmarks_rule_9.3.5_Set_SSH_MaxAuthTries_to_4_or_Less","xccdf_org.cisecurity.benchmarks_rule_9.3.6_Set_SSH_IgnoreRhosts_to_Yes","xccdf_org.cisecurity.benchmarks_rule_9.3.7_Set_SSH_HostbasedAuthentication_to_No","xccdf_org.cisecurity.benchmarks_rule_9.3.8_Disable_SSH_Root_Login","xccdf_org.cisecurity.benchmarks_rule_9.3.9_Set_SSH_PermitEmptyPasswords_to_No","xccdf_org.cisecurity.benchmarks_rule_9.3.10_Do_Not_Allow_Users_to_Set_Environment_Options","xccdf_org.cisecurity.benchmarks_rule_9.3.11_Use_Only_Approved_Cipher_in_Counter_Mode","xccdf_org.cisecurity.benchmarks_rule_9.3.12_Set_Idle_Timeout_Interval_for_User_Login","xccdf_org.cisecurity.benchmarks_rule_9.3.13_Limit_Access_via_SSH","xccdf_org.cisecurity.benchmarks_rule_9.3.14_Set_SSH_Banner","xccdf_org.cisecurity.benchmarks_rule_9.4_Restrict_root_Login_to_System_Console","xccdf_org.cisecurity.benchmarks_rule_9.5_Restrict_Access_to_the_su_Command","xccdf_org.cisecurity.benchmarks_rule_10.1.1_Set_Password_Expiration_Days","xccdf_org.cisecurity.benchmarks_rule_10.1.2_Set_Password_Change_Minimum_Number_of_Days","xccdf_org.cisecurity.benchmarks_rule_10.1.3_Set_Password_Expiring_Warning_Days","xccdf_org.cisecurity.benchmarks_rule_10.2_Disable_System_Accounts","xccdf_org.cisecurity.benchmarks_rule_10.3_Set_Default_Group_for_root_Account","xccdf_org.cisecurity.benchmarks_rule_10.4_Set_Default_umask_for_Users","xccdf_org.cisecurity.benchmarks_rule_10.5_Lock_Inactive_User_Accounts","xccdf_org.cisecurity.benchmarks_rule_11.1_Set_Warning_Banner_for_Standard_Login_Services","xccdf_org.cisecurity.benchmarks_rule_11.2_Remove_OS_Information_from_Login_Warning_Banners","xccdf_org.cisecurity.benchmarks_rule_11.3_Set_Graphical_Warning_Banner","xccdf_org.cisecurity.benchmarks_rule_12.1_Verify_Permissions_on_etcpasswd","xccdf_org.cisecurity.benchmarks_rule_12.2_Verify_Permissions_on_etcshadow","xccdf_org.cisecurity.benchmarks_rule_12.3_Verify_Permissions_on_etcgroup","xccdf_org.cisecurity.benchmarks_rule_12.4_Verify_UserGroup_Ownership_on_etcpasswd","xccdf_org.cisecurity.benchmarks_rule_12.5_Verify_UserGroup_Ownership_on_etcshadow","xccdf_org.cisecurity.benchmarks_rule_12.6_Verify_UserGroup_Ownership_on_etcgroup","xccdf_org.cisecurity.benchmarks_rule_12.7_Find_World_Writable_Files","xccdf_org.cisecurity.benchmarks_rule_12.8_Find_Un-owned_Files_and_Directories","xccdf_org.cisecurity.benchmarks_rule_12.9_Find_Un-grouped_Files_and_Directories","xccdf_org.cisecurity.benchmarks_rule_12.10_Find_SUID_System_Executables","xccdf_org.cisecurity.benchmarks_rule_12.11_Find_SGID_System_Executables","xccdf_org.cisecurity.benchmarks_rule_13.1_Ensure_Password_Fields_are_Not_Empty","xccdf_org.cisecurity.benchmarks_rule_13.2_Verify_No_Legacy__Entries_Exist_in_etcpasswd_File","xccdf_org.cisecurity.benchmarks_rule_13.3_Verify_No_Legacy__Entries_Exist_in_etcshadow_File","xccdf_org.cisecurity.benchmarks_rule_13.4_Verify_No_Legacy__Entries_Exist_in_etcgroup_File","xccdf_org.cisecurity.benchmarks_rule_13.5_Verify_No_UID_0_Accounts_Exist_Other_Than_root","xccdf_org.cisecurity.benchmarks_rule_13.6_Ensure_root_PATH_Integrity","xccdf_org.cisecurity.benchmarks_rule_13.7_Check_Permissions_on_User_Home_Directories","xccdf_org.cisecurity.benchmarks_rule_13.8_Check_User_Dot_File_Permissions","xccdf_org.cisecurity.benchmarks_rule_13.9_Check_Permissions_on_User_.netrc_Files","xccdf_org.cisecurity.benchmarks_rule_13.10_Check_for_Presence_of_User_.rhosts_Files","xccdf_org.cisecurity.benchmarks_rule_13.11_Check_Groups_in_etcpasswd","xccdf_org.cisecurity.benchmarks_rule_13.12_Check_That_Users_Are_Assigned_Valid_Home_Directories","xccdf_org.cisecurity.benchmarks_rule_13.13_Check_User_Home_Directory_Ownership","xccdf_org.cisecurity.benchmarks_rule_13.14_Check_for_Duplicate_UIDs","xccdf_org.cisecurity.benchmarks_rule_13.15_Check_for_Duplicate_GIDs","xccdf_org.cisecurity.benchmarks_rule_13.16_Check_for_Duplicate_User_Names","xccdf_org.cisecurity.benchmarks_rule_13.17_Check_for_Duplicate_Group_Names","xccdf_org.cisecurity.benchmarks_rule_13.18_Check_for_Presence_of_User_.netrc_Files","xccdf_org.cisecurity.benchmarks_rule_13.19_Check_for_Presence_of_User_.forward_Files","xccdf_org.cisecurity.benchmarks_rule_13.20_Ensure_shadow_group_is_empty"],"id":"controls/translated-controls.rb"}],"attributes":[],"sha256":"9880de490ba6b9113431663f50bec6b1a47d7d1e64c7590fd54c42f1c9b42c2e"}],"platform":{"name":"ubuntu","release":"14.04"},"statistics":{"duration":4.914779755},"type":"inspec_report","node_name":"example-node.lxc","end_time":"2017-06-21T19:45:52+00:00","node_uuid":"5c0ae949-aa0e-432d-98dc-fcf452d22646","environment":"_default","report_uuid":"cb8d79a2-a5fb-4399-ab49-be1947e6eafa"}
