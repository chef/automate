# NOTE(ssd) 2019-02-06: Please explicitly document why a given job is
# here and not in the public verify pipeline. The more jobs we have in
# this pipeline, the harder it is for external contributors.

env:
  DOCKER_CONFIG: /var/lib/buildkite-agent/.docker
  HAB_BLDR_CHANNEL: "stable"
  HAB_STUDIO_SECRET_HAB_FALLBACK_CHANNEL: "stable"

expeditor:
  defaults:
    executor:
      docker:
        workdir: /go/src/github.com/chef/automate

steps:
  - label: "creating airgap bundle"
    command:
      - .expeditor/create-airgap-bundle.sh
    timeout_in_minutes: 10
    expeditor:
      secrets:
        GITHUB_TOKEN:
          account: github/chef
          field: token
      accounts:
        - aws/chef-cd
      executor:
        docker:
          privileged: true
            - HAB_STUDIO_SUP=false
            - HAB_NONINTERACTIVE=true